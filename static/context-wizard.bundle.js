"use strict";function _typeof(o){"@babel/helpers - typeof";return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}function ownKeys(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);r&&(o=o.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),t.push.apply(t,o)}return t}function _objectSpread(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?ownKeys(Object(t),!0).forEach(function(r){_defineProperty(e,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ownKeys(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})}return e}function _defineProperty(e,r,t){return(r=_toPropertyKey(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function _toPropertyKey(t){var i=_toPrimitive(t,"string");return"symbol"==_typeof(i)?i:i+""}function _toPrimitive(t,r){if("object"!=_typeof(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}function _regenerator(){var e,t,r="function"==typeof Symbol?Symbol:{},n=r.iterator||"@@iterator",o=r.toStringTag||"@@toStringTag";function i(r,n,o,i){var c=n&&n.prototype instanceof Generator?n:Generator,u=Object.create(c.prototype);return _regeneratorDefine2(u,"_invoke",function(r,n,o){var i,c,u,f=0,p=o||[],y=!1,G={p:0,n:0,v:e,a:d,f:d.bind(e,4),d:function d(t,r){return i=t,c=0,u=e,G.n=r,a}};function d(r,n){for(c=r,u=n,t=0;!y&&f&&!o&&t<p.length;t++){var o,i=p[t],d=G.p,l=i[2];r>3?(o=l===n)&&(u=i[(c=i[4])?5:(c=3,3)],i[4]=i[5]=e):i[0]<=d&&((o=r<2&&d<i[1])?(c=0,G.v=n,G.n=i[1]):d<l&&(o=r<3||i[0]>n||n>l)&&(i[4]=r,i[5]=n,G.n=l,c=0))}if(o||r>1)return a;throw y=!0,n}return function(o,p,l){if(f>1)throw TypeError("Generator is already running");for(y&&1===p&&d(p,l),c=p,u=l;(t=c<2?e:u)||!y;){i||(c?c<3?(c>1&&(G.n=-1),d(c,u)):G.n=u:G.v=u);try{if(f=2,i){if(c||(o="next"),t=i[o]){if(!(t=t.call(i,u)))throw TypeError("iterator result is not an object");if(!t.done)return t;u=t.value,c<2&&(c=0)}else 1===c&&(t=i["return"])&&t.call(i),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);i=e}else if((t=(y=G.n<0)?u:r.call(n,G))!==a)break}catch(t){i=e,c=1,u=t}finally{f=1}}return{value:t,done:y}}}(r,o,i),!0),u}var a={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}t=Object.getPrototypeOf;var c=[][n]?t(t([][n]())):(_regeneratorDefine2(t={},n,function(){return this}),t),u=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(c);function f(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,GeneratorFunctionPrototype):(e.__proto__=GeneratorFunctionPrototype,_regeneratorDefine2(e,o,"GeneratorFunction")),e.prototype=Object.create(u),e}return GeneratorFunction.prototype=GeneratorFunctionPrototype,_regeneratorDefine2(u,"constructor",GeneratorFunctionPrototype),_regeneratorDefine2(GeneratorFunctionPrototype,"constructor",GeneratorFunction),GeneratorFunction.displayName="GeneratorFunction",_regeneratorDefine2(GeneratorFunctionPrototype,o,"GeneratorFunction"),_regeneratorDefine2(u),_regeneratorDefine2(u,o,"Generator"),_regeneratorDefine2(u,n,function(){return this}),_regeneratorDefine2(u,"toString",function(){return"[object Generator]"}),(_regenerator=function _regenerator(){return{w:i,m:f}})()}function _regeneratorDefine2(e,r,n,t){var i=Object.defineProperty;try{i({},"",{})}catch(e){i=0}_regeneratorDefine2=function _regeneratorDefine(e,r,n,t){function o(r,n){_regeneratorDefine2(e,r,function(e){return this._invoke(r,n,e)})}r?i?i(e,r,{value:n,enumerable:!t,configurable:!t,writable:!t}):e[r]=n:(o("next",0),o("throw",1),o("return",2))},_regeneratorDefine2(e,r,n,t)}function asyncGeneratorStep(n,t,e,r,o,a,c){try{var i=n[a](c),u=i.value}catch(n){return void e(n)}i.done?t(u):Promise.resolve(u).then(r,o)}function _asyncToGenerator(n){return function(){var t=this,e=arguments;return new Promise(function(r,o){var a=n.apply(t,e);function _next(n){asyncGeneratorStep(a,r,o,_next,_throw,"next",n)}function _throw(n){asyncGeneratorStep(a,r,o,_next,_throw,"throw",n)}_next(void 0)})}}function _slicedToArray(r,e){return _arrayWithHoles(r)||_iterableToArrayLimit(r,e)||_unsupportedIterableToArray(r,e)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(r,a){if(r){if("string"==typeof r)return _arrayLikeToArray(r,a);var t={}.toString.call(r).slice(8,-1);return"Object"===t&&r.constructor&&(t=r.constructor.name),"Map"===t||"Set"===t?Array.from(r):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?_arrayLikeToArray(r,a):void 0}}function _arrayLikeToArray(r,a){(null==a||a>r.length)&&(a=r.length);for(var e=0,n=Array(a);e<a;e++)n[e]=r[e];return n}function _iterableToArrayLimit(r,l){var t=null==r?null:"undefined"!=typeof Symbol&&r[Symbol.iterator]||r["@@iterator"];if(null!=t){var e,n,i,u,a=[],f=!0,o=!1;try{if(i=(t=t.call(r)).next,0===l){if(Object(t)!==t)return;f=!1}else for(;!(f=(e=i.call(t)).done)&&(a.push(e.value),a.length!==l);f=!0);}catch(r){o=!0,n=r}finally{try{if(!f&&null!=t["return"]&&(u=t["return"](),Object(u)!==u))return}finally{if(o)throw n}}return a}}function _arrayWithHoles(r){if(Array.isArray(r))return r}var _React=React,useState=_React.useState,useEffect=_React.useEffect,useMemo=_React.useMemo;var API_ROOT="/api/v1";var STEPS={INTRO:"intro",INTERVIEW:"interview",REVIEW:"review"};var DEFAULT_QUESTIONS=[{question:"\xBFQu\xE9 productos o servicios ofreces principalmente y c\xF3mo los entregas?"},{question:"\xBFQui\xE9nes son tus clientes m\xE1s importantes y c\xF3mo te contactan?"},{question:"\xBFA qui\xE9n le compras insumos clave o c\xF3mo obtienes tu inventario?"},{question:"\xBFCon qu\xE9 frecuencia realizas operaciones importantes (compras, ventas, servicios)?"},{question:"\xBFQu\xE9 canales de venta o plataformas usas actualmente?"}];var getAuthHeaders=function getAuthHeaders(){var token=localStorage.getItem("access_token");if(!token)return null;return{Authorization:"Bearer ".concat(token)}};var formatDateTime=function formatDateTime(value){if(!value)return null;try{var date=new Date(value);return date.toLocaleString("es-MX",{dateStyle:"medium",timeStyle:"short"})}catch(err){return value}};var Pill=function Pill(_ref){var children=_ref.children,_ref$tone=_ref.tone,tone=_ref$tone===void 0?"indigo":_ref$tone;var tones={indigo:"bg-indigo-50 text-indigo-600 ring-indigo-200",green:"bg-emerald-50 text-emerald-600 ring-emerald-200",slate:"bg-slate-100 text-slate-700 ring-slate-200"};return React.createElement("span",{className:"inline-flex items-center rounded-full px-3 py-1 text-xs font-medium ring-1 ring-inset ".concat(tones[tone]||tones.indigo)},children)};var StepIndicator=function StepIndicator(_ref2){var current=_ref2.current;var steps=[{id:STEPS.INTRO,label:"Contexto base"},{id:STEPS.INTERVIEW,label:"Entrevista"},{id:STEPS.REVIEW,label:"Resumen final"}];var activeIndex=steps.findIndex(function(step){return step.id===current});return React.createElement("div",{className:"flex items-center justify-between gap-3"},steps.map(function(step,index){return React.createElement("div",{key:step.id,className:"flex flex-1 items-center gap-3"},React.createElement("div",{className:"flex h-9 w-9 items-center justify-center rounded-full text-sm font-semibold ".concat(index<=activeIndex?"bg-indigo-600 text-white":"bg-slate-200 text-slate-600")},index+1),React.createElement("div",{className:"flex flex-col"},React.createElement("span",{className:"text-xs font-medium uppercase tracking-wide ".concat(index<=activeIndex?"text-indigo-600":"text-slate-400")},"Paso ",index+1),React.createElement("span",{className:"text-sm font-semibold text-slate-800"},step.label)),index<steps.length-1&&React.createElement("div",{className:"h-px flex-1 ".concat(index<activeIndex?"bg-indigo-200":"bg-slate-200")}))}))};var compileNarrative=function compileNarrative(seedText,questions,answers){var sections=[];var cleanedSeed=seedText.trim();if(cleanedSeed.length>0){sections.push(cleanedSeed)}questions.forEach(function(item,index){var answer=(answers[index]||"").trim();if(!answer)return;var cleanQuestion=item.question.replace(/\?$/,"");sections.push("".concat(cleanQuestion,": ").concat(answer))});if(sections.length===0){return""}return sections.join("\n\n")};var ContextWizard=function ContextWizard(){var _contextStatus$topics,_result$topics,_result$clientes_clav,_result$proveedores_c,_result$canales_venta;var _useState=useState(STEPS.INTRO),_useState2=_slicedToArray(_useState,2),step=_useState2[0],setStep=_useState2[1];var _useState3=useState(""),_useState4=_slicedToArray(_useState3,2),seedText=_useState4[0],setSeedText=_useState4[1];var _useState5=useState(null),_useState6=_slicedToArray(_useState5,2),contextStatus=_useState6[0],setContextStatus=_useState6[1];var _useState7=useState(true),_useState8=_slicedToArray(_useState7,2),statusLoading=_useState8[0],setStatusLoading=_useState8[1];var _useState9=useState(false),_useState0=_slicedToArray(_useState9,2),tokenMissing=_useState0[0],setTokenMissing=_useState0[1];var _useState1=useState(null),_useState10=_slicedToArray(_useState1,2),error=_useState10[0],setError=_useState10[1];var _useState11=useState([]),_useState12=_slicedToArray(_useState11,2),questions=_useState12[0],setQuestions=_useState12[1];var _useState13=useState(false),_useState14=_slicedToArray(_useState13,2),questionsLoading=_useState14[0],setQuestionsLoading=_useState14[1];var _useState15=useState(null),_useState16=_slicedToArray(_useState15,2),questionsError=_useState16[0],setQuestionsError=_useState16[1];var _useState17=useState(0),_useState18=_slicedToArray(_useState17,2),questionIndex=_useState18[0],setQuestionIndex=_useState18[1];var _useState19=useState({}),_useState20=_slicedToArray(_useState19,2),answers=_useState20[0],setAnswers=_useState20[1];var _useState21=useState("text"),_useState22=_slicedToArray(_useState21,2),submissionMode=_useState22[0],setSubmissionMode=_useState22[1];var _useState23=useState(null),_useState24=_slicedToArray(_useState23,2),audioFile=_useState24[0],setAudioFile=_useState24[1];var _useState25=useState(""),_useState26=_slicedToArray(_useState25,2),finalText=_useState26[0],setFinalText=_useState26[1];var _useState27=useState(false),_useState28=_slicedToArray(_useState27,2),isSubmitting=_useState28[0],setIsSubmitting=_useState28[1];var _useState29=useState(null),_useState30=_slicedToArray(_useState29,2),result=_useState30[0],setResult=_useState30[1];var _useState31=useState(false),_useState32=_slicedToArray(_useState31,2),isUpdating=_useState32[0],setIsUpdating=_useState32[1];useEffect(function(){var loadStatus=function(){var _ref3=_asyncToGenerator(_regenerator().m(function _callee(){var headers,response,data,_t;return _regenerator().w(function(_context){while(1)switch(_context.p=_context.n){case 0:headers=getAuthHeaders();if(headers){_context.n=1;break}setTokenMissing(true);setStatusLoading(false);return _context.a(2);case 1:_context.p=1;_context.n=2;return fetch("".concat(API_ROOT,"/companies/context/status"),{headers:headers});case 2:response=_context.v;if(response.ok){_context.n=3;break}throw new Error("Error ".concat(response.status));case 3:_context.n=4;return response.json();case 4:data=_context.v;setContextStatus(data);_context.n=6;break;case 5:_context.p=5;_t=_context.v;console.error("Failed to load context status",_t);setError("No fue posible obtener el resumen actual. Intenta nuevamente m\xE1s tarde.");case 6:_context.p=6;setStatusLoading(false);return _context.f(6);case 7:return _context.a(2)}},_callee,null,[[1,5,6,7]])}));return function loadStatus(){return _ref3.apply(this,arguments)}}();loadStatus()},[]);useEffect(function(){if(!statusLoading&&!(contextStatus!==null&&contextStatus!==void 0&&contextStatus.summary)){setIsUpdating(true)}},[statusLoading,contextStatus===null||contextStatus===void 0?void 0:contextStatus.summary]);var beginUpdate=function beginUpdate(){setResult(null);setIsUpdating(true);setStep(STEPS.INTRO);setSeedText("")};var handleStartInterview=function(){var _ref4=_asyncToGenerator(_regenerator().m(function _callee2(){var headers,seedCandidate,baseContext,response,payload,parsedQuestions,_t2;return _regenerator().w(function(_context2){while(1)switch(_context2.p=_context2.n){case 0:if(!isUpdating){setIsUpdating(true)}setQuestionsError(null);setQuestionsLoading(true);setQuestions([]);setAnswers({});setQuestionIndex(0);headers=getAuthHeaders();if(headers){_context2.n=1;break}setTokenMissing(true);setQuestionsLoading(false);return _context2.a(2);case 1:seedCandidate=seedText.trim();baseContext=seedCandidate.length>=10?seedCandidate:(contextStatus===null||contextStatus===void 0?void 0:contextStatus.summary)||"Necesito preguntas para perfilar una empresa nueva.";_context2.p=2;_context2.n=3;return fetch("".concat(API_ROOT,"/companies/context/questions"),{method:"POST",headers:_objectSpread(_objectSpread({},headers),{},{"Content-Type":"application/json"}),body:JSON.stringify({context:baseContext,count:5})});case 3:response=_context2.v;if(response.ok){_context2.n=4;break}throw new Error("Error ".concat(response.status));case 4:_context2.n=5;return response.json();case 5:payload=_context2.v;parsedQuestions=Array.isArray(payload.questions)&&payload.questions.length>0?payload.questions:DEFAULT_QUESTIONS;setQuestions(parsedQuestions);setStep(STEPS.INTERVIEW);_context2.n=7;break;case 6:_context2.p=6;_t2=_context2.v;console.warn("Falling back to default questions",_t2);setQuestions(DEFAULT_QUESTIONS);setQuestionsError("No se pudieron generar preguntas din\xE1micas. Usaremos el guion est\xE1ndar.");setStep(STEPS.INTERVIEW);case 7:_context2.p=7;setQuestionsLoading(false);return _context2.f(7);case 8:return _context2.a(2)}},_callee2,null,[[2,6,7,8]])}));return function handleStartInterview(){return _ref4.apply(this,arguments)}}();var handleAnswerChange=function handleAnswerChange(index,value){setAnswers(function(prev){return _objectSpread(_objectSpread({},prev),{},_defineProperty({},index,value))})};var handleNextQuestion=function handleNextQuestion(){if(questionIndex===questions.length-1){var narrative=compileNarrative(seedText,questions,answers);setFinalText(narrative.length>0?narrative:(contextStatus===null||contextStatus===void 0?void 0:contextStatus.summary)||"Describe aqu\xED c\xF3mo opera tu empresa\u2026");setStep(STEPS.REVIEW);return}setQuestionIndex(function(prev){return prev+1})};var handlePreviousQuestion=function handlePreviousQuestion(){if(questionIndex===0){setStep(STEPS.INTRO);return}setQuestionIndex(function(prev){return prev-1})};var handleSkipQuestion=function handleSkipQuestion(){setAnswers(function(prev){return _objectSpread(_objectSpread({},prev),{},_defineProperty({},questionIndex,""))});handleNextQuestion()};var onManualReview=function onManualReview(){var narrative=compileNarrative(seedText,questions,answers);var base=narrative||(contextStatus===null||contextStatus===void 0?void 0:contextStatus.summary)||seedText||"";setFinalText(base);setStep(STEPS.REVIEW)};var handleFileChange=function handleFileChange(event){var _event$target$files;var file=(_event$target$files=event.target.files)===null||_event$target$files===void 0?void 0:_event$target$files[0];setAudioFile(file||null)};var handleSubmit=function(){var _ref5=_asyncToGenerator(_regenerator().m(function _callee3(event){var headers,cleaned,response,formData,_payload,detail,payload,_t3;return _regenerator().w(function(_context3){while(1)switch(_context3.p=_context3.n){case 0:event.preventDefault();setError(null);headers=getAuthHeaders();if(headers){_context3.n=1;break}setTokenMissing(true);return _context3.a(2);case 1:cleaned=(finalText||"").trim();if(!(cleaned.length<10)){_context3.n=2;break}setError("El resumen final debe tener al menos 10 caracteres.");return _context3.a(2);case 2:if(!(submissionMode==="audio"&&!audioFile)){_context3.n=3;break}setError("Adjunta una nota de voz o cambia a modo texto.");return _context3.a(2);case 3:setIsSubmitting(true);setResult(null);_context3.p=4;if(!(submissionMode==="audio")){_context3.n=6;break}formData=new FormData;formData.append("input_type","audio");formData.append("content",cleaned);formData.append("file",audioFile);_context3.n=5;return fetch("".concat(API_ROOT,"/companies/contextual_profile"),{method:"POST",headers:headers,body:formData});case 5:response=_context3.v;_context3.n=8;break;case 6:_context3.n=7;return fetch("".concat(API_ROOT,"/companies/contextual_profile"),{method:"POST",headers:_objectSpread(_objectSpread({},headers),{},{"Content-Type":"application/json"}),body:JSON.stringify({input_type:"text",content:cleaned})});case 7:response=_context3.v;case 8:if(response.ok){_context3.n=10;break}_context3.n=9;return response.json()["catch"](function(){return{}});case 9:_payload=_context3.v;detail=(_payload===null||_payload===void 0?void 0:_payload.detail)||response.statusText;throw new Error(typeof detail==="string"?detail:JSON.stringify(detail));case 10:_context3.n=11;return response.json();case 11:payload=_context3.v;setResult(payload);setSeedText("");setAudioFile(null);setAnswers({});setQuestions([]);setQuestionIndex(0);setSubmissionMode("text");setStep(STEPS.INTRO);setIsUpdating(false);setContextStatus(function(prev){return _objectSpread(_objectSpread({},prev),{},{summary:payload.summary,last_context_update:payload.last_refresh,topics:payload.topics})});_context3.n=13;break;case 12:_context3.p=12;_t3=_context3.v;console.error("Context submission failed",_t3);setError(_t3.message||"No fue posible guardar el contexto de la empresa.");case 13:_context3.p=13;setIsSubmitting(false);return _context3.f(13);case 14:return _context3.a(2)}},_callee3,null,[[4,12,13,14]])}));return function handleSubmit(_x){return _ref5.apply(this,arguments)}}();var currentQuestion=questions[questionIndex];var currentAnswer=answers[questionIndex]||"";var lastUpdateLabel=formatDateTime(contextStatus===null||contextStatus===void 0?void 0:contextStatus.last_context_update);var reviewPreview=useMemo(function(){if(finalText.trim().length>0){return finalText.split("\n").slice(0,2).join(" ")}return""},[finalText]);if(tokenMissing){return React.createElement("div",{className:"bg-white rounded-2xl shadow p-6 space-y-4"},React.createElement("h1",{className:"text-2xl font-semibold text-slate-900"},"Contexto Operativo"),React.createElement("p",{className:"text-slate-600"},"Inicia sesi\xF3n para capturar el contexto de tu empresa y personalizar la IA."))}return React.createElement("div",{className:"space-y-8"},React.createElement("header",{className:"bg-white shadow rounded-2xl p-6 space-y-4"},React.createElement("div",{className:"flex flex-col gap-2"},React.createElement("h1",{className:"text-2xl font-semibold text-slate-900"},"\uD83E\uDDE0 Contexto Operativo de la Empresa"),React.createElement("p",{className:"text-sm text-slate-600"},"Responde una mini entrevista para que la IA entienda tu modelo de negocio, clientes, proveedores y canales. Con eso personalizamos la categorizaci\xF3n de gastos y las recomendaciones contables.")),isUpdating&&React.createElement(StepIndicator,{current:step}),statusLoading?React.createElement("span",{className:"text-xs text-slate-500 animate-pulse"},"Cargando contexto previo\u2026"):(contextStatus===null||contextStatus===void 0?void 0:contextStatus.last_context_update)&&React.createElement("span",{className:"text-xs text-slate-500"},"\xDAltima actualizaci\xF3n: ",formatDateTime(contextStatus.last_context_update))),(contextStatus===null||contextStatus===void 0?void 0:contextStatus.summary)&&React.createElement("section",{className:"bg-white rounded-2xl border border-slate-200 p-6 space-y-3"},React.createElement("div",{className:"flex items-center justify-between"},React.createElement("h2",{className:"text-lg font-semibold text-slate-900"},"Resumen actual"),React.createElement(Pill,null,"IA Context Memory")),React.createElement("p",{className:"text-slate-700 leading-relaxed"},contextStatus.summary),((_contextStatus$topics=contextStatus.topics)===null||_contextStatus$topics===void 0?void 0:_contextStatus$topics.length)>0&&React.createElement("div",{className:"flex flex-wrap gap-2 pt-2"},contextStatus.topics.map(function(topic){return React.createElement(Pill,{key:topic},topic)}))),!statusLoading&&(contextStatus===null||contextStatus===void 0?void 0:contextStatus.summary)&&!isUpdating&&React.createElement("section",{className:"bg-white rounded-2xl border border-indigo-100 px-6 py-5 shadow-sm flex flex-col gap-3 md:flex-row md:items-center md:justify-between"},React.createElement("div",null,React.createElement("p",{className:"text-sm text-indigo-900 font-medium"},lastUpdateLabel?"Contexto actualizado el ".concat(lastUpdateLabel,"."):"Contexto listo para personalizar la IA."),React.createElement("p",{className:"text-xs text-indigo-700"},"Puedes actualizar la entrevista cuando quieras para mantener la IA alineada a los cambios del negocio.")),React.createElement("button",{type:"button",onClick:beginUpdate,className:"inline-flex items-center gap-2 rounded-xl bg-indigo-600 px-5 py-3 text-sm font-medium text-white shadow transition hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-300"},"Actualizar contexto",React.createElement("span",{"aria-hidden":"true"},"\u2192"))),isUpdating&&step===STEPS.INTRO&&React.createElement("section",{className:"bg-white rounded-2xl shadow p-6 space-y-6"},React.createElement("div",{className:"space-y-3"},React.createElement("h2",{className:"text-xl font-semibold text-slate-900"},"Cu\xE9ntanos brevemente sobre tu operaci\xF3n"),React.createElement("p",{className:"text-sm text-slate-600"},"Usa este espacio para dar contexto base. Esto ayuda a la IA a generar preguntas m\xE1s relevantes. Despu\xE9s podr\xE1s grabar/adjuntar una nota de voz o complementar con el cuestionario."),React.createElement("textarea",{className:"w-full min-h-[160px] rounded-xl border border-slate-200 bg-slate-50 px-4 py-3 text-sm text-slate-800 shadow-inner focus:border-indigo-500 focus:bg-white focus:outline-none focus:ring-2 focus:ring-indigo-200",placeholder:"Ej: Vendemos soluciones SaaS para restaurantes, cobramos suscripci\xF3n mensual y damos soporte con un equipo de 5 personas en la CDMX...",value:seedText,onChange:function onChange(event){return setSeedText(event.target.value)}}),React.createElement("p",{className:"text-xs text-slate-500"},"Incluye qu\xE9 ofreces, a qui\xE9n le vendes, c\xF3mo cobras y con qui\xE9n operas. Con eso la IA entender\xE1 mejor tu negocio.")),questionsError&&React.createElement("div",{className:"rounded-xl border border-red-200 bg-red-50 px-4 py-3 text-sm text-red-600"},questionsError),React.createElement("div",{className:"flex flex-wrap items-center gap-3"},React.createElement("button",{type:"button",onClick:handleStartInterview,disabled:questionsLoading,className:"inline-flex items-center gap-2 rounded-xl bg-indigo-600 px-5 py-3 text-sm font-medium text-white shadow transition hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-300 disabled:cursor-not-allowed disabled:bg-indigo-300"},questionsLoading?React.createElement(React.Fragment,null,React.createElement("span",{className:"h-3 w-3 animate-spin rounded-full border-2 border-white border-t-transparent"}),"Generando preguntas\u2026"):React.createElement(React.Fragment,null,React.createElement("span",null,"Iniciar entrevista IA"),React.createElement("span",{"aria-hidden":"true"},"\u2192"))),React.createElement("button",{type:"button",onClick:onManualReview,className:"inline-flex items-center gap-2 rounded-xl border border-slate-200 px-5 py-3 text-sm font-medium text-slate-700 shadow-sm transition hover:border-slate-300 hover:text-slate-900"},"Saltar a resumen manual"))),isUpdating&&step===STEPS.INTERVIEW&&React.createElement("section",{className:"bg-white rounded-2xl shadow p-6 space-y-6"},React.createElement("div",{className:"flex items-start justify-between gap-4"},React.createElement("div",null,React.createElement("h2",{className:"text-xl font-semibold text-slate-900"},"Entrevista guiada"),React.createElement("p",{className:"text-sm text-slate-600"},"Responde con libertad. Puedes escribir bullets, narrar procesos o pegar notas que ya tengas.")),React.createElement(Pill,{tone:"slate"},"Pregunta ",questionIndex+1," de ",questions.length||1)),React.createElement("div",{className:"space-y-4"},React.createElement("div",{className:"rounded-2xl border border-indigo-100 bg-indigo-50 px-4 py-3 text-sm text-indigo-900 shadow-inner"},(currentQuestion===null||currentQuestion===void 0?void 0:currentQuestion.question)||"Cu\xE9ntanos m\xE1s sobre tu empresa."),React.createElement("textarea",{className:"w-full min-h-[160px] rounded-xl border border-slate-200 bg-white px-4 py-3 text-sm text-slate-800 shadow-inner focus:border-indigo-500 focus:outline-none focus:ring-2 focus:ring-indigo-200",placeholder:"Escribe la respuesta aqu\xED\u2026",value:currentAnswer,onChange:function onChange(event){return handleAnswerChange(questionIndex,event.target.value)}})),React.createElement("div",{className:"flex flex-wrap items-center gap-3"},React.createElement("button",{type:"button",onClick:handlePreviousQuestion,className:"inline-flex items-center gap-2 rounded-xl border border-slate-200 px-4 py-2 text-sm font-medium text-slate-700 transition hover:border-slate-300 hover:text-slate-900"},"\u2190 Anterior"),React.createElement("button",{type:"button",onClick:handleSkipQuestion,className:"inline-flex items-center gap-2 rounded-xl border border-slate-200 px-4 py-2 text-sm font-medium text-slate-700 transition hover:border-slate-300 hover:text-slate-900"},"Saltar pregunta"),React.createElement("button",{type:"button",onClick:handleNextQuestion,className:"inline-flex items-center gap-2 rounded-xl bg-indigo-600 px-5 py-3 text-sm font-medium text-white shadow transition hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-300"},questionIndex===questions.length-1?"Ir a resumen":"Siguiente \u2192"))),isUpdating&&step===STEPS.REVIEW&&React.createElement("section",{className:"bg-white rounded-2xl shadow p-6 space-y-6"},React.createElement("div",{className:"space-y-2"},React.createElement("h2",{className:"text-xl font-semibold text-slate-900"},"Revisi\xF3n final"),React.createElement("p",{className:"text-sm text-slate-600"},"Ajusta el resumen si lo necesitas. Al guardar, la IA actualizar\xE1 la memoria de contexto, giro, canales y clientes clave."),reviewPreview&&React.createElement(Pill,{tone:"green"},"Vista previa: ",reviewPreview.substring(0,80),"\u2026")),React.createElement("form",{onSubmit:handleSubmit,className:"space-y-5"},React.createElement("div",{className:"space-y-3"},React.createElement("label",{className:"block text-sm font-medium text-slate-700"},"Resumen consolidado"),React.createElement("textarea",{className:"w-full min-h-[220px] rounded-xl border border-slate-200 bg-white px-4 py-3 text-sm text-slate-800 shadow-inner focus:border-indigo-500 focus:outline-none focus:ring-2 focus:ring-indigo-200",value:finalText,onChange:function onChange(event){return setFinalText(event.target.value)}}),React.createElement("p",{className:"text-xs text-slate-500"},"Tip: agrega si tus costos son servicios o mercanc\xEDas, c\xF3mo facturas y si usas personal interno o proveedores externos.")),React.createElement("div",{className:"space-y-3"},React.createElement("span",{className:"text-sm font-medium text-slate-700"},"Modo de env\xEDo"),React.createElement("div",{className:"inline-flex rounded-full border border-slate-200 p-1 bg-slate-50"},React.createElement("button",{type:"button",onClick:function onClick(){return setSubmissionMode("text")},className:"px-4 py-1 text-sm rounded-full transition ".concat(submissionMode==="text"?"bg-white shadow text-slate-900":"text-slate-500 hover:text-slate-700")},"Texto"),React.createElement("button",{type:"button",onClick:function onClick(){return setSubmissionMode("audio")},className:"px-4 py-1 text-sm rounded-full transition ".concat(submissionMode==="audio"?"bg-white shadow text-slate-900":"text-slate-500 hover:text-slate-700")},"Texto + audio"))),submissionMode==="audio"&&React.createElement("div",{className:"space-y-2"},React.createElement("label",{className:"block text-sm font-medium text-slate-700"},"Adjunta una nota de voz (MP3, M4A o WAV)"),React.createElement("input",{type:"file",accept:"audio/*",onChange:handleFileChange,className:"block w-full text-sm text-slate-600 file:mr-4 file:rounded-full file:border-0 file:bg-indigo-50 file:px-4 file:py-2 file:text-sm file:font-semibold file:text-indigo-700 hover:file:bg-indigo-100"}),React.createElement("p",{className:"text-xs text-slate-500"},"Transcribiremos la nota y la combinaremos con el resumen para mejorar el contexto.")),error&&React.createElement("div",{className:"rounded-xl border border-red-200 bg-red-50 px-4 py-3 text-sm text-red-600"},error),React.createElement("div",{className:"flex flex-wrap items-center gap-3"},React.createElement("button",{type:"button",onClick:function onClick(){return setStep(STEPS.INTERVIEW)},className:"inline-flex items-center gap-2 rounded-xl border border-slate-200 px-4 py-2 text-sm font-medium text-slate-700 transition hover:border-slate-300 hover:text-slate-900"},"\u2190 Volver a entrevistas"),React.createElement("button",{type:"submit",disabled:isSubmitting,className:"inline-flex items-center gap-2 rounded-xl bg-indigo-600 px-5 py-3 text-sm font-medium text-white shadow transition hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-300 disabled:cursor-not-allowed disabled:bg-indigo-300"},isSubmitting?React.createElement(React.Fragment,null,React.createElement("span",{className:"h-3 w-3 animate-spin rounded-full border-2 border-white border-t-transparent"}),"Guardando\u2026"):React.createElement(React.Fragment,null,React.createElement("span",null,"Guardar contexto"),React.createElement("span",{"aria-hidden":"true"},"\u2192")))))),result&&React.createElement("section",{className:"bg-white rounded-2xl border border-green-200 p-6 space-y-3"},React.createElement("header",{className:"flex items-center justify-between"},React.createElement("h2",{className:"text-lg font-semibold text-emerald-700"},"Contexto actualizado"),React.createElement(Pill,{tone:"green"},result.model_name||"context-analyzer")),React.createElement("p",{className:"text-sm text-slate-600"},"Confianza del modelo:"," ",React.createElement("span",{className:"font-semibold text-slate-800"},(result.confidence_score*100).toFixed(1),"%")),result.summary&&React.createElement("p",{className:"text-slate-700 leading-relaxed"},result.summary),((_result$topics=result.topics)===null||_result$topics===void 0?void 0:_result$topics.length)>0&&React.createElement("div",{className:"flex flex-wrap gap-2 pt-2"},result.topics.map(function(topic){return React.createElement(Pill,{key:topic},topic)})),React.createElement("dl",{className:"grid grid-cols-1 gap-4 pt-4 text-sm text-slate-600 sm:grid-cols-2"},result.giro&&React.createElement("div",null,React.createElement("dt",{className:"font-medium text-slate-900"},"Giro"),React.createElement("dd",null,result.giro)),result.modelo_negocio&&React.createElement("div",null,React.createElement("dt",{className:"font-medium text-slate-900"},"Modelo de negocio"),React.createElement("dd",null,result.modelo_negocio)),((_result$clientes_clav=result.clientes_clave)===null||_result$clientes_clav===void 0?void 0:_result$clientes_clav.length)>0&&React.createElement("div",{className:"sm:col-span-2"},React.createElement("dt",{className:"font-medium text-slate-900"},"Clientes clave"),React.createElement("dd",{className:"flex flex-wrap gap-2 pt-1"},result.clientes_clave.map(function(item){return React.createElement(Pill,{key:item},item)}))),((_result$proveedores_c=result.proveedores_clave)===null||_result$proveedores_c===void 0?void 0:_result$proveedores_c.length)>0&&React.createElement("div",{className:"sm:col-span-2"},React.createElement("dt",{className:"font-medium text-slate-900"},"Proveedores clave"),React.createElement("dd",{className:"flex flex-wrap gap-2 pt-1"},result.proveedores_clave.map(function(item){return React.createElement(Pill,{key:item},item)}))),((_result$canales_venta=result.canales_venta)===null||_result$canales_venta===void 0?void 0:_result$canales_venta.length)>0&&React.createElement("div",{className:"sm:col-span-2"},React.createElement("dt",{className:"font-medium text-slate-900"},"Canales de venta"),React.createElement("dd",{className:"flex flex-wrap gap-2 pt-1"},result.canales_venta.map(function(item){return React.createElement(Pill,{key:item},item)}))),result.frecuencia_operacion&&React.createElement("div",null,React.createElement("dt",{className:"font-medium text-slate-900"},"Frecuencia operativa"),React.createElement("dd",null,result.frecuencia_operacion)))))};var rootElement=document.getElementById("context-wizard-root");if(rootElement){var root=ReactDOM.createRoot(rootElement);root.render(React.createElement(ContextWizard,null))}
