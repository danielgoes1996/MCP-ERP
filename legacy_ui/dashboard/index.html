<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MCP Audit Dashboard - Sistema de Auditor√≠a de Funcionalidades</title>

    <!-- Tailwind CSS CDN para desarrollo r√°pido -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- React CDN para desarrollo -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>

    <!-- Babel para JSX -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <!-- Heroicons -->
    <script src="https://unpkg.com/@heroicons/react@2.0.18/24/outline/index.js" type="module"></script>

    <!-- Meta tags para SEO -->
    <meta name="description" content="Dashboard de Auditor√≠a de Funcionalidades para el Sistema MCP Server. An√°lisis integral de coherencia BD ‚Üî API ‚Üî UI, SPOFs y dependencias cr√≠ticas.">
    <meta name="keywords" content="audit, dashboard, mcp-server, react, tailwind, functionality-analysis, coherence, SPOF">
    <meta name="author" content="MCP Server Audit Team">

    <!-- Open Graph -->
    <meta property="og:title" content="MCP Audit Dashboard">
    <meta property="og:description" content="Sistema de auditor√≠a integral para an√°lisis de funcionalidades y coherencia arquitect√≥nica">
    <meta property="og:type" content="website">

    <!-- Favicon -->
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='%23059669'><path fill-rule='evenodd' d='M2.25 13.5a8.25 8.25 0 018.25-8.25.75.75 0 01.75.75v6.75H18a.75.75 0 01.75.75 8.25 8.25 0 01-16.5 0z' clip-rule='evenodd' /></svg>">

    <!-- Custom Tailwind Config -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        audit: {
                            success: '#10B981',
                            warning: '#F59E0B',
                            danger: '#EF4444',
                            info: '#3B82F6',
                        },
                        coherence: {
                            high: '#10B981',
                            medium: '#F59E0B',
                            low: '#EF4444',
                        }
                    },
                    boxShadow: {
                        'audit-card': '0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px 0 rgba(0, 0, 0, 0.06)',
                        'spof-critical': '0 0 15px rgba(239, 68, 68, 0.3)',
                    }
                }
            }
        }
    </script>

    <!-- Estilos adicionales -->
    <style>
        /* Animaciones personalizadas */
        .pulse-slow {
            animation: pulse 3s cubic-bezier(0.4, 0, 0.6, 1) infinite;
        }

        .functionality-card {
            transition: all 0.2s ease-in-out;
        }

        .functionality-card:hover {
            transform: translateY(-2px);
        }

        /* Scrollbar personalizado */
        ::-webkit-scrollbar {
            width: 6px;
            height: 6px;
        }

        ::-webkit-scrollbar-track {
            background: #f1f5f9;
        }

        ::-webkit-scrollbar-thumb {
            background: #cbd5e1;
            border-radius: 3px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: #94a3b8;
        }

        /* Loading spinner */
        .loading-spinner {
            border: 3px solid #f3f4f6;
            border-top: 3px solid #3b82f6;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* C√≥digo syntax highlighting b√°sico */
        pre code {
            display: block;
            padding: 1rem;
            background: #1f2937;
            color: #f9fafb;
            border-radius: 0.5rem;
            overflow-x: auto;
            font-size: 0.875rem;
            line-height: 1.5;
        }

        /* Badges de estado */
        .badge-complete {
            background-color: #dcfce7;
            color: #166534;
            border: 1px solid #bbf7d0;
        }

        .badge-warning {
            background-color: #fef3c7;
            color: #92400e;
            border: 1px solid #fde68a;
        }

        .badge-danger {
            background-color: #fee2e2;
            color: #991b1b;
            border: 1px solid #fca5a5;
        }
    </style>
</head>
<body class="bg-gray-50 min-h-screen">
    <!-- Contenedor principal del dashboard -->
    <div id="audit-dashboard-root" class="min-h-screen">
        <!-- Loading inicial -->
        <div id="initial-loading" class="min-h-screen flex items-center justify-center">
            <div class="text-center">
                <div class="loading-spinner mx-auto mb-4"></div>
                <h2 class="text-xl font-semibold text-gray-700 mb-2">
                    üîç Cargando MCP Audit Dashboard
                </h2>
                <p class="text-gray-500">
                    Inicializando sistema de auditor√≠a...
                </p>
            </div>
        </div>
    </div>

    <!-- Dashboard de desarrollo/testing (hidden por defecto) -->
    <div id="development-dashboard" class="hidden">
        <div class="bg-blue-50 border-l-4 border-blue-400 p-4 mb-6">
            <div class="flex">
                <div class="ml-3">
                    <p class="text-sm text-blue-700">
                        <strong>Modo Desarrollo:</strong> Este es el dashboard de desarrollo con ejemplos.
                        Para producci√≥n, usar los componentes React directamente.
                    </p>
                </div>
            </div>
        </div>
    </div>

    <!-- Scripts del dashboard -->
    <script type="text/babel">
        // Datos mock para demostraci√≥n (en producci√≥n vendr√≠a de API)
        const mockAuditData = {
            systemMetrics: {
                totalFunctionalities: 23,
                globalCoherence: 71,
                mappedDependencies: 147,
                criticalSPOFs: 3,
                pythonFiles: 173,
                apiEndpoints: 38,
                missingBDFields: 23,
                missingUIFields: 15
            },
            categoryStats: {
                core: { functionalities: 4, averageCoherence: 78, risk: "medium" },
                business: { functionalities: 11, averageCoherence: 69, risk: "high" },
                intelligence: { functionalities: 8, averageCoherence: 72, risk: "medium" }
            },
            spofs: [
                {
                    name: "Base de Datos SQLite",
                    affects: "96%",
                    recoveryTime: "4-8 hours",
                    severity: "critical"
                }
            ],
            circularDependencies: [
                {
                    name: "Gastos ‚Üî Facturas ‚Üî Conciliaci√≥n",
                    risk: "Deadlocks en actualizaciones concurrentes",
                    solution: "Event-driven architecture"
                }
            ]
        };

        // Componente de demostraci√≥n simple
        const SimpleDashboardDemo = () => {
            const [loading, setLoading] = React.useState(true);

            React.useEffect(() => {
                setTimeout(() => setLoading(false), 2000);
            }, []);

            if (loading) {
                return (
                    <div className="min-h-screen flex items-center justify-center">
                        <div className="text-center">
                            <div className="loading-spinner mx-auto mb-4"></div>
                            <p className="text-gray-600">Cargando dashboard...</p>
                        </div>
                    </div>
                );
            }

            return (
                <div className="min-h-screen bg-gray-50 p-6">
                    {/* Header */}
                    <div className="mb-8">
                        <h1 className="text-3xl font-bold text-gray-900 mb-2">
                            üîç MCP Audit Dashboard - Demo
                        </h1>
                        <p className="text-gray-600">
                            Sistema de auditor√≠a integral para an√°lisis de funcionalidades
                        </p>
                    </div>

                    {/* M√©tricas principales */}
                    <div className="grid grid-cols-1 md:grid-cols-4 gap-6 mb-8">
                        <div className="bg-white rounded-lg shadow-audit-card p-6 border">
                            <div className="flex items-center justify-between mb-2">
                                <span className="text-sm font-medium text-gray-600">Funcionalidades</span>
                                <span className="inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800">
                                    ‚úÖ Completo
                                </span>
                            </div>
                            <div className="text-2xl font-bold text-gray-900">23</div>
                            <p className="text-xs text-gray-500">Total auditadas</p>
                        </div>

                        <div className="bg-white rounded-lg shadow-audit-card p-6 border">
                            <div className="flex items-center justify-between mb-2">
                                <span className="text-sm font-medium text-gray-600">Coherencia</span>
                                <span className="inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800">
                                    ‚ö†Ô∏è Mejorar
                                </span>
                            </div>
                            <div className="text-2xl font-bold text-yellow-600">71%</div>
                            <p className="text-xs text-gray-500">Objetivo: 91%</p>
                        </div>

                        <div className="bg-white rounded-lg shadow-audit-card p-6 border">
                            <div className="flex items-center justify-between mb-2">
                                <span className="text-sm font-medium text-gray-600">SPOFs Cr√≠ticos</span>
                                <span className="inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-red-100 text-red-800">
                                    üî¥ Alto Riesgo
                                </span>
                            </div>
                            <div className="text-2xl font-bold text-red-600">3</div>
                            <p className="text-xs text-gray-500">Requiere atenci√≥n</p>
                        </div>

                        <div className="bg-white rounded-lg shadow-audit-card p-6 border">
                            <div className="flex items-center justify-between mb-2">
                                <span className="text-sm font-medium text-gray-600">Dependencias</span>
                                <span className="inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800">
                                    ‚úÖ Mapeadas
                                </span>
                            </div>
                            <div className="text-2xl font-bold text-gray-900">147+</div>
                            <p className="text-xs text-gray-500">Relaciones identificadas</p>
                        </div>
                    </div>

                    {/* SPOF cr√≠tico */}
                    <div className="bg-white rounded-lg shadow-audit-card p-6 border mb-8">
                        <h2 className="text-lg font-semibold text-gray-900 mb-4">
                            üö® Single Point of Failure Cr√≠tico
                        </h2>
                        <div className="bg-red-50 border border-red-200 rounded-lg p-4">
                            <div className="flex items-start space-x-3">
                                <div className="flex-shrink-0">
                                    <svg className="h-5 w-5 text-red-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.732-.833-2.5 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z" />
                                    </svg>
                                </div>
                                <div>
                                    <h3 className="text-sm font-medium text-red-800">
                                        Base de Datos SQLite
                                    </h3>
                                    <div className="mt-2 text-sm text-red-700">
                                        <p><strong>Impacto:</strong> 96% del sistema</p>
                                        <p><strong>Recovery:</strong> 4-8 horas</p>
                                        <p><strong>Recomendaci√≥n:</strong> Migrar a PostgreSQL con clustering</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    {/* Ejemplo de funcionalidad */}
                    <div className="bg-white rounded-lg shadow-audit-card p-6 border mb-8">
                        <h2 className="text-lg font-semibold text-gray-900 mb-4">
                            üí∞ Ejemplo: Gesti√≥n de Gastos
                        </h2>

                        <div className="grid grid-cols-3 gap-4 mb-4">
                            <div className="text-center">
                                <div className="inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-green-100 text-green-800">
                                    üîí Alta
                                </div>
                                <p className="text-xs text-gray-500 mt-1">Seguridad</p>
                            </div>
                            <div className="text-center">
                                <div className="inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-yellow-100 text-yellow-800">
                                    ‚ö° Media
                                </div>
                                <p className="text-xs text-gray-500 mt-1">Performance</p>
                            </div>
                            <div className="text-center">
                                <div className="inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-yellow-100 text-yellow-800">
                                    üîÑ 74%
                                </div>
                                <p className="text-xs text-gray-500 mt-1">Coherencia</p>
                            </div>
                        </div>

                        {/* Trazabilidad de campos */}
                        <div>
                            <h3 className="text-sm font-semibold text-gray-700 mb-3">
                                Trazabilidad BD ‚Üî API ‚Üî UI
                            </h3>
                            <div className="space-y-2">
                                <div className="bg-green-50 border border-green-200 rounded p-2 flex items-center justify-between">
                                    <code className="text-sm">descripcion</code>
                                    <div className="flex space-x-1">
                                        <span className="badge-complete px-2 py-1 rounded text-xs">BD ‚úì</span>
                                        <span className="badge-complete px-2 py-1 rounded text-xs">API ‚úì</span>
                                        <span className="badge-complete px-2 py-1 rounded text-xs">UI ‚úì</span>
                                    </div>
                                </div>
                                <div className="bg-yellow-50 border border-yellow-200 rounded p-2 flex items-center justify-between">
                                    <code className="text-sm">deducible</code>
                                    <div className="flex space-x-1">
                                        <span className="badge-danger px-2 py-1 rounded text-xs">BD ‚úó</span>
                                        <span className="badge-complete px-2 py-1 rounded text-xs">API ‚úì</span>
                                        <span className="badge-complete px-2 py-1 rounded text-xs">UI ‚úì</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    {/* Footer */}
                    <div className="text-center text-gray-500 text-sm">
                        <p>üîç MCP Audit Dashboard - Demo | Para el dashboard completo usar los componentes React</p>
                        <p>üìÖ {new Date().toLocaleDateString('es-ES')}</p>
                    </div>
                </div>
            );
        };

        // Renderizar el dashboard
        const root = ReactDOM.createRoot(document.getElementById('audit-dashboard-root'));

        // Ocultar loading inicial despu√©s de cargar React
        setTimeout(() => {
            document.getElementById('initial-loading').style.display = 'none';
            root.render(<SimpleDashboardDemo />);
        }, 1000);

        // Exponer utilidades globales
        window.MCPAuditDashboard = {
            mockData: mockAuditData,

            // Funci√≥n para mostrar informaci√≥n del dashboard
            info: () => {
                console.log('üîç MCP Audit Dashboard Demo');
                console.log('=====================================');
                console.log('Funcionalidades: 23');
                console.log('Coherencia Global: 71%');
                console.log('SPOFs Cr√≠ticos: 3');
                console.log('Dependencias: 147+');
                console.log('=====================================');
                console.log('Para el dashboard completo, usar los componentes React en /dashboard/');
            },

            // Funci√≥n para simular carga de datos
            loadData: () => {
                return new Promise(resolve => {
                    setTimeout(() => resolve(mockAuditData), 1000);
                });
            }
        };

        // Mostrar info autom√°ticamente
        console.log('üîç MCP Audit Dashboard cargado!');
        console.log('Ejecuta window.MCPAuditDashboard.info() para ver detalles');
    </script>

    <!-- Analytics o tracking (opcional) -->
    <!--
    <script>
        // Google Analytics, Mixpanel, etc.
    </script>
    -->
</body>
</html>