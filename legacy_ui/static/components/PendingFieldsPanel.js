"use strict";function _slicedToArray(r,e){return _arrayWithHoles(r)||_iterableToArrayLimit(r,e)||_unsupportedIterableToArray(r,e)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(r,a){if(r){if("string"==typeof r)return _arrayLikeToArray(r,a);var t={}.toString.call(r).slice(8,-1);return"Object"===t&&r.constructor&&(t=r.constructor.name),"Map"===t||"Set"===t?Array.from(r):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?_arrayLikeToArray(r,a):void 0}}function _arrayLikeToArray(r,a){(null==a||a>r.length)&&(a=r.length);for(var e=0,n=Array(a);e<a;e++)n[e]=r[e];return n}function _iterableToArrayLimit(r,l){var t=null==r?null:"undefined"!=typeof Symbol&&r[Symbol.iterator]||r["@@iterator"];if(null!=t){var e,n,i,u,a=[],f=!0,o=!1;try{if(i=(t=t.call(r)).next,0===l){if(Object(t)!==t)return;f=!1}else for(;!(f=(e=i.call(t)).done)&&(a.push(e.value),a.length!==l);f=!0);}catch(r){o=!0,n=r}finally{try{if(!f&&null!=t["return"]&&(u=t["return"](),Object(u)!==u))return}finally{if(o)throw n}}return a}}function _arrayWithHoles(r){if(Array.isArray(r))return r}var PendingFieldsPanel=function PendingFieldsPanel(_ref){var expenseFields=_ref.expenseFields,getFieldValue=_ref.getFieldValue,handleFieldChange=_ref.handleFieldChange,isPredictingCategory=_ref.isPredictingCategory,categoryPrediction=_ref.categoryPrediction,onClearCategoryPrediction=_ref.onClearCategoryPrediction,_ref$paymentAccounts=_ref.paymentAccounts,paymentAccounts=_ref$paymentAccounts===void 0?[]:_ref$paymentAccounts,_ref$className=_ref.className,className=_ref$className===void 0?"":_ref$className;var clearCategoryPrediction=React.useCallback(function(){if(typeof onClearCategoryPrediction==="function"){onClearCategoryPrediction()}},[onClearCategoryPrediction]);var renderCategoryAssist=function renderCategoryAssist(value){var _categoryPrediction$c;var confidence=(_categoryPrediction$c=categoryPrediction===null||categoryPrediction===void 0?void 0:categoryPrediction.confianza)!==null&&_categoryPrediction$c!==void 0?_categoryPrediction$c:0;return React.createElement("div",{className:"mt-2 space-y-2"},isPredictingCategory&&React.createElement("div",{className:"flex items-center text-xs text-blue-600"},React.createElement("i",{className:"fas fa-robot fa-spin mr-2"}),"Prediciendo categor\xEDa con IA..."),categoryPrediction&&!value&&confidence<0.8&&React.createElement("div",{className:"p-2 bg-blue-50 rounded-md border border-blue-200"},React.createElement("div",{className:"text-xs font-medium text-blue-800 mb-1"},"\uD83E\uDD16 IA sugiere: ",categoryPrediction.categoria_sugerida,React.createElement("span",{className:"ml-1 text-blue-600"},"(",Math.round(confidence*100),"% confianza)")),categoryPrediction.razonamiento&&React.createElement("div",{className:"text-xs text-blue-700 mb-2"},categoryPrediction.razonamiento),React.createElement("div",{className:"flex flex-wrap gap-2"},React.createElement("button",{type:"button",onClick:function onClick(){handleFieldChange("categoria",categoryPrediction.categoria_sugerida);clearCategoryPrediction()},className:"px-2 py-1 bg-blue-600 text-white text-xs rounded hover:bg-blue-700"},"\u2705 Aplicar"),React.createElement("button",{type:"button",onClick:clearCategoryPrediction,className:"px-2 py-1 bg-gray-400 text-white text-xs rounded hover:bg-gray-500"},"\u274C Rechazar")),Array.isArray(categoryPrediction.alternativas)&&categoryPrediction.alternativas.length>0&&React.createElement("div",{className:"mt-2"},React.createElement("div",{className:"text-xs text-blue-700 mb-1"},"Alternativas:"),React.createElement("div",{className:"flex flex-wrap gap-1"},categoryPrediction.alternativas.map(function(alt,idx){var _alt$confianza;return React.createElement("button",{key:"".concat(alt.categoria,"-").concat(idx),type:"button",onClick:function onClick(){handleFieldChange("categoria",alt.categoria);clearCategoryPrediction()},className:"px-2 py-1 bg-blue-100 text-blue-700 text-xs rounded hover:bg-blue-200",title:alt.razon||alt.categoria},alt.categoria," (",Math.round(((_alt$confianza=alt.confianza)!==null&&_alt$confianza!==void 0?_alt$confianza:0)*100),"%)")})))),value&&categoryPrediction&&React.createElement("div",{className:"text-xs text-green-600"},"\u2705 Categor\xEDa aplicada por IA: ",value,"(",categoryPrediction.metodo_prediccion==="llm"?"GPT":"Reglas",")"),!categoryPrediction&&!isPredictingCategory&&React.createElement("div",{className:"text-xs text-gray-500"},"\uD83D\uDCA1 Completa la descripci\xF3n para sugerencia autom\xE1tica"))};var renderFieldInput=function renderFieldInput(fieldKey,fieldConfig,value){if((fieldConfig===null||fieldConfig===void 0?void 0:fieldConfig.type)==="select"){var _fieldConfig$options;return React.createElement("div",null,React.createElement("select",{value:value||"",onChange:function onChange(e){return handleFieldChange(fieldKey,e.target.value)},className:"w-full p-2 border border-gray-300 rounded-md text-sm"},React.createElement("option",{value:""},"Selecciona una opci\xF3n"),(_fieldConfig$options=fieldConfig.options)===null||_fieldConfig$options===void 0?void 0:_fieldConfig$options.map(function(option){return React.createElement("option",{key:option.value,value:option.value},option.label)})),fieldKey==="categoria"&&renderCategoryAssist(value))}if((fieldConfig===null||fieldConfig===void 0?void 0:fieldConfig.type)==="payment_account"){return React.createElement("div",null,React.createElement("select",{value:value||"",onChange:function onChange(e){return handleFieldChange(fieldKey,parseInt(e.target.value,10)||"")},className:"w-full p-2 border border-gray-300 rounded-md text-sm"},React.createElement("option",{value:""},"-- Selecciona cuenta --"),paymentAccounts.map(function(account){return React.createElement("option",{key:account.id,value:account.id},account.nombre," - Saldo: $",(account.saldo_actual||0).toLocaleString("es-MX"))})),paymentAccounts.length===0&&React.createElement("p",{className:"text-xs text-amber-600 mt-1"},"\u26A0\uFE0F No hay cuentas de pago disponibles. Crea una en /payment-accounts"))}if((fieldConfig===null||fieldConfig===void 0?void 0:fieldConfig.type)==="number"){return React.createElement("input",{type:"number",value:value||"",onChange:function onChange(e){return handleFieldChange(fieldKey,parseFloat(e.target.value)||0)},placeholder:fieldConfig.placeholder,className:"w-full p-2 border border-gray-300 rounded-md text-sm",step:"0.01",min:"0"})}if((fieldConfig===null||fieldConfig===void 0?void 0:fieldConfig.type)==="date"){return React.createElement("input",{type:"date",value:value||"",onChange:function onChange(e){return handleFieldChange(fieldKey,e.target.value)},className:"w-full p-2 border border-gray-300 rounded-md text-sm",max:new Date().toISOString().split("T")[0]})}if((fieldConfig===null||fieldConfig===void 0?void 0:fieldConfig.type)==="textarea"){return React.createElement("textarea",{value:value||"",onChange:function onChange(e){return handleFieldChange(fieldKey,e.target.value)},placeholder:fieldConfig.placeholder,className:"w-full p-2 border border-gray-300 rounded-md text-sm",rows:3})}return React.createElement("input",{type:"text",value:value||"",onChange:function onChange(e){return handleFieldChange(fieldKey,e.target.value)},placeholder:fieldConfig===null||fieldConfig===void 0?void 0:fieldConfig.placeholder,className:"w-full p-2 border border-gray-300 rounded-md text-sm"})};return React.createElement("div",{className:"bg-white rounded-lg shadow-md p-4 ".concat(className).trim()},React.createElement("h3",{className:"text-lg font-medium text-gray-900 mb-4 flex items-center gap-2"},React.createElement("i",{className:"fas fa-list text-orange-500"}),"Campos Pendientes"),React.createElement("div",{className:"space-y-4"},Object.entries(expenseFields||{}).map(function(_ref2){var _ref3=_slicedToArray(_ref2,2),fieldKey=_ref3[0],fieldConfig=_ref3[1];var value=getFieldValue(fieldKey);if(value)return null;var containerClass=fieldConfig!==null&&fieldConfig!==void 0&&fieldConfig.required?"border-orange-200 bg-orange-50":"border-gray-200 bg-gray-50";return React.createElement("div",{key:fieldKey,className:"border rounded-lg p-3 ".concat(containerClass)},React.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},(fieldConfig===null||fieldConfig===void 0?void 0:fieldConfig.name)||fieldKey,(fieldConfig===null||fieldConfig===void 0?void 0:fieldConfig.required)&&React.createElement("span",{className:"text-red-500 ml-1"},"*")),renderFieldInput(fieldKey,fieldConfig,value),(fieldConfig===null||fieldConfig===void 0?void 0:fieldConfig.help)&&React.createElement("p",{className:"text-xs text-gray-500 mt-1"},fieldConfig.help))})))};if(typeof window!=="undefined"){window.PendingFieldsPanel=PendingFieldsPanel}
