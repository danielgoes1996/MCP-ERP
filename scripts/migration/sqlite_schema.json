{
  "database": "unified_mcp_system.db",
  "tables": {
    "ai_context_memory": {
      "create_sql": "CREATE TABLE ai_context_memory (\n    id INTEGER PRIMARY KEY AUTOINCREMENT,\n    company_id INTEGER NOT NULL,\n    created_by INTEGER,\n    audit_log_id INTEGER,\n    context TEXT,\n    onboarding_snapshot TEXT,\n    embedding_vector TEXT,\n    model_name TEXT,\n    source TEXT,\n    language_detected TEXT,\n    context_version INTEGER NOT NULL DEFAULT 1,\n    summary TEXT,\n    topics TEXT,\n    confidence_score REAL,\n    last_refresh DATETIME DEFAULT CURRENT_TIMESTAMP,\n    created_at DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,\n    updated_at DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,\n    FOREIGN KEY (company_id) REFERENCES companies(id) ON DELETE CASCADE,\n    FOREIGN KEY (created_by) REFERENCES users(id) ON DELETE SET NULL,\n    FOREIGN KEY (audit_log_id) REFERENCES audit_trail(id) ON DELETE SET NULL\n)",
      "columns": [
        {
          "cid": 0,
          "name": "id",
          "type": "INTEGER",
          "notnull": 0,
          "default": null,
          "pk": 1
        },
        {
          "cid": 1,
          "name": "company_id",
          "type": "INTEGER",
          "notnull": 1,
          "default": null,
          "pk": 0
        },
        {
          "cid": 2,
          "name": "created_by",
          "type": "INTEGER",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 3,
          "name": "audit_log_id",
          "type": "INTEGER",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 4,
          "name": "context",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 5,
          "name": "onboarding_snapshot",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 6,
          "name": "embedding_vector",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 7,
          "name": "model_name",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 8,
          "name": "source",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 9,
          "name": "language_detected",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 10,
          "name": "context_version",
          "type": "INTEGER",
          "notnull": 1,
          "default": "1",
          "pk": 0
        },
        {
          "cid": 11,
          "name": "summary",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 12,
          "name": "topics",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 13,
          "name": "confidence_score",
          "type": "REAL",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 14,
          "name": "last_refresh",
          "type": "DATETIME",
          "notnull": 0,
          "default": "CURRENT_TIMESTAMP",
          "pk": 0
        },
        {
          "cid": 15,
          "name": "created_at",
          "type": "DATETIME",
          "notnull": 1,
          "default": "CURRENT_TIMESTAMP",
          "pk": 0
        },
        {
          "cid": 16,
          "name": "updated_at",
          "type": "DATETIME",
          "notnull": 1,
          "default": "CURRENT_TIMESTAMP",
          "pk": 0
        }
      ],
      "row_count": 1,
      "foreign_keys": [
        {
          "id": 0,
          "seq": 0,
          "table": "audit_trail",
          "from": "audit_log_id",
          "to": "id",
          "on_update": "NO ACTION",
          "on_delete": "SET NULL"
        },
        {
          "id": 1,
          "seq": 0,
          "table": "users",
          "from": "created_by",
          "to": "id",
          "on_update": "NO ACTION",
          "on_delete": "SET NULL"
        },
        {
          "id": 2,
          "seq": 0,
          "table": "companies",
          "from": "company_id",
          "to": "id",
          "on_update": "NO ACTION",
          "on_delete": "CASCADE"
        }
      ]
    },
    "ai_correction_memory": {
      "create_sql": "CREATE TABLE ai_correction_memory (\n                id INTEGER PRIMARY KEY AUTOINCREMENT,\n                company_id INTEGER NOT NULL,\n                tenant_id INTEGER,\n                user_id INTEGER,\n                original_description TEXT NOT NULL,\n                normalized_description TEXT NOT NULL,\n                ai_category TEXT,\n                corrected_category TEXT NOT NULL,\n                movement_kind TEXT,\n                amount REAL,\n                model_used TEXT,\n                notes TEXT,\n                raw_transaction TEXT,\n                embedding_json TEXT NOT NULL,\n                embedding_dimensions INTEGER NOT NULL,\n                similarity_hint REAL,\n                created_at TEXT DEFAULT CURRENT_TIMESTAMP,\n                updated_at TEXT DEFAULT CURRENT_TIMESTAMP\n            )",
      "columns": [
        {
          "cid": 0,
          "name": "id",
          "type": "INTEGER",
          "notnull": 0,
          "default": null,
          "pk": 1
        },
        {
          "cid": 1,
          "name": "company_id",
          "type": "INTEGER",
          "notnull": 1,
          "default": null,
          "pk": 0
        },
        {
          "cid": 2,
          "name": "tenant_id",
          "type": "INTEGER",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 3,
          "name": "user_id",
          "type": "INTEGER",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 4,
          "name": "original_description",
          "type": "TEXT",
          "notnull": 1,
          "default": null,
          "pk": 0
        },
        {
          "cid": 5,
          "name": "normalized_description",
          "type": "TEXT",
          "notnull": 1,
          "default": null,
          "pk": 0
        },
        {
          "cid": 6,
          "name": "ai_category",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 7,
          "name": "corrected_category",
          "type": "TEXT",
          "notnull": 1,
          "default": null,
          "pk": 0
        },
        {
          "cid": 8,
          "name": "movement_kind",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 9,
          "name": "amount",
          "type": "REAL",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 10,
          "name": "model_used",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 11,
          "name": "notes",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 12,
          "name": "raw_transaction",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 13,
          "name": "embedding_json",
          "type": "TEXT",
          "notnull": 1,
          "default": null,
          "pk": 0
        },
        {
          "cid": 14,
          "name": "embedding_dimensions",
          "type": "INTEGER",
          "notnull": 1,
          "default": null,
          "pk": 0
        },
        {
          "cid": 15,
          "name": "similarity_hint",
          "type": "REAL",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 16,
          "name": "created_at",
          "type": "TEXT",
          "notnull": 0,
          "default": "CURRENT_TIMESTAMP",
          "pk": 0
        },
        {
          "cid": 17,
          "name": "updated_at",
          "type": "TEXT",
          "notnull": 0,
          "default": "CURRENT_TIMESTAMP",
          "pk": 0
        }
      ],
      "row_count": 0,
      "foreign_keys": []
    },
    "archived_placeholders": {
      "create_sql": "CREATE TABLE archived_placeholders (\n        id INTEGER PRIMARY KEY AUTOINCREMENT,\n        original_expense_id INTEGER NOT NULL,\n        description TEXT,\n        amount REAL,\n        company_id TEXT,\n        workflow_status TEXT,\n        missing_fields TEXT,\n        created_at TEXT,\n        archived_at TEXT,\n        archived_reason TEXT,\n        metadata TEXT\n    )",
      "columns": [
        {
          "cid": 0,
          "name": "id",
          "type": "INTEGER",
          "notnull": 0,
          "default": null,
          "pk": 1
        },
        {
          "cid": 1,
          "name": "original_expense_id",
          "type": "INTEGER",
          "notnull": 1,
          "default": null,
          "pk": 0
        },
        {
          "cid": 2,
          "name": "description",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 3,
          "name": "amount",
          "type": "REAL",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 4,
          "name": "company_id",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 5,
          "name": "workflow_status",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 6,
          "name": "missing_fields",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 7,
          "name": "created_at",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 8,
          "name": "archived_at",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 9,
          "name": "archived_reason",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 10,
          "name": "metadata",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        }
      ],
      "row_count": 0,
      "foreign_keys": []
    },
    "audit_trail": {
      "create_sql": "CREATE TABLE audit_trail (\n    id INTEGER PRIMARY KEY AUTOINCREMENT,\n    entidad TEXT NOT NULL,\n    entidad_id INTEGER,\n    accion TEXT NOT NULL,\n    usuario_id INTEGER,\n    cambios TEXT,\n    created_at DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,\n    FOREIGN KEY (usuario_id) REFERENCES users(id) ON DELETE SET NULL\n)",
      "columns": [
        {
          "cid": 0,
          "name": "id",
          "type": "INTEGER",
          "notnull": 0,
          "default": null,
          "pk": 1
        },
        {
          "cid": 1,
          "name": "entidad",
          "type": "TEXT",
          "notnull": 1,
          "default": null,
          "pk": 0
        },
        {
          "cid": 2,
          "name": "entidad_id",
          "type": "INTEGER",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 3,
          "name": "accion",
          "type": "TEXT",
          "notnull": 1,
          "default": null,
          "pk": 0
        },
        {
          "cid": 4,
          "name": "usuario_id",
          "type": "INTEGER",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 5,
          "name": "cambios",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 6,
          "name": "created_at",
          "type": "DATETIME",
          "notnull": 1,
          "default": "CURRENT_TIMESTAMP",
          "pk": 0
        }
      ],
      "row_count": 2,
      "foreign_keys": [
        {
          "id": 0,
          "seq": 0,
          "table": "users",
          "from": "usuario_id",
          "to": "id",
          "on_update": "NO ACTION",
          "on_delete": "SET NULL"
        }
      ]
    },
    "automation_jobs": {
      "create_sql": "CREATE TABLE automation_jobs (\n    id INTEGER PRIMARY KEY AUTOINCREMENT,\n    ticket_id INTEGER NOT NULL,\n    merchant_id INTEGER,\n    user_id INTEGER,\n    estado TEXT NOT NULL DEFAULT 'pendiente',\n    automation_type TEXT NOT NULL DEFAULT 'selenium',\n    priority INTEGER DEFAULT 5,\n    retry_count INTEGER DEFAULT 0,\n    max_retries INTEGER DEFAULT 3,\n    config TEXT,\n    result TEXT,\n    error_details TEXT,\n    current_step TEXT,\n    progress_percentage INTEGER DEFAULT 0,\n    scheduled_at TEXT,\n    started_at TEXT,\n    completed_at TEXT,\n    estimated_completion TEXT,\n    session_id TEXT NOT NULL,\n    company_id TEXT NOT NULL DEFAULT 'default',\n    selenium_session_id TEXT,\n    captcha_attempts INTEGER DEFAULT 0,\n    ocr_confidence REAL,\n    created_at TEXT NOT NULL DEFAULT (datetime('now')),\n    updated_at TEXT NOT NULL DEFAULT (datetime('now')), checkpoint_data TEXT, recovery_metadata TEXT, automation_health TEXT, performance_metrics TEXT, recovery_actions TEXT,\n    FOREIGN KEY (ticket_id) REFERENCES tickets(id),\n    FOREIGN KEY (user_id) REFERENCES users(id)\n)",
      "columns": [
        {
          "cid": 0,
          "name": "id",
          "type": "INTEGER",
          "notnull": 0,
          "default": null,
          "pk": 1
        },
        {
          "cid": 1,
          "name": "ticket_id",
          "type": "INTEGER",
          "notnull": 1,
          "default": null,
          "pk": 0
        },
        {
          "cid": 2,
          "name": "merchant_id",
          "type": "INTEGER",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 3,
          "name": "user_id",
          "type": "INTEGER",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 4,
          "name": "estado",
          "type": "TEXT",
          "notnull": 1,
          "default": "'pendiente'",
          "pk": 0
        },
        {
          "cid": 5,
          "name": "automation_type",
          "type": "TEXT",
          "notnull": 1,
          "default": "'selenium'",
          "pk": 0
        },
        {
          "cid": 6,
          "name": "priority",
          "type": "INTEGER",
          "notnull": 0,
          "default": "5",
          "pk": 0
        },
        {
          "cid": 7,
          "name": "retry_count",
          "type": "INTEGER",
          "notnull": 0,
          "default": "0",
          "pk": 0
        },
        {
          "cid": 8,
          "name": "max_retries",
          "type": "INTEGER",
          "notnull": 0,
          "default": "3",
          "pk": 0
        },
        {
          "cid": 9,
          "name": "config",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 10,
          "name": "result",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 11,
          "name": "error_details",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 12,
          "name": "current_step",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 13,
          "name": "progress_percentage",
          "type": "INTEGER",
          "notnull": 0,
          "default": "0",
          "pk": 0
        },
        {
          "cid": 14,
          "name": "scheduled_at",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 15,
          "name": "started_at",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 16,
          "name": "completed_at",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 17,
          "name": "estimated_completion",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 18,
          "name": "session_id",
          "type": "TEXT",
          "notnull": 1,
          "default": null,
          "pk": 0
        },
        {
          "cid": 19,
          "name": "company_id",
          "type": "TEXT",
          "notnull": 1,
          "default": "'default'",
          "pk": 0
        },
        {
          "cid": 20,
          "name": "selenium_session_id",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 21,
          "name": "captcha_attempts",
          "type": "INTEGER",
          "notnull": 0,
          "default": "0",
          "pk": 0
        },
        {
          "cid": 22,
          "name": "ocr_confidence",
          "type": "REAL",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 23,
          "name": "created_at",
          "type": "TEXT",
          "notnull": 1,
          "default": "datetime('now')",
          "pk": 0
        },
        {
          "cid": 24,
          "name": "updated_at",
          "type": "TEXT",
          "notnull": 1,
          "default": "datetime('now')",
          "pk": 0
        },
        {
          "cid": 25,
          "name": "checkpoint_data",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 26,
          "name": "recovery_metadata",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 27,
          "name": "automation_health",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 28,
          "name": "performance_metrics",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 29,
          "name": "recovery_actions",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        }
      ],
      "row_count": 0,
      "foreign_keys": [
        {
          "id": 0,
          "seq": 0,
          "table": "users",
          "from": "user_id",
          "to": "id",
          "on_update": "NO ACTION",
          "on_delete": "NO ACTION"
        },
        {
          "id": 1,
          "seq": 0,
          "table": "tickets",
          "from": "ticket_id",
          "to": "id",
          "on_update": "NO ACTION",
          "on_delete": "NO ACTION"
        }
      ]
    },
    "automation_logs": {
      "create_sql": "CREATE TABLE automation_logs (\n    id INTEGER PRIMARY KEY AUTOINCREMENT,\n    job_id INTEGER NOT NULL,\n    session_id TEXT NOT NULL,\n    level TEXT NOT NULL DEFAULT 'info',\n    category TEXT,\n    message TEXT NOT NULL,\n    url TEXT,\n    element_selector TEXT,\n    screenshot_id INTEGER,\n    execution_time_ms INTEGER,\n    data TEXT,\n    user_agent TEXT,\n    ip_address TEXT,\n    timestamp TEXT NOT NULL DEFAULT (datetime('now')),\n    company_id TEXT NOT NULL DEFAULT 'default',\n    FOREIGN KEY (job_id) REFERENCES automation_jobs(id)\n)",
      "columns": [
        {
          "cid": 0,
          "name": "id",
          "type": "INTEGER",
          "notnull": 0,
          "default": null,
          "pk": 1
        },
        {
          "cid": 1,
          "name": "job_id",
          "type": "INTEGER",
          "notnull": 1,
          "default": null,
          "pk": 0
        },
        {
          "cid": 2,
          "name": "session_id",
          "type": "TEXT",
          "notnull": 1,
          "default": null,
          "pk": 0
        },
        {
          "cid": 3,
          "name": "level",
          "type": "TEXT",
          "notnull": 1,
          "default": "'info'",
          "pk": 0
        },
        {
          "cid": 4,
          "name": "category",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 5,
          "name": "message",
          "type": "TEXT",
          "notnull": 1,
          "default": null,
          "pk": 0
        },
        {
          "cid": 6,
          "name": "url",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 7,
          "name": "element_selector",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 8,
          "name": "screenshot_id",
          "type": "INTEGER",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 9,
          "name": "execution_time_ms",
          "type": "INTEGER",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 10,
          "name": "data",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 11,
          "name": "user_agent",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 12,
          "name": "ip_address",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 13,
          "name": "timestamp",
          "type": "TEXT",
          "notnull": 1,
          "default": "datetime('now')",
          "pk": 0
        },
        {
          "cid": 14,
          "name": "company_id",
          "type": "TEXT",
          "notnull": 1,
          "default": "'default'",
          "pk": 0
        }
      ],
      "row_count": 0,
      "foreign_keys": [
        {
          "id": 0,
          "seq": 0,
          "table": "automation_jobs",
          "from": "job_id",
          "to": "id",
          "on_update": "NO ACTION",
          "on_delete": "NO ACTION"
        }
      ]
    },
    "automation_screenshots": {
      "create_sql": "CREATE TABLE automation_screenshots (\n    id INTEGER PRIMARY KEY AUTOINCREMENT,\n    job_id INTEGER NOT NULL,\n    session_id TEXT NOT NULL,\n    step_name TEXT NOT NULL,\n    screenshot_type TEXT NOT NULL DEFAULT 'step',\n    file_path TEXT NOT NULL,\n    file_size INTEGER,\n    url TEXT,\n    window_title TEXT,\n    viewport_size TEXT,\n    page_load_time_ms INTEGER,\n    has_captcha INTEGER DEFAULT 0,\n    captcha_type TEXT,\n    detected_elements TEXT,\n    ocr_text TEXT,\n    manual_annotations TEXT,\n    is_sensitive INTEGER DEFAULT 0,\n    created_at TEXT NOT NULL DEFAULT (datetime('now')),\n    company_id TEXT NOT NULL DEFAULT 'default',\n    FOREIGN KEY (job_id) REFERENCES automation_jobs(id)\n)",
      "columns": [
        {
          "cid": 0,
          "name": "id",
          "type": "INTEGER",
          "notnull": 0,
          "default": null,
          "pk": 1
        },
        {
          "cid": 1,
          "name": "job_id",
          "type": "INTEGER",
          "notnull": 1,
          "default": null,
          "pk": 0
        },
        {
          "cid": 2,
          "name": "session_id",
          "type": "TEXT",
          "notnull": 1,
          "default": null,
          "pk": 0
        },
        {
          "cid": 3,
          "name": "step_name",
          "type": "TEXT",
          "notnull": 1,
          "default": null,
          "pk": 0
        },
        {
          "cid": 4,
          "name": "screenshot_type",
          "type": "TEXT",
          "notnull": 1,
          "default": "'step'",
          "pk": 0
        },
        {
          "cid": 5,
          "name": "file_path",
          "type": "TEXT",
          "notnull": 1,
          "default": null,
          "pk": 0
        },
        {
          "cid": 6,
          "name": "file_size",
          "type": "INTEGER",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 7,
          "name": "url",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 8,
          "name": "window_title",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 9,
          "name": "viewport_size",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 10,
          "name": "page_load_time_ms",
          "type": "INTEGER",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 11,
          "name": "has_captcha",
          "type": "INTEGER",
          "notnull": 0,
          "default": "0",
          "pk": 0
        },
        {
          "cid": 12,
          "name": "captcha_type",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 13,
          "name": "detected_elements",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 14,
          "name": "ocr_text",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 15,
          "name": "manual_annotations",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 16,
          "name": "is_sensitive",
          "type": "INTEGER",
          "notnull": 0,
          "default": "0",
          "pk": 0
        },
        {
          "cid": 17,
          "name": "created_at",
          "type": "TEXT",
          "notnull": 1,
          "default": "datetime('now')",
          "pk": 0
        },
        {
          "cid": 18,
          "name": "company_id",
          "type": "TEXT",
          "notnull": 1,
          "default": "'default'",
          "pk": 0
        }
      ],
      "row_count": 0,
      "foreign_keys": [
        {
          "id": 0,
          "seq": 0,
          "table": "automation_jobs",
          "from": "job_id",
          "to": "id",
          "on_update": "NO ACTION",
          "on_delete": "NO ACTION"
        }
      ]
    },
    "automation_sessions": {
      "create_sql": "CREATE TABLE automation_sessions (\n    id INTEGER PRIMARY KEY AUTOINCREMENT,\n    session_id TEXT UNIQUE NOT NULL,\n    tenant_id INTEGER NOT NULL,\n    state_data TEXT, -- JSON as TEXT\n    checkpoint_data TEXT, -- \u2705 CAMPO FALTANTE CR\u00cdTICO (JSON as TEXT)\n    recovery_metadata TEXT, -- \u2705 CAMPO FALTANTE CR\u00cdTICO (JSON as TEXT)\n    session_status TEXT DEFAULT 'active',\n    compression_type TEXT DEFAULT 'gzip',\n    integrity_validation TEXT, -- JSON as TEXT\n    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    FOREIGN KEY (tenant_id) REFERENCES tenants(id)\n)",
      "columns": [
        {
          "cid": 0,
          "name": "id",
          "type": "INTEGER",
          "notnull": 0,
          "default": null,
          "pk": 1
        },
        {
          "cid": 1,
          "name": "session_id",
          "type": "TEXT",
          "notnull": 1,
          "default": null,
          "pk": 0
        },
        {
          "cid": 2,
          "name": "tenant_id",
          "type": "INTEGER",
          "notnull": 1,
          "default": null,
          "pk": 0
        },
        {
          "cid": 3,
          "name": "state_data",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 4,
          "name": "checkpoint_data",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 5,
          "name": "recovery_metadata",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 6,
          "name": "session_status",
          "type": "TEXT",
          "notnull": 0,
          "default": "'active'",
          "pk": 0
        },
        {
          "cid": 7,
          "name": "compression_type",
          "type": "TEXT",
          "notnull": 0,
          "default": "'gzip'",
          "pk": 0
        },
        {
          "cid": 8,
          "name": "integrity_validation",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 9,
          "name": "created_at",
          "type": "TIMESTAMP",
          "notnull": 0,
          "default": "CURRENT_TIMESTAMP",
          "pk": 0
        },
        {
          "cid": 10,
          "name": "updated_at",
          "type": "TIMESTAMP",
          "notnull": 0,
          "default": "CURRENT_TIMESTAMP",
          "pk": 0
        }
      ],
      "row_count": 0,
      "foreign_keys": [
        {
          "id": 0,
          "seq": 0,
          "table": "tenants",
          "from": "tenant_id",
          "to": "id",
          "on_update": "NO ACTION",
          "on_delete": "NO ACTION"
        }
      ]
    },
    "bank_match_links": {
      "create_sql": "CREATE TABLE bank_match_links (\n    id INTEGER PRIMARY KEY AUTOINCREMENT,\n    bank_movement_id INTEGER NOT NULL REFERENCES bank_movements(id) ON DELETE CASCADE,\n    expense_id INTEGER REFERENCES expense_records(id),\n    cfdi_uuid TEXT REFERENCES expense_invoices(uuid),\n    monto_asignado REAL NOT NULL,\n    score REAL,\n    source TEXT,\n    explanation TEXT,\n    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    created_by INTEGER,\n    tenant_id INTEGER,\n    UNIQUE (bank_movement_id, expense_id, cfdi_uuid)\n)",
      "columns": [
        {
          "cid": 0,
          "name": "id",
          "type": "INTEGER",
          "notnull": 0,
          "default": null,
          "pk": 1
        },
        {
          "cid": 1,
          "name": "bank_movement_id",
          "type": "INTEGER",
          "notnull": 1,
          "default": null,
          "pk": 0
        },
        {
          "cid": 2,
          "name": "expense_id",
          "type": "INTEGER",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 3,
          "name": "cfdi_uuid",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 4,
          "name": "monto_asignado",
          "type": "REAL",
          "notnull": 1,
          "default": null,
          "pk": 0
        },
        {
          "cid": 5,
          "name": "score",
          "type": "REAL",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 6,
          "name": "source",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 7,
          "name": "explanation",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 8,
          "name": "created_at",
          "type": "TIMESTAMP",
          "notnull": 0,
          "default": "CURRENT_TIMESTAMP",
          "pk": 0
        },
        {
          "cid": 9,
          "name": "created_by",
          "type": "INTEGER",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 10,
          "name": "tenant_id",
          "type": "INTEGER",
          "notnull": 0,
          "default": null,
          "pk": 0
        }
      ],
      "row_count": 0,
      "foreign_keys": [
        {
          "id": 0,
          "seq": 0,
          "table": "expense_invoices",
          "from": "cfdi_uuid",
          "to": "uuid",
          "on_update": "NO ACTION",
          "on_delete": "NO ACTION"
        },
        {
          "id": 1,
          "seq": 0,
          "table": "expense_records",
          "from": "expense_id",
          "to": "id",
          "on_update": "NO ACTION",
          "on_delete": "NO ACTION"
        },
        {
          "id": 2,
          "seq": 0,
          "table": "bank_movements",
          "from": "bank_movement_id",
          "to": "id",
          "on_update": "NO ACTION",
          "on_delete": "CASCADE"
        }
      ]
    },
    "bank_movements": {
      "create_sql": "CREATE TABLE bank_movements (\n    id INTEGER PRIMARY KEY AUTOINCREMENT,\n    amount REAL NOT NULL,\n    description TEXT,\n    date TIMESTAMP,\n    account TEXT,\n    tenant_id INTEGER,\n    matched_expense_id INTEGER,\n    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP, movement_kind TEXT DEFAULT 'Gasto', decision TEXT, bank_metadata TEXT, confidence REAL DEFAULT 0.0, movement_id TEXT, transaction_type TEXT, reference TEXT, balance_after REAL, raw_data TEXT, processing_status TEXT DEFAULT 'pending', matched_at TIMESTAMP, matched_by INTEGER, auto_matched BOOLEAN DEFAULT FALSE, reconciliation_notes TEXT, bank_account_id TEXT, category TEXT, context_used TEXT, ai_model TEXT, context_confidence REAL, context_version TEXT, matching_confidence REAL,\n    FOREIGN KEY (tenant_id) REFERENCES tenants(id),\n    FOREIGN KEY (matched_expense_id) REFERENCES expense_records(id)\n)",
      "columns": [
        {
          "cid": 0,
          "name": "id",
          "type": "INTEGER",
          "notnull": 0,
          "default": null,
          "pk": 1
        },
        {
          "cid": 1,
          "name": "amount",
          "type": "REAL",
          "notnull": 1,
          "default": null,
          "pk": 0
        },
        {
          "cid": 2,
          "name": "description",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 3,
          "name": "date",
          "type": "TIMESTAMP",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 4,
          "name": "account",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 5,
          "name": "tenant_id",
          "type": "INTEGER",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 6,
          "name": "matched_expense_id",
          "type": "INTEGER",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 7,
          "name": "created_at",
          "type": "TIMESTAMP",
          "notnull": 0,
          "default": "CURRENT_TIMESTAMP",
          "pk": 0
        },
        {
          "cid": 8,
          "name": "movement_kind",
          "type": "TEXT",
          "notnull": 0,
          "default": "'Gasto'",
          "pk": 0
        },
        {
          "cid": 9,
          "name": "decision",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 10,
          "name": "bank_metadata",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 11,
          "name": "confidence",
          "type": "REAL",
          "notnull": 0,
          "default": "0.0",
          "pk": 0
        },
        {
          "cid": 12,
          "name": "movement_id",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 13,
          "name": "transaction_type",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 14,
          "name": "reference",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 15,
          "name": "balance_after",
          "type": "REAL",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 16,
          "name": "raw_data",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 17,
          "name": "processing_status",
          "type": "TEXT",
          "notnull": 0,
          "default": "'pending'",
          "pk": 0
        },
        {
          "cid": 18,
          "name": "matched_at",
          "type": "TIMESTAMP",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 19,
          "name": "matched_by",
          "type": "INTEGER",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 20,
          "name": "auto_matched",
          "type": "BOOLEAN",
          "notnull": 0,
          "default": "FALSE",
          "pk": 0
        },
        {
          "cid": 21,
          "name": "reconciliation_notes",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 22,
          "name": "bank_account_id",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 23,
          "name": "category",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 24,
          "name": "context_used",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 25,
          "name": "ai_model",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 26,
          "name": "context_confidence",
          "type": "REAL",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 27,
          "name": "context_version",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 28,
          "name": "matching_confidence",
          "type": "REAL",
          "notnull": 0,
          "default": null,
          "pk": 0
        }
      ],
      "row_count": 0,
      "foreign_keys": [
        {
          "id": 0,
          "seq": 0,
          "table": "expense_records",
          "from": "matched_expense_id",
          "to": "id",
          "on_update": "NO ACTION",
          "on_delete": "NO ACTION"
        },
        {
          "id": 1,
          "seq": 0,
          "table": "tenants",
          "from": "tenant_id",
          "to": "id",
          "on_update": "NO ACTION",
          "on_delete": "NO ACTION"
        }
      ]
    },
    "banking_institutions": {
      "create_sql": "CREATE TABLE banking_institutions (\n    id INTEGER PRIMARY KEY AUTOINCREMENT,\n    name TEXT NOT NULL UNIQUE,\n    short_name TEXT,\n    type TEXT NOT NULL DEFAULT 'bank',\n    active BOOLEAN NOT NULL DEFAULT TRUE,\n    sort_order INTEGER DEFAULT 100,\n    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n\n    CHECK (type IN ('bank', 'credit_union', 'fintech', 'other'))\n)",
      "columns": [
        {
          "cid": 0,
          "name": "id",
          "type": "INTEGER",
          "notnull": 0,
          "default": null,
          "pk": 1
        },
        {
          "cid": 1,
          "name": "name",
          "type": "TEXT",
          "notnull": 1,
          "default": null,
          "pk": 0
        },
        {
          "cid": 2,
          "name": "short_name",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 3,
          "name": "type",
          "type": "TEXT",
          "notnull": 1,
          "default": "'bank'",
          "pk": 0
        },
        {
          "cid": 4,
          "name": "active",
          "type": "BOOLEAN",
          "notnull": 1,
          "default": "TRUE",
          "pk": 0
        },
        {
          "cid": 5,
          "name": "sort_order",
          "type": "INTEGER",
          "notnull": 0,
          "default": "100",
          "pk": 0
        },
        {
          "cid": 6,
          "name": "created_at",
          "type": "TIMESTAMP",
          "notnull": 0,
          "default": "CURRENT_TIMESTAMP",
          "pk": 0
        }
      ],
      "row_count": 30,
      "foreign_keys": []
    },
    "category_learning_metrics": {
      "create_sql": "CREATE TABLE category_learning_metrics (\n    id INTEGER PRIMARY KEY AUTOINCREMENT,\n    tenant_id INTEGER NOT NULL,\n    user_id INTEGER DEFAULT NULL,\n    category_name TEXT NOT NULL,\n    total_predictions INTEGER DEFAULT 0,\n    correct_predictions INTEGER DEFAULT 0,\n    accuracy_rate REAL DEFAULT 0.0,\n    avg_confidence REAL DEFAULT 0.0,\n    most_common_keywords TEXT, -- JSON array\n    most_common_merchants TEXT, -- JSON array\n    typical_amount_range TEXT, -- e.g., \"100-500\"\n    last_updated TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    FOREIGN KEY (tenant_id) REFERENCES tenants(id),\n    FOREIGN KEY (user_id) REFERENCES users(id)\n)",
      "columns": [
        {
          "cid": 0,
          "name": "id",
          "type": "INTEGER",
          "notnull": 0,
          "default": null,
          "pk": 1
        },
        {
          "cid": 1,
          "name": "tenant_id",
          "type": "INTEGER",
          "notnull": 1,
          "default": null,
          "pk": 0
        },
        {
          "cid": 2,
          "name": "user_id",
          "type": "INTEGER",
          "notnull": 0,
          "default": "NULL",
          "pk": 0
        },
        {
          "cid": 3,
          "name": "category_name",
          "type": "TEXT",
          "notnull": 1,
          "default": null,
          "pk": 0
        },
        {
          "cid": 4,
          "name": "total_predictions",
          "type": "INTEGER",
          "notnull": 0,
          "default": "0",
          "pk": 0
        },
        {
          "cid": 5,
          "name": "correct_predictions",
          "type": "INTEGER",
          "notnull": 0,
          "default": "0",
          "pk": 0
        },
        {
          "cid": 6,
          "name": "accuracy_rate",
          "type": "REAL",
          "notnull": 0,
          "default": "0.0",
          "pk": 0
        },
        {
          "cid": 7,
          "name": "avg_confidence",
          "type": "REAL",
          "notnull": 0,
          "default": "0.0",
          "pk": 0
        },
        {
          "cid": 8,
          "name": "most_common_keywords",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 9,
          "name": "most_common_merchants",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 10,
          "name": "typical_amount_range",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 11,
          "name": "last_updated",
          "type": "TIMESTAMP",
          "notnull": 0,
          "default": "CURRENT_TIMESTAMP",
          "pk": 0
        }
      ],
      "row_count": 0,
      "foreign_keys": [
        {
          "id": 0,
          "seq": 0,
          "table": "users",
          "from": "user_id",
          "to": "id",
          "on_update": "NO ACTION",
          "on_delete": "NO ACTION"
        },
        {
          "id": 1,
          "seq": 0,
          "table": "tenants",
          "from": "tenant_id",
          "to": "id",
          "on_update": "NO ACTION",
          "on_delete": "NO ACTION"
        }
      ]
    },
    "category_prediction_config": {
      "create_sql": "CREATE TABLE category_prediction_config (\n    id INTEGER PRIMARY KEY AUTOINCREMENT,\n    tenant_id INTEGER NOT NULL,\n    enabled BOOLEAN DEFAULT TRUE,\n    auto_apply_high_confidence BOOLEAN DEFAULT TRUE, -- Auto-aplicar si confianza > threshold\n    high_confidence_threshold REAL DEFAULT 0.85,\n    medium_confidence_threshold REAL DEFAULT 0.65,\n    use_llm BOOLEAN DEFAULT TRUE,\n    llm_model TEXT DEFAULT 'gpt-3.5-turbo',\n    use_user_history BOOLEAN DEFAULT TRUE,\n    history_weight REAL DEFAULT 0.3, -- Peso del historial en la predicci\u00f3n\n    categories_config TEXT, -- JSON config for categories\n    features_weights TEXT, -- JSON weights for different features\n    fallback_category TEXT DEFAULT 'oficina',\n    require_manual_review BOOLEAN DEFAULT FALSE, -- Require manual review for low confidence\n    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    FOREIGN KEY (tenant_id) REFERENCES tenants(id)\n)",
      "columns": [
        {
          "cid": 0,
          "name": "id",
          "type": "INTEGER",
          "notnull": 0,
          "default": null,
          "pk": 1
        },
        {
          "cid": 1,
          "name": "tenant_id",
          "type": "INTEGER",
          "notnull": 1,
          "default": null,
          "pk": 0
        },
        {
          "cid": 2,
          "name": "enabled",
          "type": "BOOLEAN",
          "notnull": 0,
          "default": "TRUE",
          "pk": 0
        },
        {
          "cid": 3,
          "name": "auto_apply_high_confidence",
          "type": "BOOLEAN",
          "notnull": 0,
          "default": "TRUE",
          "pk": 0
        },
        {
          "cid": 4,
          "name": "high_confidence_threshold",
          "type": "REAL",
          "notnull": 0,
          "default": "0.85",
          "pk": 0
        },
        {
          "cid": 5,
          "name": "medium_confidence_threshold",
          "type": "REAL",
          "notnull": 0,
          "default": "0.65",
          "pk": 0
        },
        {
          "cid": 6,
          "name": "use_llm",
          "type": "BOOLEAN",
          "notnull": 0,
          "default": "TRUE",
          "pk": 0
        },
        {
          "cid": 7,
          "name": "llm_model",
          "type": "TEXT",
          "notnull": 0,
          "default": "'gpt-3.5-turbo'",
          "pk": 0
        },
        {
          "cid": 8,
          "name": "use_user_history",
          "type": "BOOLEAN",
          "notnull": 0,
          "default": "TRUE",
          "pk": 0
        },
        {
          "cid": 9,
          "name": "history_weight",
          "type": "REAL",
          "notnull": 0,
          "default": "0.3",
          "pk": 0
        },
        {
          "cid": 10,
          "name": "categories_config",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 11,
          "name": "features_weights",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 12,
          "name": "fallback_category",
          "type": "TEXT",
          "notnull": 0,
          "default": "'oficina'",
          "pk": 0
        },
        {
          "cid": 13,
          "name": "require_manual_review",
          "type": "BOOLEAN",
          "notnull": 0,
          "default": "FALSE",
          "pk": 0
        },
        {
          "cid": 14,
          "name": "created_at",
          "type": "TIMESTAMP",
          "notnull": 0,
          "default": "CURRENT_TIMESTAMP",
          "pk": 0
        },
        {
          "cid": 15,
          "name": "updated_at",
          "type": "TIMESTAMP",
          "notnull": 0,
          "default": "CURRENT_TIMESTAMP",
          "pk": 0
        }
      ],
      "row_count": 1,
      "foreign_keys": [
        {
          "id": 0,
          "seq": 0,
          "table": "tenants",
          "from": "tenant_id",
          "to": "id",
          "on_update": "NO ACTION",
          "on_delete": "NO ACTION"
        }
      ]
    },
    "category_prediction_history": {
      "create_sql": "CREATE TABLE category_prediction_history (\n    id INTEGER PRIMARY KEY AUTOINCREMENT,\n    expense_id INTEGER NOT NULL,\n    predicted_category TEXT NOT NULL,\n    confidence REAL NOT NULL,\n    reasoning TEXT,\n    alternatives TEXT, -- JSON array of alternatives\n    prediction_method TEXT DEFAULT 'hybrid', -- llm, rules, hybrid\n    ml_model_version TEXT DEFAULT '1.0',\n    user_feedback TEXT DEFAULT NULL, -- accepted, corrected, rejected\n    corrected_category TEXT DEFAULT NULL,\n    feedback_date TIMESTAMP DEFAULT NULL,\n    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    tenant_id INTEGER NOT NULL,\n    FOREIGN KEY (expense_id) REFERENCES expense_records(id),\n    FOREIGN KEY (tenant_id) REFERENCES tenants(id)\n)",
      "columns": [
        {
          "cid": 0,
          "name": "id",
          "type": "INTEGER",
          "notnull": 0,
          "default": null,
          "pk": 1
        },
        {
          "cid": 1,
          "name": "expense_id",
          "type": "INTEGER",
          "notnull": 1,
          "default": null,
          "pk": 0
        },
        {
          "cid": 2,
          "name": "predicted_category",
          "type": "TEXT",
          "notnull": 1,
          "default": null,
          "pk": 0
        },
        {
          "cid": 3,
          "name": "confidence",
          "type": "REAL",
          "notnull": 1,
          "default": null,
          "pk": 0
        },
        {
          "cid": 4,
          "name": "reasoning",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 5,
          "name": "alternatives",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 6,
          "name": "prediction_method",
          "type": "TEXT",
          "notnull": 0,
          "default": "'hybrid'",
          "pk": 0
        },
        {
          "cid": 7,
          "name": "ml_model_version",
          "type": "TEXT",
          "notnull": 0,
          "default": "'1.0'",
          "pk": 0
        },
        {
          "cid": 8,
          "name": "user_feedback",
          "type": "TEXT",
          "notnull": 0,
          "default": "NULL",
          "pk": 0
        },
        {
          "cid": 9,
          "name": "corrected_category",
          "type": "TEXT",
          "notnull": 0,
          "default": "NULL",
          "pk": 0
        },
        {
          "cid": 10,
          "name": "feedback_date",
          "type": "TIMESTAMP",
          "notnull": 0,
          "default": "NULL",
          "pk": 0
        },
        {
          "cid": 11,
          "name": "created_at",
          "type": "TIMESTAMP",
          "notnull": 0,
          "default": "CURRENT_TIMESTAMP",
          "pk": 0
        },
        {
          "cid": 12,
          "name": "tenant_id",
          "type": "INTEGER",
          "notnull": 1,
          "default": null,
          "pk": 0
        }
      ],
      "row_count": 40,
      "foreign_keys": [
        {
          "id": 0,
          "seq": 0,
          "table": "tenants",
          "from": "tenant_id",
          "to": "id",
          "on_update": "NO ACTION",
          "on_delete": "NO ACTION"
        },
        {
          "id": 1,
          "seq": 0,
          "table": "expense_records",
          "from": "expense_id",
          "to": "id",
          "on_update": "NO ACTION",
          "on_delete": "NO ACTION"
        }
      ]
    },
    "cfdi_payments": {
      "create_sql": "CREATE TABLE cfdi_payments (\n    id INTEGER PRIMARY KEY AUTOINCREMENT,\n    uuid_pago TEXT NOT NULL UNIQUE,\n    fecha_pago TIMESTAMP NOT NULL,\n    moneda TEXT DEFAULT 'MXN',\n    tipo_cambio REAL DEFAULT 1.0,\n    tenant_id INTEGER,\n    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP\n)",
      "columns": [
        {
          "cid": 0,
          "name": "id",
          "type": "INTEGER",
          "notnull": 0,
          "default": null,
          "pk": 1
        },
        {
          "cid": 1,
          "name": "uuid_pago",
          "type": "TEXT",
          "notnull": 1,
          "default": null,
          "pk": 0
        },
        {
          "cid": 2,
          "name": "fecha_pago",
          "type": "TIMESTAMP",
          "notnull": 1,
          "default": null,
          "pk": 0
        },
        {
          "cid": 3,
          "name": "moneda",
          "type": "TEXT",
          "notnull": 0,
          "default": "'MXN'",
          "pk": 0
        },
        {
          "cid": 4,
          "name": "tipo_cambio",
          "type": "REAL",
          "notnull": 0,
          "default": "1.0",
          "pk": 0
        },
        {
          "cid": 5,
          "name": "tenant_id",
          "type": "INTEGER",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 6,
          "name": "created_at",
          "type": "TIMESTAMP",
          "notnull": 0,
          "default": "CURRENT_TIMESTAMP",
          "pk": 0
        }
      ],
      "row_count": 0,
      "foreign_keys": []
    },
    "classification_trace": {
      "create_sql": "CREATE TABLE classification_trace (id INTEGER PRIMARY KEY AUTOINCREMENT, expense_id INTEGER NOT NULL, tenant_id INTEGER NOT NULL, sat_account_code TEXT, family_code TEXT, confidence_sat REAL, confidence_family REAL, explanation_short TEXT, explanation_detail TEXT, tokens TEXT, model_version TEXT, embedding_version TEXT, raw_payload TEXT, created_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP)",
      "columns": [
        {
          "cid": 0,
          "name": "id",
          "type": "INTEGER",
          "notnull": 0,
          "default": null,
          "pk": 1
        },
        {
          "cid": 1,
          "name": "expense_id",
          "type": "INTEGER",
          "notnull": 1,
          "default": null,
          "pk": 0
        },
        {
          "cid": 2,
          "name": "tenant_id",
          "type": "INTEGER",
          "notnull": 1,
          "default": null,
          "pk": 0
        },
        {
          "cid": 3,
          "name": "sat_account_code",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 4,
          "name": "family_code",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 5,
          "name": "confidence_sat",
          "type": "REAL",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 6,
          "name": "confidence_family",
          "type": "REAL",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 7,
          "name": "explanation_short",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 8,
          "name": "explanation_detail",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 9,
          "name": "tokens",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 10,
          "name": "model_version",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 11,
          "name": "embedding_version",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 12,
          "name": "raw_payload",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 13,
          "name": "created_at",
          "type": "TIMESTAMP",
          "notnull": 1,
          "default": "CURRENT_TIMESTAMP",
          "pk": 0
        }
      ],
      "row_count": 33,
      "foreign_keys": []
    },
    "companies": {
      "create_sql": "CREATE TABLE companies (\n    id INTEGER PRIMARY KEY AUTOINCREMENT,\n    tenant_id INTEGER NOT NULL,\n    company_name TEXT NOT NULL,\n    legal_name TEXT,\n    short_name TEXT,\n    email TEXT,\n    is_active BOOLEAN DEFAULT 1,\n    config TEXT,\n    giro TEXT,\n    modelo_negocio TEXT,\n    clientes_clave TEXT,\n    proveedores_clave TEXT,\n    canales_venta TEXT,\n    frecuencia_operacion TEXT,\n    descripcion_negocio TEXT,\n    context_last_updated TIMESTAMP,\n    context_profile TEXT,\n    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    FOREIGN KEY (tenant_id) REFERENCES tenants(id)\n)",
      "columns": [
        {
          "cid": 0,
          "name": "id",
          "type": "INTEGER",
          "notnull": 0,
          "default": null,
          "pk": 1
        },
        {
          "cid": 1,
          "name": "tenant_id",
          "type": "INTEGER",
          "notnull": 1,
          "default": null,
          "pk": 0
        },
        {
          "cid": 2,
          "name": "company_name",
          "type": "TEXT",
          "notnull": 1,
          "default": null,
          "pk": 0
        },
        {
          "cid": 3,
          "name": "legal_name",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 4,
          "name": "short_name",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 5,
          "name": "email",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 6,
          "name": "is_active",
          "type": "BOOLEAN",
          "notnull": 0,
          "default": "1",
          "pk": 0
        },
        {
          "cid": 7,
          "name": "config",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 8,
          "name": "giro",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 9,
          "name": "modelo_negocio",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 10,
          "name": "clientes_clave",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 11,
          "name": "proveedores_clave",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 12,
          "name": "canales_venta",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 13,
          "name": "frecuencia_operacion",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 14,
          "name": "descripcion_negocio",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 15,
          "name": "context_last_updated",
          "type": "TIMESTAMP",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 16,
          "name": "context_profile",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 17,
          "name": "created_at",
          "type": "TIMESTAMP",
          "notnull": 0,
          "default": "CURRENT_TIMESTAMP",
          "pk": 0
        },
        {
          "cid": 18,
          "name": "updated_at",
          "type": "TIMESTAMP",
          "notnull": 0,
          "default": "CURRENT_TIMESTAMP",
          "pk": 0
        }
      ],
      "row_count": 2,
      "foreign_keys": [
        {
          "id": 0,
          "seq": 0,
          "table": "tenants",
          "from": "tenant_id",
          "to": "id",
          "on_update": "NO ACTION",
          "on_delete": "NO ACTION"
        }
      ]
    },
    "custom_categories": {
      "create_sql": "CREATE TABLE custom_categories (\n    id INTEGER PRIMARY KEY AUTOINCREMENT,\n    tenant_id INTEGER NOT NULL,\n    category_name TEXT NOT NULL,\n    category_description TEXT,\n    parent_category TEXT DEFAULT NULL, -- Para jerarqu\u00edas de categor\u00edas\n    color_hex TEXT DEFAULT '#6B7280', -- Color para UI\n    icon_name TEXT DEFAULT 'folder', -- Icono para UI\n    keywords TEXT, -- JSON array of detection keywords\n    merchant_patterns TEXT, -- JSON array of merchant patterns\n    amount_ranges TEXT, -- JSON array of typical amount ranges\n    tax_deductible BOOLEAN DEFAULT TRUE,\n    requires_receipt BOOLEAN DEFAULT TRUE,\n    sort_order INTEGER DEFAULT 0,\n    is_active BOOLEAN DEFAULT TRUE,\n    created_by INTEGER NOT NULL,\n    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    FOREIGN KEY (tenant_id) REFERENCES tenants(id),\n    FOREIGN KEY (created_by) REFERENCES users(id)\n)",
      "columns": [
        {
          "cid": 0,
          "name": "id",
          "type": "INTEGER",
          "notnull": 0,
          "default": null,
          "pk": 1
        },
        {
          "cid": 1,
          "name": "tenant_id",
          "type": "INTEGER",
          "notnull": 1,
          "default": null,
          "pk": 0
        },
        {
          "cid": 2,
          "name": "category_name",
          "type": "TEXT",
          "notnull": 1,
          "default": null,
          "pk": 0
        },
        {
          "cid": 3,
          "name": "category_description",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 4,
          "name": "parent_category",
          "type": "TEXT",
          "notnull": 0,
          "default": "NULL",
          "pk": 0
        },
        {
          "cid": 5,
          "name": "color_hex",
          "type": "TEXT",
          "notnull": 0,
          "default": "'#6B7280'",
          "pk": 0
        },
        {
          "cid": 6,
          "name": "icon_name",
          "type": "TEXT",
          "notnull": 0,
          "default": "'folder'",
          "pk": 0
        },
        {
          "cid": 7,
          "name": "keywords",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 8,
          "name": "merchant_patterns",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 9,
          "name": "amount_ranges",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 10,
          "name": "tax_deductible",
          "type": "BOOLEAN",
          "notnull": 0,
          "default": "TRUE",
          "pk": 0
        },
        {
          "cid": 11,
          "name": "requires_receipt",
          "type": "BOOLEAN",
          "notnull": 0,
          "default": "TRUE",
          "pk": 0
        },
        {
          "cid": 12,
          "name": "sort_order",
          "type": "INTEGER",
          "notnull": 0,
          "default": "0",
          "pk": 0
        },
        {
          "cid": 13,
          "name": "is_active",
          "type": "BOOLEAN",
          "notnull": 0,
          "default": "TRUE",
          "pk": 0
        },
        {
          "cid": 14,
          "name": "created_by",
          "type": "INTEGER",
          "notnull": 1,
          "default": null,
          "pk": 0
        },
        {
          "cid": 15,
          "name": "created_at",
          "type": "TIMESTAMP",
          "notnull": 0,
          "default": "CURRENT_TIMESTAMP",
          "pk": 0
        },
        {
          "cid": 16,
          "name": "updated_at",
          "type": "TIMESTAMP",
          "notnull": 0,
          "default": "CURRENT_TIMESTAMP",
          "pk": 0
        }
      ],
      "row_count": 8,
      "foreign_keys": [
        {
          "id": 0,
          "seq": 0,
          "table": "users",
          "from": "created_by",
          "to": "id",
          "on_update": "NO ACTION",
          "on_delete": "NO ACTION"
        },
        {
          "id": 1,
          "seq": 0,
          "table": "tenants",
          "from": "tenant_id",
          "to": "id",
          "on_update": "NO ACTION",
          "on_delete": "NO ACTION"
        }
      ]
    },
    "duplicate_detection_config": {
      "create_sql": "CREATE TABLE duplicate_detection_config (\n    id INTEGER PRIMARY KEY AUTOINCREMENT,\n    tenant_id INTEGER NOT NULL,\n    similarity_threshold_high REAL DEFAULT 0.85,\n    similarity_threshold_medium REAL DEFAULT 0.70,\n    similarity_threshold_low REAL DEFAULT 0.55,\n    time_window_days INTEGER DEFAULT 30,\n    auto_block_high_risk BOOLEAN DEFAULT TRUE,\n    auto_review_medium_risk BOOLEAN DEFAULT TRUE,\n    enabled_methods TEXT DEFAULT 'hybrid', -- comma separated: ml,heuristic,hybrid\n    weights_description REAL DEFAULT 0.4,\n    weights_amount REAL DEFAULT 0.3,\n    weights_provider REAL DEFAULT 0.2,\n    weights_date REAL DEFAULT 0.1,\n    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    FOREIGN KEY (tenant_id) REFERENCES tenants(id)\n)",
      "columns": [
        {
          "cid": 0,
          "name": "id",
          "type": "INTEGER",
          "notnull": 0,
          "default": null,
          "pk": 1
        },
        {
          "cid": 1,
          "name": "tenant_id",
          "type": "INTEGER",
          "notnull": 1,
          "default": null,
          "pk": 0
        },
        {
          "cid": 2,
          "name": "similarity_threshold_high",
          "type": "REAL",
          "notnull": 0,
          "default": "0.85",
          "pk": 0
        },
        {
          "cid": 3,
          "name": "similarity_threshold_medium",
          "type": "REAL",
          "notnull": 0,
          "default": "0.70",
          "pk": 0
        },
        {
          "cid": 4,
          "name": "similarity_threshold_low",
          "type": "REAL",
          "notnull": 0,
          "default": "0.55",
          "pk": 0
        },
        {
          "cid": 5,
          "name": "time_window_days",
          "type": "INTEGER",
          "notnull": 0,
          "default": "30",
          "pk": 0
        },
        {
          "cid": 6,
          "name": "auto_block_high_risk",
          "type": "BOOLEAN",
          "notnull": 0,
          "default": "TRUE",
          "pk": 0
        },
        {
          "cid": 7,
          "name": "auto_review_medium_risk",
          "type": "BOOLEAN",
          "notnull": 0,
          "default": "TRUE",
          "pk": 0
        },
        {
          "cid": 8,
          "name": "enabled_methods",
          "type": "TEXT",
          "notnull": 0,
          "default": "'hybrid'",
          "pk": 0
        },
        {
          "cid": 9,
          "name": "weights_description",
          "type": "REAL",
          "notnull": 0,
          "default": "0.4",
          "pk": 0
        },
        {
          "cid": 10,
          "name": "weights_amount",
          "type": "REAL",
          "notnull": 0,
          "default": "0.3",
          "pk": 0
        },
        {
          "cid": 11,
          "name": "weights_provider",
          "type": "REAL",
          "notnull": 0,
          "default": "0.2",
          "pk": 0
        },
        {
          "cid": 12,
          "name": "weights_date",
          "type": "REAL",
          "notnull": 0,
          "default": "0.1",
          "pk": 0
        },
        {
          "cid": 13,
          "name": "created_at",
          "type": "TIMESTAMP",
          "notnull": 0,
          "default": "CURRENT_TIMESTAMP",
          "pk": 0
        },
        {
          "cid": 14,
          "name": "updated_at",
          "type": "TIMESTAMP",
          "notnull": 0,
          "default": "CURRENT_TIMESTAMP",
          "pk": 0
        }
      ],
      "row_count": 1,
      "foreign_keys": [
        {
          "id": 0,
          "seq": 0,
          "table": "tenants",
          "from": "tenant_id",
          "to": "id",
          "on_update": "NO ACTION",
          "on_delete": "NO ACTION"
        }
      ]
    },
    "duplicate_detections": {
      "create_sql": "CREATE TABLE duplicate_detections (\n    id INTEGER PRIMARY KEY AUTOINCREMENT,\n    expense_id INTEGER NOT NULL,\n    potential_duplicate_id INTEGER NOT NULL,\n    similarity_score REAL NOT NULL,\n    risk_level TEXT NOT NULL,\n    confidence_level TEXT NOT NULL,\n    match_reasons TEXT, -- JSON array of reasons\n    detection_method TEXT DEFAULT 'hybrid',\n    ml_features_json TEXT, -- JSON ML features\n    status TEXT DEFAULT 'pending', -- pending, confirmed, rejected\n    reviewed_by INTEGER DEFAULT NULL,\n    reviewed_at TIMESTAMP DEFAULT NULL,\n    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    tenant_id INTEGER NOT NULL,\n    FOREIGN KEY (expense_id) REFERENCES expense_records(id),\n    FOREIGN KEY (potential_duplicate_id) REFERENCES expense_records(id),\n    FOREIGN KEY (reviewed_by) REFERENCES users(id),\n    FOREIGN KEY (tenant_id) REFERENCES tenants(id)\n)",
      "columns": [
        {
          "cid": 0,
          "name": "id",
          "type": "INTEGER",
          "notnull": 0,
          "default": null,
          "pk": 1
        },
        {
          "cid": 1,
          "name": "expense_id",
          "type": "INTEGER",
          "notnull": 1,
          "default": null,
          "pk": 0
        },
        {
          "cid": 2,
          "name": "potential_duplicate_id",
          "type": "INTEGER",
          "notnull": 1,
          "default": null,
          "pk": 0
        },
        {
          "cid": 3,
          "name": "similarity_score",
          "type": "REAL",
          "notnull": 1,
          "default": null,
          "pk": 0
        },
        {
          "cid": 4,
          "name": "risk_level",
          "type": "TEXT",
          "notnull": 1,
          "default": null,
          "pk": 0
        },
        {
          "cid": 5,
          "name": "confidence_level",
          "type": "TEXT",
          "notnull": 1,
          "default": null,
          "pk": 0
        },
        {
          "cid": 6,
          "name": "match_reasons",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 7,
          "name": "detection_method",
          "type": "TEXT",
          "notnull": 0,
          "default": "'hybrid'",
          "pk": 0
        },
        {
          "cid": 8,
          "name": "ml_features_json",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 9,
          "name": "status",
          "type": "TEXT",
          "notnull": 0,
          "default": "'pending'",
          "pk": 0
        },
        {
          "cid": 10,
          "name": "reviewed_by",
          "type": "INTEGER",
          "notnull": 0,
          "default": "NULL",
          "pk": 0
        },
        {
          "cid": 11,
          "name": "reviewed_at",
          "type": "TIMESTAMP",
          "notnull": 0,
          "default": "NULL",
          "pk": 0
        },
        {
          "cid": 12,
          "name": "created_at",
          "type": "TIMESTAMP",
          "notnull": 0,
          "default": "CURRENT_TIMESTAMP",
          "pk": 0
        },
        {
          "cid": 13,
          "name": "tenant_id",
          "type": "INTEGER",
          "notnull": 1,
          "default": null,
          "pk": 0
        }
      ],
      "row_count": 0,
      "foreign_keys": [
        {
          "id": 0,
          "seq": 0,
          "table": "tenants",
          "from": "tenant_id",
          "to": "id",
          "on_update": "NO ACTION",
          "on_delete": "NO ACTION"
        },
        {
          "id": 1,
          "seq": 0,
          "table": "users",
          "from": "reviewed_by",
          "to": "id",
          "on_update": "NO ACTION",
          "on_delete": "NO ACTION"
        },
        {
          "id": 2,
          "seq": 0,
          "table": "expense_records",
          "from": "potential_duplicate_id",
          "to": "id",
          "on_update": "NO ACTION",
          "on_delete": "NO ACTION"
        },
        {
          "id": 3,
          "seq": 0,
          "table": "expense_records",
          "from": "expense_id",
          "to": "id",
          "on_update": "NO ACTION",
          "on_delete": "NO ACTION"
        }
      ]
    },
    "error_logs": {
      "create_sql": "CREATE TABLE error_logs (\n                    id INTEGER PRIMARY KEY AUTOINCREMENT,\n                    error_id TEXT UNIQUE NOT NULL,\n                    category TEXT NOT NULL,\n                    severity TEXT NOT NULL,\n                    message TEXT NOT NULL,\n                    user_message TEXT NOT NULL,\n                    user_id INTEGER,\n                    tenant_id INTEGER,\n                    endpoint TEXT,\n                    method TEXT,\n                    ip_address TEXT,\n                    user_agent TEXT,\n                    stack_trace TEXT,\n                    metadata TEXT,\n                    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n                    resolved_at TIMESTAMP,\n                    resolution_notes TEXT\n                )",
      "columns": [
        {
          "cid": 0,
          "name": "id",
          "type": "INTEGER",
          "notnull": 0,
          "default": null,
          "pk": 1
        },
        {
          "cid": 1,
          "name": "error_id",
          "type": "TEXT",
          "notnull": 1,
          "default": null,
          "pk": 0
        },
        {
          "cid": 2,
          "name": "category",
          "type": "TEXT",
          "notnull": 1,
          "default": null,
          "pk": 0
        },
        {
          "cid": 3,
          "name": "severity",
          "type": "TEXT",
          "notnull": 1,
          "default": null,
          "pk": 0
        },
        {
          "cid": 4,
          "name": "message",
          "type": "TEXT",
          "notnull": 1,
          "default": null,
          "pk": 0
        },
        {
          "cid": 5,
          "name": "user_message",
          "type": "TEXT",
          "notnull": 1,
          "default": null,
          "pk": 0
        },
        {
          "cid": 6,
          "name": "user_id",
          "type": "INTEGER",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 7,
          "name": "tenant_id",
          "type": "INTEGER",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 8,
          "name": "endpoint",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 9,
          "name": "method",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 10,
          "name": "ip_address",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 11,
          "name": "user_agent",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 12,
          "name": "stack_trace",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 13,
          "name": "metadata",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 14,
          "name": "created_at",
          "type": "TIMESTAMP",
          "notnull": 0,
          "default": "CURRENT_TIMESTAMP",
          "pk": 0
        },
        {
          "cid": 15,
          "name": "resolved_at",
          "type": "TIMESTAMP",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 16,
          "name": "resolution_notes",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        }
      ],
      "row_count": 7,
      "foreign_keys": []
    },
    "expense_attachments": {
      "create_sql": "CREATE TABLE expense_attachments (\n    id INTEGER PRIMARY KEY AUTOINCREMENT,\n    expense_id INTEGER NOT NULL,\n    filename TEXT NOT NULL,\n    file_path TEXT,\n    file_size INTEGER,\n    mime_type TEXT,\n    attachment_type TEXT DEFAULT 'receipt',\n    uploaded_by INTEGER,\n    uploaded_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    FOREIGN KEY (expense_id) REFERENCES expense_records(id) ON DELETE CASCADE,\n    FOREIGN KEY (uploaded_by) REFERENCES users(id)\n)",
      "columns": [
        {
          "cid": 0,
          "name": "id",
          "type": "INTEGER",
          "notnull": 0,
          "default": null,
          "pk": 1
        },
        {
          "cid": 1,
          "name": "expense_id",
          "type": "INTEGER",
          "notnull": 1,
          "default": null,
          "pk": 0
        },
        {
          "cid": 2,
          "name": "filename",
          "type": "TEXT",
          "notnull": 1,
          "default": null,
          "pk": 0
        },
        {
          "cid": 3,
          "name": "file_path",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 4,
          "name": "file_size",
          "type": "INTEGER",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 5,
          "name": "mime_type",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 6,
          "name": "attachment_type",
          "type": "TEXT",
          "notnull": 0,
          "default": "'receipt'",
          "pk": 0
        },
        {
          "cid": 7,
          "name": "uploaded_by",
          "type": "INTEGER",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 8,
          "name": "uploaded_at",
          "type": "TIMESTAMP",
          "notnull": 0,
          "default": "CURRENT_TIMESTAMP",
          "pk": 0
        }
      ],
      "row_count": 0,
      "foreign_keys": [
        {
          "id": 0,
          "seq": 0,
          "table": "users",
          "from": "uploaded_by",
          "to": "id",
          "on_update": "NO ACTION",
          "on_delete": "NO ACTION"
        },
        {
          "id": 1,
          "seq": 0,
          "table": "expense_records",
          "from": "expense_id",
          "to": "id",
          "on_update": "NO ACTION",
          "on_delete": "CASCADE"
        }
      ]
    },
    "expense_invoices": {
      "create_sql": "CREATE TABLE expense_invoices (\n    id INTEGER PRIMARY KEY AUTOINCREMENT,\n    expense_id INTEGER,\n    filename TEXT,\n    file_path TEXT,\n    content_type TEXT,\n    parsed_data TEXT,\n    tenant_id INTEGER,\n    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP, subtotal REAL, iva_amount REAL, discount REAL DEFAULT 0.0, retention REAL DEFAULT 0.0, xml_content TEXT, validation_status TEXT DEFAULT 'pending', processing_metadata TEXT, template_match REAL, validation_rules TEXT, detected_format TEXT, parser_used TEXT, ocr_confidence REAL, processing_metrics TEXT, quality_score REAL, processor_used TEXT, extraction_confidence REAL,\n    FOREIGN KEY (expense_id) REFERENCES expense_records(id),\n    FOREIGN KEY (tenant_id) REFERENCES tenants(id)\n)",
      "columns": [
        {
          "cid": 0,
          "name": "id",
          "type": "INTEGER",
          "notnull": 0,
          "default": null,
          "pk": 1
        },
        {
          "cid": 1,
          "name": "expense_id",
          "type": "INTEGER",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 2,
          "name": "filename",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 3,
          "name": "file_path",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 4,
          "name": "content_type",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 5,
          "name": "parsed_data",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 6,
          "name": "tenant_id",
          "type": "INTEGER",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 7,
          "name": "created_at",
          "type": "TIMESTAMP",
          "notnull": 0,
          "default": "CURRENT_TIMESTAMP",
          "pk": 0
        },
        {
          "cid": 8,
          "name": "subtotal",
          "type": "REAL",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 9,
          "name": "iva_amount",
          "type": "REAL",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 10,
          "name": "discount",
          "type": "REAL",
          "notnull": 0,
          "default": "0.0",
          "pk": 0
        },
        {
          "cid": 11,
          "name": "retention",
          "type": "REAL",
          "notnull": 0,
          "default": "0.0",
          "pk": 0
        },
        {
          "cid": 12,
          "name": "xml_content",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 13,
          "name": "validation_status",
          "type": "TEXT",
          "notnull": 0,
          "default": "'pending'",
          "pk": 0
        },
        {
          "cid": 14,
          "name": "processing_metadata",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 15,
          "name": "template_match",
          "type": "REAL",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 16,
          "name": "validation_rules",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 17,
          "name": "detected_format",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 18,
          "name": "parser_used",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 19,
          "name": "ocr_confidence",
          "type": "REAL",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 20,
          "name": "processing_metrics",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 21,
          "name": "quality_score",
          "type": "REAL",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 22,
          "name": "processor_used",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 23,
          "name": "extraction_confidence",
          "type": "REAL",
          "notnull": 0,
          "default": null,
          "pk": 0
        }
      ],
      "row_count": 0,
      "foreign_keys": [
        {
          "id": 0,
          "seq": 0,
          "table": "tenants",
          "from": "tenant_id",
          "to": "id",
          "on_update": "NO ACTION",
          "on_delete": "NO ACTION"
        },
        {
          "id": 1,
          "seq": 0,
          "table": "expense_records",
          "from": "expense_id",
          "to": "id",
          "on_update": "NO ACTION",
          "on_delete": "NO ACTION"
        }
      ]
    },
    "expense_ml_features": {
      "create_sql": "CREATE TABLE expense_ml_features (\n    id INTEGER PRIMARY KEY AUTOINCREMENT,\n    expense_id INTEGER NOT NULL,\n    feature_vector TEXT NOT NULL, -- JSON vector of ML features\n    embedding_vector TEXT DEFAULT NULL, -- JSON OpenAI embeddings\n    extraction_method TEXT DEFAULT 'rule_based',\n    feature_quality_score REAL DEFAULT NULL,\n    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    tenant_id INTEGER NOT NULL,\n    FOREIGN KEY (expense_id) REFERENCES expense_records(id),\n    FOREIGN KEY (tenant_id) REFERENCES tenants(id)\n)",
      "columns": [
        {
          "cid": 0,
          "name": "id",
          "type": "INTEGER",
          "notnull": 0,
          "default": null,
          "pk": 1
        },
        {
          "cid": 1,
          "name": "expense_id",
          "type": "INTEGER",
          "notnull": 1,
          "default": null,
          "pk": 0
        },
        {
          "cid": 2,
          "name": "feature_vector",
          "type": "TEXT",
          "notnull": 1,
          "default": null,
          "pk": 0
        },
        {
          "cid": 3,
          "name": "embedding_vector",
          "type": "TEXT",
          "notnull": 0,
          "default": "NULL",
          "pk": 0
        },
        {
          "cid": 4,
          "name": "extraction_method",
          "type": "TEXT",
          "notnull": 0,
          "default": "'rule_based'",
          "pk": 0
        },
        {
          "cid": 5,
          "name": "feature_quality_score",
          "type": "REAL",
          "notnull": 0,
          "default": "NULL",
          "pk": 0
        },
        {
          "cid": 6,
          "name": "created_at",
          "type": "TIMESTAMP",
          "notnull": 0,
          "default": "CURRENT_TIMESTAMP",
          "pk": 0
        },
        {
          "cid": 7,
          "name": "updated_at",
          "type": "TIMESTAMP",
          "notnull": 0,
          "default": "CURRENT_TIMESTAMP",
          "pk": 0
        },
        {
          "cid": 8,
          "name": "tenant_id",
          "type": "INTEGER",
          "notnull": 1,
          "default": null,
          "pk": 0
        }
      ],
      "row_count": 0,
      "foreign_keys": [
        {
          "id": 0,
          "seq": 0,
          "table": "tenants",
          "from": "tenant_id",
          "to": "id",
          "on_update": "NO ACTION",
          "on_delete": "NO ACTION"
        },
        {
          "id": 1,
          "seq": 0,
          "table": "expense_records",
          "from": "expense_id",
          "to": "id",
          "on_update": "NO ACTION",
          "on_delete": "NO ACTION"
        }
      ]
    },
    "expense_records": {
      "create_sql": "CREATE TABLE expense_records (\n    id INTEGER PRIMARY KEY AUTOINCREMENT,\n    amount REAL NOT NULL,\n    currency TEXT DEFAULT 'MXN',\n    description TEXT,\n    category TEXT,\n    merchant_name TEXT,\n    merchant_category TEXT,\n    date TIMESTAMP,\n    user_id INTEGER,\n    tenant_id INTEGER,\n    status TEXT DEFAULT 'pending',\n    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    -- Fiscal pipeline v1\n    tax_source TEXT,\n    explanation_short TEXT,\n    explanation_detail TEXT,\n    catalog_version TEXT DEFAULT 'v1',\n    classification_source TEXT, descripcion_normalizada TEXT, descripcion_normalizada_fuente TEXT, categoria_normalizada TEXT, categoria_slug TEXT, categoria_confianza REAL, categoria_fuente TEXT, sat_account_code TEXT, sat_product_service_code TEXT, deducible BOOLEAN, requiere_factura BOOLEAN, centro_costo TEXT, proyecto TEXT, metodo_pago TEXT, moneda TEXT, rfc_proveedor TEXT, cfdi_uuid TEXT, invoice_status TEXT, bank_status TEXT, approval_status TEXT, approved_by INTEGER, approved_at TIMESTAMP, updated_at TIMESTAMP, updated_by INTEGER, metadata TEXT, similarity_score REAL DEFAULT NULL, risk_level TEXT DEFAULT NULL, is_duplicate BOOLEAN DEFAULT FALSE, duplicate_of INTEGER DEFAULT NULL, duplicate_confidence REAL DEFAULT NULL, ml_features_json TEXT DEFAULT NULL, categoria_sugerida TEXT DEFAULT NULL, confianza REAL DEFAULT NULL, razonamiento TEXT DEFAULT NULL, category_alternatives TEXT DEFAULT NULL, prediction_method TEXT DEFAULT NULL, ml_model_version TEXT DEFAULT NULL, predicted_at TIMESTAMP DEFAULT NULL, category_confirmed BOOLEAN DEFAULT FALSE, category_corrected_by INTEGER DEFAULT NULL, tags TEXT, audit_trail TEXT, user_context TEXT, enhanced_data TEXT, completion_status TEXT DEFAULT 'draft', validation_errors TEXT, field_completeness REAL DEFAULT 0.0, tipo_cambio REAL DEFAULT 1.0, deducible_status TEXT DEFAULT 'pendiente', deducible_percent REAL DEFAULT 100.0, iva_acreditable BOOLEAN DEFAULT 1, periodo TEXT, reconciliation_type TEXT DEFAULT 'simple', split_group_id TEXT, amount_reconciled REAL DEFAULT 0, amount_pending REAL, is_employee_advance BOOLEAN DEFAULT FALSE, advance_id INTEGER, reimbursement_status TEXT DEFAULT 'not_required', subtotal REAL, iva_16 REAL DEFAULT 0, iva_8 REAL DEFAULT 0, iva_0 REAL DEFAULT 0, ieps REAL DEFAULT 0, isr_retenido REAL DEFAULT 0, iva_retenido REAL DEFAULT 0, otros_impuestos REAL DEFAULT 0, impuestos_incluidos TEXT, cfdi_status TEXT DEFAULT 'no_disponible', cfdi_pdf_url TEXT, cfdi_xml_url TEXT, cfdi_fecha_timbrado TEXT, cfdi_folio_fiscal TEXT, ticket_image_url TEXT, ticket_folio TEXT, registro_via TEXT, payment_account_id INTEGER, paid_by TEXT DEFAULT 'company_account', will_have_cfdi BOOLEAN DEFAULT 1, company_id TEXT, ticket_id INTEGER, processing_stage TEXT DEFAULT 'converted', classification_stage TEXT DEFAULT 'catalog_context', estado_iva TEXT DEFAULT 'pendiente', validation_status TEXT DEFAULT 'pending', workflow_status TEXT, estado_factura TEXT, estado_factura_original TEXT, estado_conciliacion TEXT, estado_conciliacion_original TEXT, factura_generada BOOLEAN DEFAULT 0, needs_reclassification INTEGER DEFAULT 0, descripcion TEXT, proveedor_nombre TEXT, categoria TEXT, monto_total REAL, escalated_to_invoicing BOOLEAN DEFAULT 0, escalated_ticket_id INTEGER, escalation_reason TEXT, escalated_at TIMESTAMP,\n    FOREIGN KEY (user_id) REFERENCES users(id),\n    FOREIGN KEY (tenant_id) REFERENCES tenants(id)\n)",
      "columns": [
        {
          "cid": 0,
          "name": "id",
          "type": "INTEGER",
          "notnull": 0,
          "default": null,
          "pk": 1
        },
        {
          "cid": 1,
          "name": "amount",
          "type": "REAL",
          "notnull": 1,
          "default": null,
          "pk": 0
        },
        {
          "cid": 2,
          "name": "currency",
          "type": "TEXT",
          "notnull": 0,
          "default": "'MXN'",
          "pk": 0
        },
        {
          "cid": 3,
          "name": "description",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 4,
          "name": "category",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 5,
          "name": "merchant_name",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 6,
          "name": "merchant_category",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 7,
          "name": "date",
          "type": "TIMESTAMP",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 8,
          "name": "user_id",
          "type": "INTEGER",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 9,
          "name": "tenant_id",
          "type": "INTEGER",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 10,
          "name": "status",
          "type": "TEXT",
          "notnull": 0,
          "default": "'pending'",
          "pk": 0
        },
        {
          "cid": 11,
          "name": "created_at",
          "type": "TIMESTAMP",
          "notnull": 0,
          "default": "CURRENT_TIMESTAMP",
          "pk": 0
        },
        {
          "cid": 12,
          "name": "tax_source",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 13,
          "name": "explanation_short",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 14,
          "name": "explanation_detail",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 15,
          "name": "catalog_version",
          "type": "TEXT",
          "notnull": 0,
          "default": "'v1'",
          "pk": 0
        },
        {
          "cid": 16,
          "name": "classification_source",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 17,
          "name": "descripcion_normalizada",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 18,
          "name": "descripcion_normalizada_fuente",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 19,
          "name": "categoria_normalizada",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 20,
          "name": "categoria_slug",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 21,
          "name": "categoria_confianza",
          "type": "REAL",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 22,
          "name": "categoria_fuente",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 23,
          "name": "sat_account_code",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 24,
          "name": "sat_product_service_code",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 25,
          "name": "deducible",
          "type": "BOOLEAN",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 26,
          "name": "requiere_factura",
          "type": "BOOLEAN",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 27,
          "name": "centro_costo",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 28,
          "name": "proyecto",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 29,
          "name": "metodo_pago",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 30,
          "name": "moneda",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 31,
          "name": "rfc_proveedor",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 32,
          "name": "cfdi_uuid",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 33,
          "name": "invoice_status",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 34,
          "name": "bank_status",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 35,
          "name": "approval_status",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 36,
          "name": "approved_by",
          "type": "INTEGER",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 37,
          "name": "approved_at",
          "type": "TIMESTAMP",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 38,
          "name": "updated_at",
          "type": "TIMESTAMP",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 39,
          "name": "updated_by",
          "type": "INTEGER",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 40,
          "name": "metadata",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 41,
          "name": "similarity_score",
          "type": "REAL",
          "notnull": 0,
          "default": "NULL",
          "pk": 0
        },
        {
          "cid": 42,
          "name": "risk_level",
          "type": "TEXT",
          "notnull": 0,
          "default": "NULL",
          "pk": 0
        },
        {
          "cid": 43,
          "name": "is_duplicate",
          "type": "BOOLEAN",
          "notnull": 0,
          "default": "FALSE",
          "pk": 0
        },
        {
          "cid": 44,
          "name": "duplicate_of",
          "type": "INTEGER",
          "notnull": 0,
          "default": "NULL",
          "pk": 0
        },
        {
          "cid": 45,
          "name": "duplicate_confidence",
          "type": "REAL",
          "notnull": 0,
          "default": "NULL",
          "pk": 0
        },
        {
          "cid": 46,
          "name": "ml_features_json",
          "type": "TEXT",
          "notnull": 0,
          "default": "NULL",
          "pk": 0
        },
        {
          "cid": 47,
          "name": "categoria_sugerida",
          "type": "TEXT",
          "notnull": 0,
          "default": "NULL",
          "pk": 0
        },
        {
          "cid": 48,
          "name": "confianza",
          "type": "REAL",
          "notnull": 0,
          "default": "NULL",
          "pk": 0
        },
        {
          "cid": 49,
          "name": "razonamiento",
          "type": "TEXT",
          "notnull": 0,
          "default": "NULL",
          "pk": 0
        },
        {
          "cid": 50,
          "name": "category_alternatives",
          "type": "TEXT",
          "notnull": 0,
          "default": "NULL",
          "pk": 0
        },
        {
          "cid": 51,
          "name": "prediction_method",
          "type": "TEXT",
          "notnull": 0,
          "default": "NULL",
          "pk": 0
        },
        {
          "cid": 52,
          "name": "ml_model_version",
          "type": "TEXT",
          "notnull": 0,
          "default": "NULL",
          "pk": 0
        },
        {
          "cid": 53,
          "name": "predicted_at",
          "type": "TIMESTAMP",
          "notnull": 0,
          "default": "NULL",
          "pk": 0
        },
        {
          "cid": 54,
          "name": "category_confirmed",
          "type": "BOOLEAN",
          "notnull": 0,
          "default": "FALSE",
          "pk": 0
        },
        {
          "cid": 55,
          "name": "category_corrected_by",
          "type": "INTEGER",
          "notnull": 0,
          "default": "NULL",
          "pk": 0
        },
        {
          "cid": 56,
          "name": "tags",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 57,
          "name": "audit_trail",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 58,
          "name": "user_context",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 59,
          "name": "enhanced_data",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 60,
          "name": "completion_status",
          "type": "TEXT",
          "notnull": 0,
          "default": "'draft'",
          "pk": 0
        },
        {
          "cid": 61,
          "name": "validation_errors",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 62,
          "name": "field_completeness",
          "type": "REAL",
          "notnull": 0,
          "default": "0.0",
          "pk": 0
        },
        {
          "cid": 63,
          "name": "tipo_cambio",
          "type": "REAL",
          "notnull": 0,
          "default": "1.0",
          "pk": 0
        },
        {
          "cid": 64,
          "name": "deducible_status",
          "type": "TEXT",
          "notnull": 0,
          "default": "'pendiente'",
          "pk": 0
        },
        {
          "cid": 65,
          "name": "deducible_percent",
          "type": "REAL",
          "notnull": 0,
          "default": "100.0",
          "pk": 0
        },
        {
          "cid": 66,
          "name": "iva_acreditable",
          "type": "BOOLEAN",
          "notnull": 0,
          "default": "1",
          "pk": 0
        },
        {
          "cid": 67,
          "name": "periodo",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 68,
          "name": "reconciliation_type",
          "type": "TEXT",
          "notnull": 0,
          "default": "'simple'",
          "pk": 0
        },
        {
          "cid": 69,
          "name": "split_group_id",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 70,
          "name": "amount_reconciled",
          "type": "REAL",
          "notnull": 0,
          "default": "0",
          "pk": 0
        },
        {
          "cid": 71,
          "name": "amount_pending",
          "type": "REAL",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 72,
          "name": "is_employee_advance",
          "type": "BOOLEAN",
          "notnull": 0,
          "default": "FALSE",
          "pk": 0
        },
        {
          "cid": 73,
          "name": "advance_id",
          "type": "INTEGER",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 74,
          "name": "reimbursement_status",
          "type": "TEXT",
          "notnull": 0,
          "default": "'not_required'",
          "pk": 0
        },
        {
          "cid": 75,
          "name": "subtotal",
          "type": "REAL",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 76,
          "name": "iva_16",
          "type": "REAL",
          "notnull": 0,
          "default": "0",
          "pk": 0
        },
        {
          "cid": 77,
          "name": "iva_8",
          "type": "REAL",
          "notnull": 0,
          "default": "0",
          "pk": 0
        },
        {
          "cid": 78,
          "name": "iva_0",
          "type": "REAL",
          "notnull": 0,
          "default": "0",
          "pk": 0
        },
        {
          "cid": 79,
          "name": "ieps",
          "type": "REAL",
          "notnull": 0,
          "default": "0",
          "pk": 0
        },
        {
          "cid": 80,
          "name": "isr_retenido",
          "type": "REAL",
          "notnull": 0,
          "default": "0",
          "pk": 0
        },
        {
          "cid": 81,
          "name": "iva_retenido",
          "type": "REAL",
          "notnull": 0,
          "default": "0",
          "pk": 0
        },
        {
          "cid": 82,
          "name": "otros_impuestos",
          "type": "REAL",
          "notnull": 0,
          "default": "0",
          "pk": 0
        },
        {
          "cid": 83,
          "name": "impuestos_incluidos",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 84,
          "name": "cfdi_status",
          "type": "TEXT",
          "notnull": 0,
          "default": "'no_disponible'",
          "pk": 0
        },
        {
          "cid": 85,
          "name": "cfdi_pdf_url",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 86,
          "name": "cfdi_xml_url",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 87,
          "name": "cfdi_fecha_timbrado",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 88,
          "name": "cfdi_folio_fiscal",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 89,
          "name": "ticket_image_url",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 90,
          "name": "ticket_folio",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 91,
          "name": "registro_via",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 92,
          "name": "payment_account_id",
          "type": "INTEGER",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 93,
          "name": "paid_by",
          "type": "TEXT",
          "notnull": 0,
          "default": "'company_account'",
          "pk": 0
        },
        {
          "cid": 94,
          "name": "will_have_cfdi",
          "type": "BOOLEAN",
          "notnull": 0,
          "default": "1",
          "pk": 0
        },
        {
          "cid": 95,
          "name": "company_id",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 96,
          "name": "ticket_id",
          "type": "INTEGER",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 97,
          "name": "processing_stage",
          "type": "TEXT",
          "notnull": 0,
          "default": "'converted'",
          "pk": 0
        },
        {
          "cid": 98,
          "name": "classification_stage",
          "type": "TEXT",
          "notnull": 0,
          "default": "'catalog_context'",
          "pk": 0
        },
        {
          "cid": 99,
          "name": "estado_iva",
          "type": "TEXT",
          "notnull": 0,
          "default": "'pendiente'",
          "pk": 0
        },
        {
          "cid": 100,
          "name": "validation_status",
          "type": "TEXT",
          "notnull": 0,
          "default": "'pending'",
          "pk": 0
        },
        {
          "cid": 101,
          "name": "workflow_status",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 102,
          "name": "estado_factura",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 103,
          "name": "estado_factura_original",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 104,
          "name": "estado_conciliacion",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 105,
          "name": "estado_conciliacion_original",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 106,
          "name": "factura_generada",
          "type": "BOOLEAN",
          "notnull": 0,
          "default": "0",
          "pk": 0
        },
        {
          "cid": 107,
          "name": "needs_reclassification",
          "type": "INTEGER",
          "notnull": 0,
          "default": "0",
          "pk": 0
        },
        {
          "cid": 108,
          "name": "descripcion",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 109,
          "name": "proveedor_nombre",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 110,
          "name": "categoria",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 111,
          "name": "monto_total",
          "type": "REAL",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 112,
          "name": "escalated_to_invoicing",
          "type": "BOOLEAN",
          "notnull": 0,
          "default": "0",
          "pk": 0
        },
        {
          "cid": 113,
          "name": "escalated_ticket_id",
          "type": "INTEGER",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 114,
          "name": "escalation_reason",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 115,
          "name": "escalated_at",
          "type": "TIMESTAMP",
          "notnull": 0,
          "default": null,
          "pk": 0
        }
      ],
      "row_count": 14,
      "foreign_keys": [
        {
          "id": 0,
          "seq": 0,
          "table": "tenants",
          "from": "tenant_id",
          "to": "id",
          "on_update": "NO ACTION",
          "on_delete": "NO ACTION"
        },
        {
          "id": 1,
          "seq": 0,
          "table": "users",
          "from": "user_id",
          "to": "id",
          "on_update": "NO ACTION",
          "on_delete": "NO ACTION"
        }
      ]
    },
    "expense_tag_relations": {
      "create_sql": "CREATE TABLE expense_tag_relations (\n    expense_id INTEGER NOT NULL,\n    tag_id INTEGER NOT NULL,\n    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    PRIMARY KEY (expense_id, tag_id),\n    FOREIGN KEY (expense_id) REFERENCES expense_records(id) ON DELETE CASCADE,\n    FOREIGN KEY (tag_id) REFERENCES expense_tags(id) ON DELETE CASCADE\n)",
      "columns": [
        {
          "cid": 0,
          "name": "expense_id",
          "type": "INTEGER",
          "notnull": 1,
          "default": null,
          "pk": 1
        },
        {
          "cid": 1,
          "name": "tag_id",
          "type": "INTEGER",
          "notnull": 1,
          "default": null,
          "pk": 2
        },
        {
          "cid": 2,
          "name": "created_at",
          "type": "TIMESTAMP",
          "notnull": 0,
          "default": "CURRENT_TIMESTAMP",
          "pk": 0
        }
      ],
      "row_count": 0,
      "foreign_keys": [
        {
          "id": 0,
          "seq": 0,
          "table": "expense_tags",
          "from": "tag_id",
          "to": "id",
          "on_update": "NO ACTION",
          "on_delete": "CASCADE"
        },
        {
          "id": 1,
          "seq": 0,
          "table": "expense_records",
          "from": "expense_id",
          "to": "id",
          "on_update": "NO ACTION",
          "on_delete": "CASCADE"
        }
      ]
    },
    "expense_tags": {
      "create_sql": "CREATE TABLE expense_tags (\n    id INTEGER PRIMARY KEY AUTOINCREMENT,\n    name TEXT UNIQUE NOT NULL,\n    color TEXT DEFAULT '#3498db',\n    description TEXT,\n    tenant_id INTEGER NOT NULL,\n    created_by INTEGER,\n    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    FOREIGN KEY (tenant_id) REFERENCES tenants(id),\n    FOREIGN KEY (created_by) REFERENCES users(id)\n)",
      "columns": [
        {
          "cid": 0,
          "name": "id",
          "type": "INTEGER",
          "notnull": 0,
          "default": null,
          "pk": 1
        },
        {
          "cid": 1,
          "name": "name",
          "type": "TEXT",
          "notnull": 1,
          "default": null,
          "pk": 0
        },
        {
          "cid": 2,
          "name": "color",
          "type": "TEXT",
          "notnull": 0,
          "default": "'#3498db'",
          "pk": 0
        },
        {
          "cid": 3,
          "name": "description",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 4,
          "name": "tenant_id",
          "type": "INTEGER",
          "notnull": 1,
          "default": null,
          "pk": 0
        },
        {
          "cid": 5,
          "name": "created_by",
          "type": "INTEGER",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 6,
          "name": "created_at",
          "type": "TIMESTAMP",
          "notnull": 0,
          "default": "CURRENT_TIMESTAMP",
          "pk": 0
        }
      ],
      "row_count": 8,
      "foreign_keys": [
        {
          "id": 0,
          "seq": 0,
          "table": "users",
          "from": "created_by",
          "to": "id",
          "on_update": "NO ACTION",
          "on_delete": "NO ACTION"
        },
        {
          "id": 1,
          "seq": 0,
          "table": "tenants",
          "from": "tenant_id",
          "to": "id",
          "on_update": "NO ACTION",
          "on_delete": "NO ACTION"
        }
      ]
    },
    "gpt_usage_events": {
      "create_sql": "CREATE TABLE gpt_usage_events (\n    id INTEGER PRIMARY KEY AUTOINCREMENT,\n    timestamp TEXT NOT NULL,\n    field_name TEXT NOT NULL,\n    reason TEXT NOT NULL,\n    tokens_estimated INTEGER NOT NULL,\n    cost_estimated_usd REAL NOT NULL,\n    confidence_before REAL NOT NULL,\n    confidence_after REAL NOT NULL,\n    success INTEGER NOT NULL,\n    merchant_type TEXT,\n    ticket_id TEXT,\n    error_message TEXT,\n    tenant_id INTEGER,\n    FOREIGN KEY (tenant_id) REFERENCES tenants(id)\n)",
      "columns": [
        {
          "cid": 0,
          "name": "id",
          "type": "INTEGER",
          "notnull": 0,
          "default": null,
          "pk": 1
        },
        {
          "cid": 1,
          "name": "timestamp",
          "type": "TEXT",
          "notnull": 1,
          "default": null,
          "pk": 0
        },
        {
          "cid": 2,
          "name": "field_name",
          "type": "TEXT",
          "notnull": 1,
          "default": null,
          "pk": 0
        },
        {
          "cid": 3,
          "name": "reason",
          "type": "TEXT",
          "notnull": 1,
          "default": null,
          "pk": 0
        },
        {
          "cid": 4,
          "name": "tokens_estimated",
          "type": "INTEGER",
          "notnull": 1,
          "default": null,
          "pk": 0
        },
        {
          "cid": 5,
          "name": "cost_estimated_usd",
          "type": "REAL",
          "notnull": 1,
          "default": null,
          "pk": 0
        },
        {
          "cid": 6,
          "name": "confidence_before",
          "type": "REAL",
          "notnull": 1,
          "default": null,
          "pk": 0
        },
        {
          "cid": 7,
          "name": "confidence_after",
          "type": "REAL",
          "notnull": 1,
          "default": null,
          "pk": 0
        },
        {
          "cid": 8,
          "name": "success",
          "type": "INTEGER",
          "notnull": 1,
          "default": null,
          "pk": 0
        },
        {
          "cid": 9,
          "name": "merchant_type",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 10,
          "name": "ticket_id",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 11,
          "name": "error_message",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 12,
          "name": "tenant_id",
          "type": "INTEGER",
          "notnull": 0,
          "default": null,
          "pk": 0
        }
      ],
      "row_count": 0,
      "foreign_keys": [
        {
          "id": 0,
          "seq": 0,
          "table": "tenants",
          "from": "tenant_id",
          "to": "id",
          "on_update": "NO ACTION",
          "on_delete": "NO ACTION"
        }
      ]
    },
    "ia_metrics_history": {
      "create_sql": "CREATE TABLE ia_metrics_history (\n                id INTEGER PRIMARY KEY AUTOINCREMENT,\n                captured_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n                total_expenses INTEGER,\n                ia_expenses INTEGER,\n                catalog_expenses INTEGER,\n                provider_rules INTEGER,\n                manual_feedback INTEGER,\n                traces INTEGER,\n                high_confidence_ratio REAL\n            )",
      "columns": [
        {
          "cid": 0,
          "name": "id",
          "type": "INTEGER",
          "notnull": 0,
          "default": null,
          "pk": 1
        },
        {
          "cid": 1,
          "name": "captured_at",
          "type": "TIMESTAMP",
          "notnull": 0,
          "default": "CURRENT_TIMESTAMP",
          "pk": 0
        },
        {
          "cid": 2,
          "name": "total_expenses",
          "type": "INTEGER",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 3,
          "name": "ia_expenses",
          "type": "INTEGER",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 4,
          "name": "catalog_expenses",
          "type": "INTEGER",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 5,
          "name": "provider_rules",
          "type": "INTEGER",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 6,
          "name": "manual_feedback",
          "type": "INTEGER",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 7,
          "name": "traces",
          "type": "INTEGER",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 8,
          "name": "high_confidence_ratio",
          "type": "REAL",
          "notnull": 0,
          "default": null,
          "pk": 0
        }
      ],
      "row_count": 2,
      "foreign_keys": []
    },
    "invoicing_jobs": {
      "create_sql": "CREATE TABLE invoicing_jobs (\n    id INTEGER PRIMARY KEY AUTOINCREMENT,\n    ticket_id INTEGER NOT NULL,\n    merchant_id INTEGER,\n    estado TEXT DEFAULT 'pendiente',\n    resultado TEXT,\n    error_message TEXT,\n    retry_count INTEGER DEFAULT 0,\n    scheduled_at TIMESTAMP,\n    completed_at TIMESTAMP,\n    company_id TEXT DEFAULT 'default',\n    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    FOREIGN KEY (ticket_id) REFERENCES tickets(id)\n)",
      "columns": [
        {
          "cid": 0,
          "name": "id",
          "type": "INTEGER",
          "notnull": 0,
          "default": null,
          "pk": 1
        },
        {
          "cid": 1,
          "name": "ticket_id",
          "type": "INTEGER",
          "notnull": 1,
          "default": null,
          "pk": 0
        },
        {
          "cid": 2,
          "name": "merchant_id",
          "type": "INTEGER",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 3,
          "name": "estado",
          "type": "TEXT",
          "notnull": 0,
          "default": "'pendiente'",
          "pk": 0
        },
        {
          "cid": 4,
          "name": "resultado",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 5,
          "name": "error_message",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 6,
          "name": "retry_count",
          "type": "INTEGER",
          "notnull": 0,
          "default": "0",
          "pk": 0
        },
        {
          "cid": 7,
          "name": "scheduled_at",
          "type": "TIMESTAMP",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 8,
          "name": "completed_at",
          "type": "TIMESTAMP",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 9,
          "name": "company_id",
          "type": "TEXT",
          "notnull": 0,
          "default": "'default'",
          "pk": 0
        },
        {
          "cid": 10,
          "name": "created_at",
          "type": "TIMESTAMP",
          "notnull": 0,
          "default": "CURRENT_TIMESTAMP",
          "pk": 0
        },
        {
          "cid": 11,
          "name": "updated_at",
          "type": "TIMESTAMP",
          "notnull": 0,
          "default": "CURRENT_TIMESTAMP",
          "pk": 0
        }
      ],
      "row_count": 0,
      "foreign_keys": [
        {
          "id": 0,
          "seq": 0,
          "table": "tickets",
          "from": "ticket_id",
          "to": "id",
          "on_update": "NO ACTION",
          "on_delete": "NO ACTION"
        }
      ]
    },
    "merchants": {
      "create_sql": "CREATE TABLE merchants (\n    id INTEGER PRIMARY KEY AUTOINCREMENT,\n    nombre TEXT NOT NULL,\n    metodo_facturacion TEXT NOT NULL,\n    metadata TEXT,\n    is_active BOOLEAN DEFAULT 1,\n    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP\n)",
      "columns": [
        {
          "cid": 0,
          "name": "id",
          "type": "INTEGER",
          "notnull": 0,
          "default": null,
          "pk": 1
        },
        {
          "cid": 1,
          "name": "nombre",
          "type": "TEXT",
          "notnull": 1,
          "default": null,
          "pk": 0
        },
        {
          "cid": 2,
          "name": "metodo_facturacion",
          "type": "TEXT",
          "notnull": 1,
          "default": null,
          "pk": 0
        },
        {
          "cid": 3,
          "name": "metadata",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 4,
          "name": "is_active",
          "type": "BOOLEAN",
          "notnull": 0,
          "default": "1",
          "pk": 0
        },
        {
          "cid": 5,
          "name": "created_at",
          "type": "TIMESTAMP",
          "notnull": 0,
          "default": "CURRENT_TIMESTAMP",
          "pk": 0
        },
        {
          "cid": 6,
          "name": "updated_at",
          "type": "TIMESTAMP",
          "notnull": 0,
          "default": "CURRENT_TIMESTAMP",
          "pk": 0
        }
      ],
      "row_count": 0,
      "foreign_keys": []
    },
    "model_config_history": {
      "create_sql": "CREATE TABLE model_config_history (\n                id INTEGER PRIMARY KEY AUTOINCREMENT,\n                model_version TEXT,\n                prompt_version TEXT,\n                recorded_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP\n            )",
      "columns": [
        {
          "cid": 0,
          "name": "id",
          "type": "INTEGER",
          "notnull": 0,
          "default": null,
          "pk": 1
        },
        {
          "cid": 1,
          "name": "model_version",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 2,
          "name": "prompt_version",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 3,
          "name": "recorded_at",
          "type": "TIMESTAMP",
          "notnull": 0,
          "default": "CURRENT_TIMESTAMP",
          "pk": 0
        }
      ],
      "row_count": 27,
      "foreign_keys": []
    },
    "onboarding_steps": {
      "create_sql": "CREATE TABLE onboarding_steps (\n    id INTEGER PRIMARY KEY AUTOINCREMENT,\n    step_number INTEGER NOT NULL,\n    step_name TEXT NOT NULL,\n    description TEXT,\n    required BOOLEAN DEFAULT TRUE,\n    active BOOLEAN DEFAULT TRUE,\n    tenant_id INTEGER DEFAULT 1,\n    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n\n    FOREIGN KEY (tenant_id) REFERENCES tenants(id)\n)",
      "columns": [
        {
          "cid": 0,
          "name": "id",
          "type": "INTEGER",
          "notnull": 0,
          "default": null,
          "pk": 1
        },
        {
          "cid": 1,
          "name": "step_number",
          "type": "INTEGER",
          "notnull": 1,
          "default": null,
          "pk": 0
        },
        {
          "cid": 2,
          "name": "step_name",
          "type": "TEXT",
          "notnull": 1,
          "default": null,
          "pk": 0
        },
        {
          "cid": 3,
          "name": "description",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 4,
          "name": "required",
          "type": "BOOLEAN",
          "notnull": 0,
          "default": "TRUE",
          "pk": 0
        },
        {
          "cid": 5,
          "name": "active",
          "type": "BOOLEAN",
          "notnull": 0,
          "default": "TRUE",
          "pk": 0
        },
        {
          "cid": 6,
          "name": "tenant_id",
          "type": "INTEGER",
          "notnull": 0,
          "default": "1",
          "pk": 0
        },
        {
          "cid": 7,
          "name": "created_at",
          "type": "TIMESTAMP",
          "notnull": 0,
          "default": "CURRENT_TIMESTAMP",
          "pk": 0
        }
      ],
      "row_count": 6,
      "foreign_keys": [
        {
          "id": 0,
          "seq": 0,
          "table": "tenants",
          "from": "tenant_id",
          "to": "id",
          "on_update": "NO ACTION",
          "on_delete": "NO ACTION"
        }
      ]
    },
    "payment_applications": {
      "create_sql": "CREATE TABLE payment_applications (\n    id INTEGER PRIMARY KEY AUTOINCREMENT,\n    uuid_pago TEXT NOT NULL REFERENCES cfdi_payments(uuid_pago) ON DELETE CASCADE,\n    cfdi_uuid TEXT NOT NULL REFERENCES expense_invoices(uuid),\n    no_parcialidad INTEGER NOT NULL,\n    monto_pagado REAL NOT NULL,\n    saldo_insoluto REAL NOT NULL,\n    moneda TEXT DEFAULT 'MXN',\n    tipo_cambio REAL DEFAULT 1.0,\n    fecha_pago TIMESTAMP NOT NULL,\n    tenant_id INTEGER,\n    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    UNIQUE (uuid_pago, cfdi_uuid, no_parcialidad)\n)",
      "columns": [
        {
          "cid": 0,
          "name": "id",
          "type": "INTEGER",
          "notnull": 0,
          "default": null,
          "pk": 1
        },
        {
          "cid": 1,
          "name": "uuid_pago",
          "type": "TEXT",
          "notnull": 1,
          "default": null,
          "pk": 0
        },
        {
          "cid": 2,
          "name": "cfdi_uuid",
          "type": "TEXT",
          "notnull": 1,
          "default": null,
          "pk": 0
        },
        {
          "cid": 3,
          "name": "no_parcialidad",
          "type": "INTEGER",
          "notnull": 1,
          "default": null,
          "pk": 0
        },
        {
          "cid": 4,
          "name": "monto_pagado",
          "type": "REAL",
          "notnull": 1,
          "default": null,
          "pk": 0
        },
        {
          "cid": 5,
          "name": "saldo_insoluto",
          "type": "REAL",
          "notnull": 1,
          "default": null,
          "pk": 0
        },
        {
          "cid": 6,
          "name": "moneda",
          "type": "TEXT",
          "notnull": 0,
          "default": "'MXN'",
          "pk": 0
        },
        {
          "cid": 7,
          "name": "tipo_cambio",
          "type": "REAL",
          "notnull": 0,
          "default": "1.0",
          "pk": 0
        },
        {
          "cid": 8,
          "name": "fecha_pago",
          "type": "TIMESTAMP",
          "notnull": 1,
          "default": null,
          "pk": 0
        },
        {
          "cid": 9,
          "name": "tenant_id",
          "type": "INTEGER",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 10,
          "name": "created_at",
          "type": "TIMESTAMP",
          "notnull": 0,
          "default": "CURRENT_TIMESTAMP",
          "pk": 0
        }
      ],
      "row_count": 0,
      "foreign_keys": [
        {
          "id": 0,
          "seq": 0,
          "table": "expense_invoices",
          "from": "cfdi_uuid",
          "to": "uuid",
          "on_update": "NO ACTION",
          "on_delete": "NO ACTION"
        },
        {
          "id": 1,
          "seq": 0,
          "table": "cfdi_payments",
          "from": "uuid_pago",
          "to": "uuid_pago",
          "on_update": "NO ACTION",
          "on_delete": "CASCADE"
        }
      ]
    },
    "provider_rules": {
      "create_sql": "CREATE TABLE provider_rules (\n                        id INTEGER PRIMARY KEY AUTOINCREMENT,\n                        tenant_id INTEGER REFERENCES tenants(id),\n                        provider_name_normalized TEXT,\n                        category_slug TEXT,\n                        sat_account_code TEXT,\n                        sat_product_service_code TEXT,\n                        default_iva_rate REAL DEFAULT 0,\n                        iva_tipo TEXT DEFAULT 'tasa_0',\n                        confidence REAL DEFAULT 0.9,\n                        last_confirmed_by INTEGER,\n                        last_confirmed_at TIMESTAMP,\n                        created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP\n                    )",
      "columns": [
        {
          "cid": 0,
          "name": "id",
          "type": "INTEGER",
          "notnull": 0,
          "default": null,
          "pk": 1
        },
        {
          "cid": 1,
          "name": "tenant_id",
          "type": "INTEGER",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 2,
          "name": "provider_name_normalized",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 3,
          "name": "category_slug",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 4,
          "name": "sat_account_code",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 5,
          "name": "sat_product_service_code",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 6,
          "name": "default_iva_rate",
          "type": "REAL",
          "notnull": 0,
          "default": "0",
          "pk": 0
        },
        {
          "cid": 7,
          "name": "iva_tipo",
          "type": "TEXT",
          "notnull": 0,
          "default": "'tasa_0'",
          "pk": 0
        },
        {
          "cid": 8,
          "name": "confidence",
          "type": "REAL",
          "notnull": 0,
          "default": "0.9",
          "pk": 0
        },
        {
          "cid": 9,
          "name": "last_confirmed_by",
          "type": "INTEGER",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 10,
          "name": "last_confirmed_at",
          "type": "TIMESTAMP",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 11,
          "name": "created_at",
          "type": "TIMESTAMP",
          "notnull": 0,
          "default": "CURRENT_TIMESTAMP",
          "pk": 0
        }
      ],
      "row_count": 0,
      "foreign_keys": [
        {
          "id": 0,
          "seq": 0,
          "table": "tenants",
          "from": "tenant_id",
          "to": "id",
          "on_update": "NO ACTION",
          "on_delete": "NO ACTION"
        }
      ]
    },
    "refresh_tokens": {
      "create_sql": "CREATE TABLE refresh_tokens (\n    id INTEGER PRIMARY KEY AUTOINCREMENT,\n    user_id INTEGER NOT NULL,\n    token_hash TEXT NOT NULL,\n    expires_at TIMESTAMP NOT NULL,\n    is_revoked BOOLEAN DEFAULT FALSE,\n    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    tenant_id INTEGER,\n    FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE\n)",
      "columns": [
        {
          "cid": 0,
          "name": "id",
          "type": "INTEGER",
          "notnull": 0,
          "default": null,
          "pk": 1
        },
        {
          "cid": 1,
          "name": "user_id",
          "type": "INTEGER",
          "notnull": 1,
          "default": null,
          "pk": 0
        },
        {
          "cid": 2,
          "name": "token_hash",
          "type": "TEXT",
          "notnull": 1,
          "default": null,
          "pk": 0
        },
        {
          "cid": 3,
          "name": "expires_at",
          "type": "TIMESTAMP",
          "notnull": 1,
          "default": null,
          "pk": 0
        },
        {
          "cid": 4,
          "name": "is_revoked",
          "type": "BOOLEAN",
          "notnull": 0,
          "default": "FALSE",
          "pk": 0
        },
        {
          "cid": 5,
          "name": "created_at",
          "type": "TIMESTAMP",
          "notnull": 0,
          "default": "CURRENT_TIMESTAMP",
          "pk": 0
        },
        {
          "cid": 6,
          "name": "tenant_id",
          "type": "INTEGER",
          "notnull": 0,
          "default": null,
          "pk": 0
        }
      ],
      "row_count": 20,
      "foreign_keys": [
        {
          "id": 0,
          "seq": 0,
          "table": "users",
          "from": "user_id",
          "to": "id",
          "on_update": "NO ACTION",
          "on_delete": "CASCADE"
        }
      ]
    },
    "sat_account_catalog": {
      "create_sql": "CREATE TABLE sat_account_catalog (\n    id INTEGER PRIMARY KEY AUTOINCREMENT,\n    code TEXT NOT NULL UNIQUE,\n    name TEXT NOT NULL,\n    description TEXT,\n    parent_code TEXT,\n    type TEXT DEFAULT 'agrupador',\n    is_active INTEGER NOT NULL DEFAULT 1,\n    updated_at TEXT NOT NULL DEFAULT (datetime('now'))\n)",
      "columns": [
        {
          "cid": 0,
          "name": "id",
          "type": "INTEGER",
          "notnull": 0,
          "default": null,
          "pk": 1
        },
        {
          "cid": 1,
          "name": "code",
          "type": "TEXT",
          "notnull": 1,
          "default": null,
          "pk": 0
        },
        {
          "cid": 2,
          "name": "name",
          "type": "TEXT",
          "notnull": 1,
          "default": null,
          "pk": 0
        },
        {
          "cid": 3,
          "name": "description",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 4,
          "name": "parent_code",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 5,
          "name": "type",
          "type": "TEXT",
          "notnull": 0,
          "default": "'agrupador'",
          "pk": 0
        },
        {
          "cid": 6,
          "name": "is_active",
          "type": "INTEGER",
          "notnull": 1,
          "default": "1",
          "pk": 0
        },
        {
          "cid": 7,
          "name": "updated_at",
          "type": "TEXT",
          "notnull": 1,
          "default": "datetime('now')",
          "pk": 0
        }
      ],
      "row_count": 1077,
      "foreign_keys": []
    },
    "sat_product_service_catalog": {
      "create_sql": "CREATE TABLE sat_product_service_catalog (\n    id INTEGER PRIMARY KEY AUTOINCREMENT,\n    code TEXT NOT NULL UNIQUE,\n    name TEXT NOT NULL,\n    description TEXT,\n    unit_key TEXT,\n    is_active INTEGER NOT NULL DEFAULT 1,\n    updated_at TEXT NOT NULL DEFAULT (datetime('now'))\n)",
      "columns": [
        {
          "cid": 0,
          "name": "id",
          "type": "INTEGER",
          "notnull": 0,
          "default": null,
          "pk": 1
        },
        {
          "cid": 1,
          "name": "code",
          "type": "TEXT",
          "notnull": 1,
          "default": null,
          "pk": 0
        },
        {
          "cid": 2,
          "name": "name",
          "type": "TEXT",
          "notnull": 1,
          "default": null,
          "pk": 0
        },
        {
          "cid": 3,
          "name": "description",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 4,
          "name": "unit_key",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 5,
          "name": "is_active",
          "type": "INTEGER",
          "notnull": 1,
          "default": "1",
          "pk": 0
        },
        {
          "cid": 6,
          "name": "updated_at",
          "type": "TEXT",
          "notnull": 1,
          "default": "datetime('now')",
          "pk": 0
        }
      ],
      "row_count": 12,
      "foreign_keys": []
    },
    "schema_migrations": {
      "create_sql": "CREATE TABLE schema_migrations (id INTEGER PRIMARY KEY AUTOINCREMENT, version TEXT UNIQUE, description TEXT, applied_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP)",
      "columns": [
        {
          "cid": 0,
          "name": "id",
          "type": "INTEGER",
          "notnull": 0,
          "default": null,
          "pk": 1
        },
        {
          "cid": 1,
          "name": "version",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 2,
          "name": "description",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 3,
          "name": "applied_at",
          "type": "TIMESTAMP",
          "notnull": 0,
          "default": "CURRENT_TIMESTAMP",
          "pk": 0
        }
      ],
      "row_count": 4,
      "foreign_keys": []
    },
    "schema_versions": {
      "create_sql": "CREATE TABLE schema_versions (\n    id INTEGER PRIMARY KEY AUTOINCREMENT,\n    version TEXT NOT NULL,\n    applied_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    description TEXT\n)",
      "columns": [
        {
          "cid": 0,
          "name": "id",
          "type": "INTEGER",
          "notnull": 0,
          "default": null,
          "pk": 1
        },
        {
          "cid": 1,
          "name": "version",
          "type": "TEXT",
          "notnull": 1,
          "default": null,
          "pk": 0
        },
        {
          "cid": 2,
          "name": "applied_at",
          "type": "TIMESTAMP",
          "notnull": 0,
          "default": "CURRENT_TIMESTAMP",
          "pk": 0
        },
        {
          "cid": 3,
          "name": "description",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        }
      ],
      "row_count": 4,
      "foreign_keys": []
    },
    "system_health": {
      "create_sql": "CREATE TABLE system_health (\n    id INTEGER PRIMARY KEY AUTOINCREMENT,\n    component_name TEXT NOT NULL,\n    health_status TEXT NOT NULL,\n    automation_health TEXT, -- JSON as TEXT\n    performance_metrics TEXT, -- JSON as TEXT\n    error_count INTEGER DEFAULT 0,\n    last_check TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    metadata TEXT -- JSON as TEXT\n)",
      "columns": [
        {
          "cid": 0,
          "name": "id",
          "type": "INTEGER",
          "notnull": 0,
          "default": null,
          "pk": 1
        },
        {
          "cid": 1,
          "name": "component_name",
          "type": "TEXT",
          "notnull": 1,
          "default": null,
          "pk": 0
        },
        {
          "cid": 2,
          "name": "health_status",
          "type": "TEXT",
          "notnull": 1,
          "default": null,
          "pk": 0
        },
        {
          "cid": 3,
          "name": "automation_health",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 4,
          "name": "performance_metrics",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 5,
          "name": "error_count",
          "type": "INTEGER",
          "notnull": 0,
          "default": "0",
          "pk": 0
        },
        {
          "cid": 6,
          "name": "last_check",
          "type": "TIMESTAMP",
          "notnull": 0,
          "default": "CURRENT_TIMESTAMP",
          "pk": 0
        },
        {
          "cid": 7,
          "name": "metadata",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        }
      ],
      "row_count": 0,
      "foreign_keys": []
    },
    "tenant_policies": {
      "create_sql": "CREATE TABLE tenant_policies (\n                tenant_id INTEGER PRIMARY KEY,\n                family_preferences TEXT,\n                overrides TEXT,\n                updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP\n            )",
      "columns": [
        {
          "cid": 0,
          "name": "tenant_id",
          "type": "INTEGER",
          "notnull": 0,
          "default": null,
          "pk": 1
        },
        {
          "cid": 1,
          "name": "family_preferences",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 2,
          "name": "overrides",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 3,
          "name": "updated_at",
          "type": "TIMESTAMP",
          "notnull": 0,
          "default": "CURRENT_TIMESTAMP",
          "pk": 0
        }
      ],
      "row_count": 1,
      "foreign_keys": []
    },
    "tenants": {
      "create_sql": "CREATE TABLE tenants (\n    id INTEGER PRIMARY KEY AUTOINCREMENT,\n    name TEXT NOT NULL,\n    api_key TEXT,\n    config TEXT,\n    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP\n, domain TEXT)",
      "columns": [
        {
          "cid": 0,
          "name": "id",
          "type": "INTEGER",
          "notnull": 0,
          "default": null,
          "pk": 1
        },
        {
          "cid": 1,
          "name": "name",
          "type": "TEXT",
          "notnull": 1,
          "default": null,
          "pk": 0
        },
        {
          "cid": 2,
          "name": "api_key",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 3,
          "name": "config",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 4,
          "name": "created_at",
          "type": "TIMESTAMP",
          "notnull": 0,
          "default": "CURRENT_TIMESTAMP",
          "pk": 0
        },
        {
          "cid": 5,
          "name": "updated_at",
          "type": "TIMESTAMP",
          "notnull": 0,
          "default": "CURRENT_TIMESTAMP",
          "pk": 0
        },
        {
          "cid": 6,
          "name": "domain",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        }
      ],
      "row_count": 2,
      "foreign_keys": []
    },
    "tickets": {
      "create_sql": "CREATE TABLE tickets (\n    id INTEGER PRIMARY KEY AUTOINCREMENT,\n    title TEXT NOT NULL,\n    description TEXT,\n    status TEXT DEFAULT 'open',\n    priority TEXT DEFAULT 'medium',\n    assignee TEXT,\n    tenant_id INTEGER,\n    user_id INTEGER,\n    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP, raw_data TEXT, tipo TEXT DEFAULT 'texto', estado TEXT DEFAULT 'pendiente', whatsapp_message_id TEXT, company_id TEXT DEFAULT 'default', original_image TEXT, merchant_id INTEGER, merchant_name TEXT, category TEXT, confidence REAL, invoice_data TEXT, llm_analysis TEXT, extracted_text TEXT, expense_id INTEGER, is_mirror_ticket BOOLEAN DEFAULT 0,\n    FOREIGN KEY (tenant_id) REFERENCES tenants(id),\n    FOREIGN KEY (user_id) REFERENCES users(id)\n)",
      "columns": [
        {
          "cid": 0,
          "name": "id",
          "type": "INTEGER",
          "notnull": 0,
          "default": null,
          "pk": 1
        },
        {
          "cid": 1,
          "name": "title",
          "type": "TEXT",
          "notnull": 1,
          "default": null,
          "pk": 0
        },
        {
          "cid": 2,
          "name": "description",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 3,
          "name": "status",
          "type": "TEXT",
          "notnull": 0,
          "default": "'open'",
          "pk": 0
        },
        {
          "cid": 4,
          "name": "priority",
          "type": "TEXT",
          "notnull": 0,
          "default": "'medium'",
          "pk": 0
        },
        {
          "cid": 5,
          "name": "assignee",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 6,
          "name": "tenant_id",
          "type": "INTEGER",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 7,
          "name": "user_id",
          "type": "INTEGER",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 8,
          "name": "created_at",
          "type": "TIMESTAMP",
          "notnull": 0,
          "default": "CURRENT_TIMESTAMP",
          "pk": 0
        },
        {
          "cid": 9,
          "name": "updated_at",
          "type": "TIMESTAMP",
          "notnull": 0,
          "default": "CURRENT_TIMESTAMP",
          "pk": 0
        },
        {
          "cid": 10,
          "name": "raw_data",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 11,
          "name": "tipo",
          "type": "TEXT",
          "notnull": 0,
          "default": "'texto'",
          "pk": 0
        },
        {
          "cid": 12,
          "name": "estado",
          "type": "TEXT",
          "notnull": 0,
          "default": "'pendiente'",
          "pk": 0
        },
        {
          "cid": 13,
          "name": "whatsapp_message_id",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 14,
          "name": "company_id",
          "type": "TEXT",
          "notnull": 0,
          "default": "'default'",
          "pk": 0
        },
        {
          "cid": 15,
          "name": "original_image",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 16,
          "name": "merchant_id",
          "type": "INTEGER",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 17,
          "name": "merchant_name",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 18,
          "name": "category",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 19,
          "name": "confidence",
          "type": "REAL",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 20,
          "name": "invoice_data",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 21,
          "name": "llm_analysis",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 22,
          "name": "extracted_text",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 23,
          "name": "expense_id",
          "type": "INTEGER",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 24,
          "name": "is_mirror_ticket",
          "type": "BOOLEAN",
          "notnull": 0,
          "default": "0",
          "pk": 0
        }
      ],
      "row_count": 0,
      "foreign_keys": [
        {
          "id": 0,
          "seq": 0,
          "table": "users",
          "from": "user_id",
          "to": "id",
          "on_update": "NO ACTION",
          "on_delete": "NO ACTION"
        },
        {
          "id": 1,
          "seq": 0,
          "table": "tenants",
          "from": "tenant_id",
          "to": "id",
          "on_update": "NO ACTION",
          "on_delete": "NO ACTION"
        }
      ]
    },
    "user_category_preferences": {
      "create_sql": "CREATE TABLE user_category_preferences (\n    id INTEGER PRIMARY KEY AUTOINCREMENT,\n    user_id INTEGER NOT NULL,\n    category_name TEXT NOT NULL,\n    frequency INTEGER DEFAULT 1, -- Cu\u00e1ntas veces ha usado esta categor\u00eda\n    last_used TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    preference_score REAL DEFAULT 1.0, -- Score de preferencia (0.0 - 1.0)\n    keywords TEXT, -- JSON array of keywords that trigger this category\n    active BOOLEAN DEFAULT TRUE,\n    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    tenant_id INTEGER NOT NULL,\n    FOREIGN KEY (user_id) REFERENCES users(id),\n    FOREIGN KEY (tenant_id) REFERENCES tenants(id)\n)",
      "columns": [
        {
          "cid": 0,
          "name": "id",
          "type": "INTEGER",
          "notnull": 0,
          "default": null,
          "pk": 1
        },
        {
          "cid": 1,
          "name": "user_id",
          "type": "INTEGER",
          "notnull": 1,
          "default": null,
          "pk": 0
        },
        {
          "cid": 2,
          "name": "category_name",
          "type": "TEXT",
          "notnull": 1,
          "default": null,
          "pk": 0
        },
        {
          "cid": 3,
          "name": "frequency",
          "type": "INTEGER",
          "notnull": 0,
          "default": "1",
          "pk": 0
        },
        {
          "cid": 4,
          "name": "last_used",
          "type": "TIMESTAMP",
          "notnull": 0,
          "default": "CURRENT_TIMESTAMP",
          "pk": 0
        },
        {
          "cid": 5,
          "name": "preference_score",
          "type": "REAL",
          "notnull": 0,
          "default": "1.0",
          "pk": 0
        },
        {
          "cid": 6,
          "name": "keywords",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 7,
          "name": "active",
          "type": "BOOLEAN",
          "notnull": 0,
          "default": "TRUE",
          "pk": 0
        },
        {
          "cid": 8,
          "name": "created_at",
          "type": "TIMESTAMP",
          "notnull": 0,
          "default": "CURRENT_TIMESTAMP",
          "pk": 0
        },
        {
          "cid": 9,
          "name": "updated_at",
          "type": "TIMESTAMP",
          "notnull": 0,
          "default": "CURRENT_TIMESTAMP",
          "pk": 0
        },
        {
          "cid": 10,
          "name": "tenant_id",
          "type": "INTEGER",
          "notnull": 1,
          "default": null,
          "pk": 0
        }
      ],
      "row_count": 0,
      "foreign_keys": [
        {
          "id": 0,
          "seq": 0,
          "table": "tenants",
          "from": "tenant_id",
          "to": "id",
          "on_update": "NO ACTION",
          "on_delete": "NO ACTION"
        },
        {
          "id": 1,
          "seq": 0,
          "table": "users",
          "from": "user_id",
          "to": "id",
          "on_update": "NO ACTION",
          "on_delete": "NO ACTION"
        }
      ]
    },
    "user_demo_config": {
      "create_sql": "CREATE TABLE user_demo_config (\n    id INTEGER PRIMARY KEY AUTOINCREMENT,\n    user_id INTEGER NOT NULL,\n    demo_type TEXT NOT NULL, -- 'expense_data', 'bank_data', 'invoice_data'\n    config_data TEXT, -- JSON con preferencias espec\u00edficas\n    generated_records INTEGER DEFAULT 0,\n    last_generated TIMESTAMP,\n    tenant_id INTEGER DEFAULT 1,\n    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n\n    FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE,\n    FOREIGN KEY (tenant_id) REFERENCES tenants(id)\n)",
      "columns": [
        {
          "cid": 0,
          "name": "id",
          "type": "INTEGER",
          "notnull": 0,
          "default": null,
          "pk": 1
        },
        {
          "cid": 1,
          "name": "user_id",
          "type": "INTEGER",
          "notnull": 1,
          "default": null,
          "pk": 0
        },
        {
          "cid": 2,
          "name": "demo_type",
          "type": "TEXT",
          "notnull": 1,
          "default": null,
          "pk": 0
        },
        {
          "cid": 3,
          "name": "config_data",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 4,
          "name": "generated_records",
          "type": "INTEGER",
          "notnull": 0,
          "default": "0",
          "pk": 0
        },
        {
          "cid": 5,
          "name": "last_generated",
          "type": "TIMESTAMP",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 6,
          "name": "tenant_id",
          "type": "INTEGER",
          "notnull": 0,
          "default": "1",
          "pk": 0
        },
        {
          "cid": 7,
          "name": "created_at",
          "type": "TIMESTAMP",
          "notnull": 0,
          "default": "CURRENT_TIMESTAMP",
          "pk": 0
        }
      ],
      "row_count": 0,
      "foreign_keys": [
        {
          "id": 0,
          "seq": 0,
          "table": "tenants",
          "from": "tenant_id",
          "to": "id",
          "on_update": "NO ACTION",
          "on_delete": "NO ACTION"
        },
        {
          "id": 1,
          "seq": 0,
          "table": "users",
          "from": "user_id",
          "to": "id",
          "on_update": "NO ACTION",
          "on_delete": "CASCADE"
        }
      ]
    },
    "user_onboarding_progress": {
      "create_sql": "CREATE TABLE user_onboarding_progress (\n    id INTEGER PRIMARY KEY AUTOINCREMENT,\n    user_id INTEGER NOT NULL,\n    step_id INTEGER NOT NULL,\n    status TEXT DEFAULT 'pending', -- 'pending', 'in_progress', 'completed', 'skipped'\n    completed_at TIMESTAMP,\n    metadata TEXT, -- JSON con datos espec\u00edficos del paso\n    tenant_id INTEGER DEFAULT 1,\n\n    FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE,\n    FOREIGN KEY (step_id) REFERENCES onboarding_steps(id),\n    FOREIGN KEY (tenant_id) REFERENCES tenants(id),\n\n    UNIQUE(user_id, step_id)\n)",
      "columns": [
        {
          "cid": 0,
          "name": "id",
          "type": "INTEGER",
          "notnull": 0,
          "default": null,
          "pk": 1
        },
        {
          "cid": 1,
          "name": "user_id",
          "type": "INTEGER",
          "notnull": 1,
          "default": null,
          "pk": 0
        },
        {
          "cid": 2,
          "name": "step_id",
          "type": "INTEGER",
          "notnull": 1,
          "default": null,
          "pk": 0
        },
        {
          "cid": 3,
          "name": "status",
          "type": "TEXT",
          "notnull": 0,
          "default": "'pending'",
          "pk": 0
        },
        {
          "cid": 4,
          "name": "completed_at",
          "type": "TIMESTAMP",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 5,
          "name": "metadata",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 6,
          "name": "tenant_id",
          "type": "INTEGER",
          "notnull": 0,
          "default": "1",
          "pk": 0
        }
      ],
      "row_count": 0,
      "foreign_keys": [
        {
          "id": 0,
          "seq": 0,
          "table": "tenants",
          "from": "tenant_id",
          "to": "id",
          "on_update": "NO ACTION",
          "on_delete": "NO ACTION"
        },
        {
          "id": 1,
          "seq": 0,
          "table": "onboarding_steps",
          "from": "step_id",
          "to": "id",
          "on_update": "NO ACTION",
          "on_delete": "NO ACTION"
        },
        {
          "id": 2,
          "seq": 0,
          "table": "users",
          "from": "user_id",
          "to": "id",
          "on_update": "NO ACTION",
          "on_delete": "CASCADE"
        }
      ]
    },
    "user_payment_accounts": {
      "create_sql": "CREATE TABLE user_payment_accounts (\n    id INTEGER PRIMARY KEY AUTOINCREMENT,\n    nombre TEXT NOT NULL,\n    tipo TEXT NOT NULL,\n    subtipo TEXT,\n    moneda TEXT NOT NULL DEFAULT 'MXN',\n    saldo_inicial REAL NOT NULL DEFAULT 0.0,\n    saldo_actual REAL NOT NULL DEFAULT 0.0,\n    limite_credito REAL,\n    fecha_corte INTEGER,\n    fecha_pago INTEGER,\n    credito_disponible REAL,\n    propietario_id INTEGER NOT NULL,\n    tenant_id INTEGER NOT NULL,\n    proveedor_terminal TEXT,\n    banco_nombre TEXT,\n    numero_tarjeta TEXT,\n    numero_cuenta_enmascarado TEXT,\n    numero_identificacion TEXT,\n    numero_cuenta TEXT,\n    clabe TEXT,\n    activo BOOLEAN NOT NULL DEFAULT TRUE,\n    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP, is_default BOOLEAN NOT NULL DEFAULT 0,\n    FOREIGN KEY (propietario_id) REFERENCES users(id),\n    FOREIGN KEY (tenant_id) REFERENCES tenants(id)\n)",
      "columns": [
        {
          "cid": 0,
          "name": "id",
          "type": "INTEGER",
          "notnull": 0,
          "default": null,
          "pk": 1
        },
        {
          "cid": 1,
          "name": "nombre",
          "type": "TEXT",
          "notnull": 1,
          "default": null,
          "pk": 0
        },
        {
          "cid": 2,
          "name": "tipo",
          "type": "TEXT",
          "notnull": 1,
          "default": null,
          "pk": 0
        },
        {
          "cid": 3,
          "name": "subtipo",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 4,
          "name": "moneda",
          "type": "TEXT",
          "notnull": 1,
          "default": "'MXN'",
          "pk": 0
        },
        {
          "cid": 5,
          "name": "saldo_inicial",
          "type": "REAL",
          "notnull": 1,
          "default": "0.0",
          "pk": 0
        },
        {
          "cid": 6,
          "name": "saldo_actual",
          "type": "REAL",
          "notnull": 1,
          "default": "0.0",
          "pk": 0
        },
        {
          "cid": 7,
          "name": "limite_credito",
          "type": "REAL",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 8,
          "name": "fecha_corte",
          "type": "INTEGER",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 9,
          "name": "fecha_pago",
          "type": "INTEGER",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 10,
          "name": "credito_disponible",
          "type": "REAL",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 11,
          "name": "propietario_id",
          "type": "INTEGER",
          "notnull": 1,
          "default": null,
          "pk": 0
        },
        {
          "cid": 12,
          "name": "tenant_id",
          "type": "INTEGER",
          "notnull": 1,
          "default": null,
          "pk": 0
        },
        {
          "cid": 13,
          "name": "proveedor_terminal",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 14,
          "name": "banco_nombre",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 15,
          "name": "numero_tarjeta",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 16,
          "name": "numero_cuenta_enmascarado",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 17,
          "name": "numero_identificacion",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 18,
          "name": "numero_cuenta",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 19,
          "name": "clabe",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 20,
          "name": "activo",
          "type": "BOOLEAN",
          "notnull": 1,
          "default": "TRUE",
          "pk": 0
        },
        {
          "cid": 21,
          "name": "created_at",
          "type": "TIMESTAMP",
          "notnull": 0,
          "default": "CURRENT_TIMESTAMP",
          "pk": 0
        },
        {
          "cid": 22,
          "name": "updated_at",
          "type": "TIMESTAMP",
          "notnull": 0,
          "default": "CURRENT_TIMESTAMP",
          "pk": 0
        },
        {
          "cid": 23,
          "name": "is_default",
          "type": "BOOLEAN",
          "notnull": 1,
          "default": "0",
          "pk": 0
        }
      ],
      "row_count": 5,
      "foreign_keys": [
        {
          "id": 0,
          "seq": 0,
          "table": "tenants",
          "from": "tenant_id",
          "to": "id",
          "on_update": "NO ACTION",
          "on_delete": "NO ACTION"
        },
        {
          "id": 1,
          "seq": 0,
          "table": "users",
          "from": "propietario_id",
          "to": "id",
          "on_update": "NO ACTION",
          "on_delete": "NO ACTION"
        }
      ]
    },
    "user_preferences": {
      "create_sql": "CREATE TABLE user_preferences (\n    id INTEGER PRIMARY KEY AUTOINCREMENT,\n    user_id INTEGER NOT NULL,\n    tenant_id INTEGER NOT NULL,\n    preferences TEXT, -- JSON as TEXT\n    onboarding_step TEXT DEFAULT 'start',\n    demo_preferences TEXT, -- JSON as TEXT\n    completion_rules TEXT, -- JSON as TEXT\n    field_priorities TEXT, -- JSON as TEXT\n    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    FOREIGN KEY (user_id) REFERENCES users(id),\n    FOREIGN KEY (tenant_id) REFERENCES tenants(id)\n)",
      "columns": [
        {
          "cid": 0,
          "name": "id",
          "type": "INTEGER",
          "notnull": 0,
          "default": null,
          "pk": 1
        },
        {
          "cid": 1,
          "name": "user_id",
          "type": "INTEGER",
          "notnull": 1,
          "default": null,
          "pk": 0
        },
        {
          "cid": 2,
          "name": "tenant_id",
          "type": "INTEGER",
          "notnull": 1,
          "default": null,
          "pk": 0
        },
        {
          "cid": 3,
          "name": "preferences",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 4,
          "name": "onboarding_step",
          "type": "TEXT",
          "notnull": 0,
          "default": "'start'",
          "pk": 0
        },
        {
          "cid": 5,
          "name": "demo_preferences",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 6,
          "name": "completion_rules",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 7,
          "name": "field_priorities",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 8,
          "name": "created_at",
          "type": "TIMESTAMP",
          "notnull": 0,
          "default": "CURRENT_TIMESTAMP",
          "pk": 0
        },
        {
          "cid": 9,
          "name": "updated_at",
          "type": "TIMESTAMP",
          "notnull": 0,
          "default": "CURRENT_TIMESTAMP",
          "pk": 0
        }
      ],
      "row_count": 0,
      "foreign_keys": [
        {
          "id": 0,
          "seq": 0,
          "table": "tenants",
          "from": "tenant_id",
          "to": "id",
          "on_update": "NO ACTION",
          "on_delete": "NO ACTION"
        },
        {
          "id": 1,
          "seq": 0,
          "table": "users",
          "from": "user_id",
          "to": "id",
          "on_update": "NO ACTION",
          "on_delete": "NO ACTION"
        }
      ]
    },
    "users": {
      "create_sql": "CREATE TABLE users (\n    id INTEGER PRIMARY KEY AUTOINCREMENT,\n    name TEXT NOT NULL,\n    email TEXT UNIQUE NOT NULL,\n    tenant_id INTEGER DEFAULT 1,\n    role TEXT DEFAULT 'user',\n    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n\n    -- Campos de autenticaci\u00f3n (de fix_auth_schema.sql)\n    password_hash TEXT,\n    is_active BOOLEAN DEFAULT TRUE,\n    is_superuser BOOLEAN DEFAULT FALSE,\n    last_login TIMESTAMP,\n\n    -- Campos de onboarding (FALTANTE en auditoria)\n    identifier TEXT, -- email o phone\n    full_name TEXT,\n    company_name TEXT,\n    onboarding_step INTEGER DEFAULT 0, -- \u26a0\ufe0f FALTABA EN BD\n    demo_preferences TEXT, -- JSON - \u274c FALTABA EN API\n    onboarding_completed BOOLEAN DEFAULT FALSE,\n    onboarding_completed_at TIMESTAMP,\n\n    -- Metadata adicional\n    phone TEXT,\n    registration_method TEXT DEFAULT 'email', -- 'email', 'whatsapp'\n    verification_token TEXT,\n    email_verified BOOLEAN DEFAULT FALSE,\n    phone_verified BOOLEAN DEFAULT FALSE, username TEXT, employee_id INTEGER, department TEXT, created_by INTEGER, is_email_verified BOOLEAN DEFAULT FALSE, failed_login_attempts INTEGER DEFAULT 0, locked_until TIMESTAMP, company_id INTEGER, metadata TEXT,\n\n    FOREIGN KEY (tenant_id) REFERENCES tenants(id)\n)",
      "columns": [
        {
          "cid": 0,
          "name": "id",
          "type": "INTEGER",
          "notnull": 0,
          "default": null,
          "pk": 1
        },
        {
          "cid": 1,
          "name": "name",
          "type": "TEXT",
          "notnull": 1,
          "default": null,
          "pk": 0
        },
        {
          "cid": 2,
          "name": "email",
          "type": "TEXT",
          "notnull": 1,
          "default": null,
          "pk": 0
        },
        {
          "cid": 3,
          "name": "tenant_id",
          "type": "INTEGER",
          "notnull": 0,
          "default": "1",
          "pk": 0
        },
        {
          "cid": 4,
          "name": "role",
          "type": "TEXT",
          "notnull": 0,
          "default": "'user'",
          "pk": 0
        },
        {
          "cid": 5,
          "name": "created_at",
          "type": "TIMESTAMP",
          "notnull": 0,
          "default": "CURRENT_TIMESTAMP",
          "pk": 0
        },
        {
          "cid": 6,
          "name": "password_hash",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 7,
          "name": "is_active",
          "type": "BOOLEAN",
          "notnull": 0,
          "default": "TRUE",
          "pk": 0
        },
        {
          "cid": 8,
          "name": "is_superuser",
          "type": "BOOLEAN",
          "notnull": 0,
          "default": "FALSE",
          "pk": 0
        },
        {
          "cid": 9,
          "name": "last_login",
          "type": "TIMESTAMP",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 10,
          "name": "identifier",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 11,
          "name": "full_name",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 12,
          "name": "company_name",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 13,
          "name": "onboarding_step",
          "type": "INTEGER",
          "notnull": 0,
          "default": "0",
          "pk": 0
        },
        {
          "cid": 14,
          "name": "demo_preferences",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 15,
          "name": "onboarding_completed",
          "type": "BOOLEAN",
          "notnull": 0,
          "default": "FALSE",
          "pk": 0
        },
        {
          "cid": 16,
          "name": "onboarding_completed_at",
          "type": "TIMESTAMP",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 17,
          "name": "phone",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 18,
          "name": "registration_method",
          "type": "TEXT",
          "notnull": 0,
          "default": "'email'",
          "pk": 0
        },
        {
          "cid": 19,
          "name": "verification_token",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 20,
          "name": "email_verified",
          "type": "BOOLEAN",
          "notnull": 0,
          "default": "FALSE",
          "pk": 0
        },
        {
          "cid": 21,
          "name": "phone_verified",
          "type": "BOOLEAN",
          "notnull": 0,
          "default": "FALSE",
          "pk": 0
        },
        {
          "cid": 22,
          "name": "username",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 23,
          "name": "employee_id",
          "type": "INTEGER",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 24,
          "name": "department",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 25,
          "name": "created_by",
          "type": "INTEGER",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 26,
          "name": "is_email_verified",
          "type": "BOOLEAN",
          "notnull": 0,
          "default": "FALSE",
          "pk": 0
        },
        {
          "cid": 27,
          "name": "failed_login_attempts",
          "type": "INTEGER",
          "notnull": 0,
          "default": "0",
          "pk": 0
        },
        {
          "cid": 28,
          "name": "locked_until",
          "type": "TIMESTAMP",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 29,
          "name": "company_id",
          "type": "INTEGER",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 30,
          "name": "metadata",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        }
      ],
      "row_count": 2,
      "foreign_keys": [
        {
          "id": 0,
          "seq": 0,
          "table": "tenants",
          "from": "tenant_id",
          "to": "id",
          "on_update": "NO ACTION",
          "on_delete": "NO ACTION"
        }
      ]
    },
    "workers": {
      "create_sql": "CREATE TABLE workers (\n    id INTEGER PRIMARY KEY AUTOINCREMENT,\n    task_id TEXT UNIQUE NOT NULL,\n    tenant_id INTEGER NOT NULL,\n    task_type TEXT NOT NULL,\n    status TEXT DEFAULT 'pending',\n    progress REAL DEFAULT 0.0, -- \u2705 CAMPO FALTANTE CR\u00cdTICO\n    worker_metadata TEXT, -- \u2705 CAMPO FALTANTE CR\u00cdTICO (JSON as TEXT)\n    retry_policy TEXT, -- \u2705 CAMPO FALTANTE CR\u00cdTICO (JSON as TEXT)\n    retry_count INTEGER DEFAULT 0,\n    result_data TEXT, -- JSON as TEXT\n    performance_tracking TEXT, -- JSON as TEXT\n    task_scheduling TEXT, -- JSON as TEXT\n    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    FOREIGN KEY (tenant_id) REFERENCES tenants(id)\n)",
      "columns": [
        {
          "cid": 0,
          "name": "id",
          "type": "INTEGER",
          "notnull": 0,
          "default": null,
          "pk": 1
        },
        {
          "cid": 1,
          "name": "task_id",
          "type": "TEXT",
          "notnull": 1,
          "default": null,
          "pk": 0
        },
        {
          "cid": 2,
          "name": "tenant_id",
          "type": "INTEGER",
          "notnull": 1,
          "default": null,
          "pk": 0
        },
        {
          "cid": 3,
          "name": "task_type",
          "type": "TEXT",
          "notnull": 1,
          "default": null,
          "pk": 0
        },
        {
          "cid": 4,
          "name": "status",
          "type": "TEXT",
          "notnull": 0,
          "default": "'pending'",
          "pk": 0
        },
        {
          "cid": 5,
          "name": "progress",
          "type": "REAL",
          "notnull": 0,
          "default": "0.0",
          "pk": 0
        },
        {
          "cid": 6,
          "name": "worker_metadata",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 7,
          "name": "retry_policy",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 8,
          "name": "retry_count",
          "type": "INTEGER",
          "notnull": 0,
          "default": "0",
          "pk": 0
        },
        {
          "cid": 9,
          "name": "result_data",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 10,
          "name": "performance_tracking",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 11,
          "name": "task_scheduling",
          "type": "TEXT",
          "notnull": 0,
          "default": null,
          "pk": 0
        },
        {
          "cid": 12,
          "name": "created_at",
          "type": "TIMESTAMP",
          "notnull": 0,
          "default": "CURRENT_TIMESTAMP",
          "pk": 0
        },
        {
          "cid": 13,
          "name": "updated_at",
          "type": "TIMESTAMP",
          "notnull": 0,
          "default": "CURRENT_TIMESTAMP",
          "pk": 0
        }
      ],
      "row_count": 0,
      "foreign_keys": [
        {
          "id": 0,
          "seq": 0,
          "table": "tenants",
          "from": "tenant_id",
          "to": "id",
          "on_update": "NO ACTION",
          "on_delete": "NO ACTION"
        }
      ]
    }
  },
  "indexes": {
    "idx_ai_context_memory_company_version": "CREATE INDEX idx_ai_context_memory_company_version\n    ON ai_context_memory(company_id, context_version)",
    "idx_ai_context_memory_created_by": "CREATE INDEX idx_ai_context_memory_created_by\n    ON ai_context_memory(created_by)",
    "idx_ai_correction_company": "CREATE INDEX idx_ai_correction_company\n            ON ai_correction_memory(company_id, created_at DESC)\n            ",
    "idx_attachments_expense": "CREATE INDEX idx_attachments_expense ON expense_attachments(expense_id)",
    "idx_attachments_type": "CREATE INDEX idx_attachments_type ON expense_attachments(attachment_type)",
    "idx_attachments_uploaded": "CREATE INDEX idx_attachments_uploaded ON expense_attachments(uploaded_at DESC)",
    "idx_audit_trail_entidad": "CREATE INDEX idx_audit_trail_entidad\n    ON audit_trail(entidad)",
    "idx_audit_trail_usuario": "CREATE INDEX idx_audit_trail_usuario\n    ON audit_trail(usuario_id)",
    "idx_automation_jobs_company": "CREATE INDEX idx_automation_jobs_company ON automation_jobs(company_id)",
    "idx_automation_jobs_created": "CREATE INDEX idx_automation_jobs_created ON automation_jobs(created_at)",
    "idx_automation_jobs_estado": "CREATE INDEX idx_automation_jobs_estado ON automation_jobs(estado)",
    "idx_automation_jobs_session": "CREATE INDEX idx_automation_jobs_session ON automation_jobs(session_id)",
    "idx_automation_logs_category": "CREATE INDEX idx_automation_logs_category ON automation_logs(category)",
    "idx_automation_logs_job": "CREATE INDEX idx_automation_logs_job ON automation_logs(job_id)",
    "idx_automation_logs_level": "CREATE INDEX idx_automation_logs_level ON automation_logs(level)",
    "idx_automation_screenshots_job": "CREATE INDEX idx_automation_screenshots_job ON automation_screenshots(job_id)",
    "idx_automation_screenshots_type": "CREATE INDEX idx_automation_screenshots_type ON automation_screenshots(screenshot_type)",
    "idx_automation_sessions_status": "CREATE INDEX idx_automation_sessions_status ON automation_sessions(session_status)",
    "idx_automation_sessions_tenant": "CREATE INDEX idx_automation_sessions_tenant ON automation_sessions(tenant_id)",
    "idx_bank_match_links_cfdi": "CREATE INDEX idx_bank_match_links_cfdi ON bank_match_links(cfdi_uuid)",
    "idx_bank_match_links_movement": "CREATE INDEX idx_bank_match_links_movement ON bank_match_links(bank_movement_id)",
    "idx_bank_movements_confidence": "CREATE INDEX idx_bank_movements_confidence ON bank_movements(matching_confidence)",
    "idx_bank_movements_decision": "CREATE INDEX idx_bank_movements_decision ON bank_movements(decision)",
    "idx_bank_movements_fecha_monto": "CREATE INDEX idx_bank_movements_fecha_monto ON bank_movements(date, amount)",
    "idx_bank_movements_reconciliation": "CREATE INDEX idx_bank_movements_reconciliation ON bank_movements (tenant_id, date, amount)",
    "idx_bank_movements_tenant": "CREATE INDEX idx_bank_movements_tenant ON bank_movements(tenant_id)",
    "idx_banking_institutions_active_sort": "CREATE INDEX idx_banking_institutions_active_sort\nON banking_institutions(active, sort_order)",
    "idx_banking_institutions_name": "CREATE INDEX idx_banking_institutions_name\nON banking_institutions(name) WHERE active = TRUE",
    "idx_banking_institutions_type": "CREATE INDEX idx_banking_institutions_type\nON banking_institutions(type)",
    "idx_category_config_tenant": "CREATE INDEX idx_category_config_tenant ON category_prediction_config(tenant_id)",
    "idx_category_prediction_category": "CREATE INDEX idx_category_prediction_category ON category_prediction_history(predicted_category)",
    "idx_category_prediction_confidence": "CREATE INDEX idx_category_prediction_confidence ON category_prediction_history(confidence DESC)",
    "idx_category_prediction_expense": "CREATE INDEX idx_category_prediction_expense ON category_prediction_history(expense_id)",
    "idx_category_prediction_feedback": "CREATE INDEX idx_category_prediction_feedback ON category_prediction_history(user_feedback)",
    "idx_category_prediction_method": "CREATE INDEX idx_category_prediction_method ON category_prediction_history(prediction_method)",
    "idx_category_prediction_tenant": "CREATE INDEX idx_category_prediction_tenant ON category_prediction_history(tenant_id)",
    "idx_classification_trace_expense": "CREATE INDEX idx_classification_trace_expense ON classification_trace (expense_id, tenant_id, created_at DESC)",
    "idx_companies_tenant": "CREATE INDEX idx_companies_tenant ON companies(tenant_id)",
    "idx_custom_categories_active": "CREATE INDEX idx_custom_categories_active ON custom_categories(is_active)",
    "idx_custom_categories_name": "CREATE INDEX idx_custom_categories_name ON custom_categories(category_name)",
    "idx_custom_categories_sort": "CREATE INDEX idx_custom_categories_sort ON custom_categories(sort_order)",
    "idx_custom_categories_tenant": "CREATE INDEX idx_custom_categories_tenant ON custom_categories(tenant_id)",
    "idx_duplicate_config_tenant": "CREATE INDEX idx_duplicate_config_tenant ON duplicate_detection_config(tenant_id)",
    "idx_duplicate_detections_expense": "CREATE INDEX idx_duplicate_detections_expense ON duplicate_detections(expense_id)",
    "idx_duplicate_detections_potential": "CREATE INDEX idx_duplicate_detections_potential ON duplicate_detections(potential_duplicate_id)",
    "idx_duplicate_detections_risk": "CREATE INDEX idx_duplicate_detections_risk ON duplicate_detections(risk_level)",
    "idx_duplicate_detections_score": "CREATE INDEX idx_duplicate_detections_score ON duplicate_detections(similarity_score DESC)",
    "idx_duplicate_detections_status": "CREATE INDEX idx_duplicate_detections_status ON duplicate_detections(status)",
    "idx_duplicate_detections_tenant": "CREATE INDEX idx_duplicate_detections_tenant ON duplicate_detections(tenant_id)",
    "idx_expense_approval": "CREATE INDEX idx_expense_approval ON expense_records(approval_status)",
    "idx_expense_bank_status": "CREATE INDEX idx_expense_bank_status ON expense_records(bank_status)",
    "idx_expense_categoria_sugerida": "CREATE INDEX idx_expense_categoria_sugerida ON expense_records(categoria_sugerida)",
    "idx_expense_category_confirmed": "CREATE INDEX idx_expense_category_confirmed ON expense_records(category_confirmed)",
    "idx_expense_category_corrected_by": "CREATE INDEX idx_expense_category_corrected_by ON expense_records(category_corrected_by)",
    "idx_expense_centro_costo": "CREATE INDEX idx_expense_centro_costo ON expense_records(centro_costo)",
    "idx_expense_cfdi": "CREATE INDEX idx_expense_cfdi ON expense_records(cfdi_uuid)",
    "idx_expense_confianza": "CREATE INDEX idx_expense_confianza ON expense_records(confianza DESC)",
    "idx_expense_deducible": "CREATE INDEX idx_expense_deducible ON expense_records(deducible)",
    "idx_expense_duplicate_of": "CREATE INDEX idx_expense_duplicate_of ON expense_records(duplicate_of)",
    "idx_expense_duplicate_ref": "CREATE INDEX idx_expense_duplicate_ref ON expense_records(duplicate_of)",
    "idx_expense_escalated": "CREATE INDEX idx_expense_escalated ON expense_records(escalated_to_invoicing, will_have_cfdi)",
    "idx_expense_escalated_ticket": "CREATE INDEX idx_expense_escalated_ticket ON expense_records(escalated_ticket_id)",
    "idx_expense_invoice_status": "CREATE INDEX idx_expense_invoice_status ON expense_records(invoice_status)",
    "idx_expense_invoice_uuid": "CREATE UNIQUE INDEX idx_expense_invoice_uuid ON expense_records(cfdi_uuid) WHERE cfdi_uuid IS NOT NULL",
    "idx_expense_invoices_detected_format": "CREATE INDEX idx_expense_invoices_detected_format ON expense_invoices(detected_format)",
    "idx_expense_invoices_expense_id": "CREATE INDEX idx_expense_invoices_expense_id ON expense_invoices (expense_id)",
    "idx_expense_invoices_quality_score": "CREATE INDEX idx_expense_invoices_quality_score ON expense_invoices(quality_score)",
    "idx_expense_invoices_template_match": "CREATE INDEX idx_expense_invoices_template_match ON expense_invoices(template_match)",
    "idx_expense_invoices_validation_status": "CREATE INDEX idx_expense_invoices_validation_status ON expense_invoices(validation_status)",
    "idx_expense_is_duplicate": "CREATE INDEX idx_expense_is_duplicate ON expense_records(is_duplicate)",
    "idx_expense_metodo_pago": "CREATE INDEX idx_expense_metodo_pago ON expense_records(metodo_pago)",
    "idx_expense_moneda": "CREATE INDEX idx_expense_moneda ON expense_records(moneda)",
    "idx_expense_predicted_at": "CREATE INDEX idx_expense_predicted_at ON expense_records(predicted_at DESC)",
    "idx_expense_prediction_method": "CREATE INDEX idx_expense_prediction_method ON expense_records(prediction_method)",
    "idx_expense_proyecto": "CREATE INDEX idx_expense_proyecto ON expense_records(proyecto)",
    "idx_expense_records_centro_costo": "CREATE INDEX idx_expense_records_centro_costo ON expense_records(centro_costo)",
    "idx_expense_records_completion": "CREATE INDEX idx_expense_records_completion ON expense_records(completion_status)",
    "idx_expense_records_compound": "CREATE INDEX idx_expense_records_compound ON expense_records (tenant_id, status, date)",
    "idx_expense_records_date": "CREATE INDEX idx_expense_records_date ON expense_records(date)",
    "idx_expense_records_date_range": "CREATE INDEX idx_expense_records_date_range ON expense_records (date, tenant_id)",
    "idx_expense_records_deducible": "CREATE INDEX idx_expense_records_deducible ON expense_records(deducible)",
    "idx_expense_records_provider": "CREATE INDEX idx_expense_records_provider ON expense_records (rfc_proveedor, merchant_name)",
    "idx_expense_records_proyecto": "CREATE INDEX idx_expense_records_proyecto ON expense_records(proyecto)",
    "idx_expense_records_tenant": "CREATE INDEX idx_expense_records_tenant ON expense_records(tenant_id)",
    "idx_expense_records_user": "CREATE INDEX idx_expense_records_user ON expense_records(user_id)",
    "idx_expense_risk_level": "CREATE INDEX idx_expense_risk_level ON expense_records(risk_level)",
    "idx_expense_similarity_score": "CREATE INDEX idx_expense_similarity_score ON expense_records(similarity_score DESC)",
    "idx_expense_tags_name": "CREATE INDEX idx_expense_tags_name ON expense_tags(name)",
    "idx_expense_tags_tenant": "CREATE INDEX idx_expense_tags_tenant ON expense_tags(tenant_id)",
    "idx_expense_updated": "CREATE INDEX idx_expense_updated ON expense_records(updated_at DESC)",
    "idx_expense_workflow_status": "CREATE INDEX idx_expense_workflow_status ON expense_records(workflow_status)",
    "idx_gpt_usage_tenant": "CREATE INDEX idx_gpt_usage_tenant ON gpt_usage_events(tenant_id)",
    "idx_invoicing_jobs_company": "CREATE INDEX idx_invoicing_jobs_company ON invoicing_jobs(company_id)",
    "idx_invoicing_jobs_estado": "CREATE INDEX idx_invoicing_jobs_estado ON invoicing_jobs(estado)",
    "idx_invoicing_jobs_ticket": "CREATE INDEX idx_invoicing_jobs_ticket ON invoicing_jobs(ticket_id)",
    "idx_learning_metrics_category": "CREATE INDEX idx_learning_metrics_category ON category_learning_metrics(category_name)",
    "idx_learning_metrics_tenant": "CREATE INDEX idx_learning_metrics_tenant ON category_learning_metrics(tenant_id)",
    "idx_learning_metrics_user": "CREATE INDEX idx_learning_metrics_user ON category_learning_metrics(user_id)",
    "idx_merchants_active": "CREATE INDEX idx_merchants_active ON merchants(is_active)",
    "idx_merchants_nombre": "CREATE INDEX idx_merchants_nombre ON merchants(nombre)",
    "idx_ml_features_expense": "CREATE INDEX idx_ml_features_expense ON expense_ml_features(expense_id)",
    "idx_ml_features_tenant": "CREATE INDEX idx_ml_features_tenant ON expense_ml_features(tenant_id)",
    "idx_onboarding_steps_active": "CREATE INDEX idx_onboarding_steps_active ON onboarding_steps(active)",
    "idx_onboarding_steps_number": "CREATE INDEX idx_onboarding_steps_number ON onboarding_steps(step_number)",
    "idx_onboarding_steps_tenant": "CREATE INDEX idx_onboarding_steps_tenant ON onboarding_steps(tenant_id)",
    "idx_payment_applications_cfdi": "CREATE INDEX idx_payment_applications_cfdi ON payment_applications(cfdi_uuid)",
    "idx_provider_rules_lookup": "CREATE INDEX idx_provider_rules_lookup\n                        ON provider_rules(tenant_id, provider_name_normalized)\n                    ",
    "idx_refresh_tokens_expires": "CREATE INDEX idx_refresh_tokens_expires ON refresh_tokens(expires_at)",
    "idx_refresh_tokens_hash": "CREATE INDEX idx_refresh_tokens_hash ON refresh_tokens(token_hash)",
    "idx_refresh_tokens_user": "CREATE INDEX idx_refresh_tokens_user ON refresh_tokens(user_id)",
    "idx_sat_account_catalog_code": "CREATE INDEX idx_sat_account_catalog_code\n    ON sat_account_catalog(code)",
    "idx_sat_product_service_catalog_code": "CREATE INDEX idx_sat_product_service_catalog_code\n    ON sat_product_service_catalog(code)",
    "idx_system_health_component": "CREATE INDEX idx_system_health_component ON system_health(component_name)",
    "idx_system_health_status": "CREATE INDEX idx_system_health_status ON system_health(health_status)",
    "idx_tag_relations_expense": "CREATE INDEX idx_tag_relations_expense ON expense_tag_relations(expense_id)",
    "idx_tag_relations_tag": "CREATE INDEX idx_tag_relations_tag ON expense_tag_relations(tag_id)",
    "idx_tickets_company_id": "CREATE INDEX idx_tickets_company_id ON tickets(company_id)",
    "idx_tickets_estado": "CREATE INDEX idx_tickets_estado ON tickets(estado)",
    "idx_tickets_expense_id": "CREATE INDEX idx_tickets_expense_id ON tickets(expense_id)",
    "idx_tickets_mirror": "CREATE INDEX idx_tickets_mirror ON tickets(is_mirror_ticket, expense_id)",
    "idx_tickets_processing": "CREATE INDEX idx_tickets_processing ON tickets (status, tenant_id, created_at)",
    "idx_tickets_tenant": "CREATE INDEX idx_tickets_tenant ON tickets(tenant_id)",
    "idx_user_demo_config_tenant": "CREATE INDEX idx_user_demo_config_tenant ON user_demo_config(tenant_id)",
    "idx_user_demo_config_type": "CREATE INDEX idx_user_demo_config_type ON user_demo_config(demo_type)",
    "idx_user_demo_config_user": "CREATE INDEX idx_user_demo_config_user ON user_demo_config(user_id)",
    "idx_user_payment_accounts_propietario_activo": "CREATE INDEX idx_user_payment_accounts_propietario_activo\n    ON user_payment_accounts(propietario_id, activo)",
    "idx_user_payment_accounts_tenant": "CREATE INDEX idx_user_payment_accounts_tenant\n    ON user_payment_accounts(tenant_id)",
    "idx_user_payment_accounts_tipo": "CREATE INDEX idx_user_payment_accounts_tipo\n    ON user_payment_accounts(tipo)",
    "idx_user_preferences_active": "CREATE INDEX idx_user_preferences_active ON user_category_preferences(active)",
    "idx_user_preferences_category": "CREATE INDEX idx_user_preferences_category ON user_category_preferences(category_name)",
    "idx_user_preferences_frequency": "CREATE INDEX idx_user_preferences_frequency ON user_category_preferences(frequency DESC)",
    "idx_user_preferences_tenant": "CREATE INDEX idx_user_preferences_tenant ON user_category_preferences(tenant_id)",
    "idx_user_preferences_user": "CREATE INDEX idx_user_preferences_user ON user_category_preferences(user_id)",
    "idx_user_progress_status": "CREATE INDEX idx_user_progress_status ON user_onboarding_progress(status)",
    "idx_user_progress_tenant": "CREATE INDEX idx_user_progress_tenant ON user_onboarding_progress(tenant_id)",
    "idx_user_progress_user": "CREATE INDEX idx_user_progress_user ON user_onboarding_progress(user_id)",
    "idx_users_email": "CREATE INDEX idx_users_email ON users(email)",
    "idx_users_identifier": "CREATE INDEX idx_users_identifier ON users(identifier)",
    "idx_users_onboarding_step": "CREATE INDEX idx_users_onboarding_step ON users(onboarding_step)",
    "idx_users_registration_method": "CREATE INDEX idx_users_registration_method ON users(registration_method)",
    "idx_users_tenant": "CREATE INDEX idx_users_tenant ON users(tenant_id)",
    "idx_users_verification": "CREATE INDEX idx_users_verification ON users(verification_token)",
    "idx_workers_status": "CREATE INDEX idx_workers_status ON workers(status)",
    "idx_workers_task_type": "CREATE INDEX idx_workers_task_type ON workers(task_type)",
    "idx_workers_tenant": "CREATE INDEX idx_workers_tenant ON workers(tenant_id)"
  },
  "views": {
    "onboarding_status_view": "CREATE VIEW onboarding_status_view AS\nSELECT\n    u.id as user_id,\n    u.name,\n    u.email,\n    u.identifier,\n    u.full_name,\n    u.company_name,\n    u.onboarding_step,\n    u.onboarding_completed,\n    u.registration_method,\n    u.email_verified,\n    u.phone_verified,\n    u.demo_preferences,\n    COUNT(uop.id) as completed_steps,\n    MAX(os.step_number) as total_steps,\n    CASE\n        WHEN u.onboarding_completed = TRUE THEN 'completed'\n        WHEN COUNT(uop.id) = 0 THEN 'not_started'\n        WHEN COUNT(uop.id) < MAX(os.step_number) THEN 'in_progress'\n        ELSE 'ready_to_complete'\n    END as overall_status\nFROM users u\nCROSS JOIN (SELECT MAX(step_number) as step_number FROM onboarding_steps WHERE active = TRUE AND tenant_id = 1) os\nLEFT JOIN user_onboarding_progress uop ON u.id = uop.user_id AND uop.status = 'completed'\nWHERE u.tenant_id = 1\nGROUP BY u.id",
    "user_payment_accounts_view": "CREATE VIEW user_payment_accounts_view AS\nSELECT\n    upa.id,\n    upa.nombre,\n    upa.tipo,\n    upa.subtipo,\n    upa.moneda,\n    upa.saldo_inicial,\n    upa.saldo_actual,\n    upa.limite_credito,\n    upa.credito_disponible,\n    upa.fecha_corte,\n    upa.fecha_pago,\n    upa.propietario_id,\n    u.email AS propietario_email,\n    u.full_name AS propietario_nombre,\n    upa.tenant_id,\n    t.name AS tenant_nombre,\n    upa.proveedor_terminal,\n    upa.banco_nombre,\n    upa.numero_tarjeta,\n    upa.numero_cuenta,\n    upa.numero_cuenta_enmascarado,\n    upa.clabe,\n    upa.activo,\n    upa.created_at,\n    upa.updated_at\nFROM user_payment_accounts upa\nLEFT JOIN users u ON upa.propietario_id = u.id\nLEFT JOIN tenants t ON upa.tenant_id = t.id"
  },
  "triggers": {
    "category_config_updated_at": "CREATE TRIGGER category_config_updated_at\n    AFTER UPDATE ON category_prediction_config\n    FOR EACH ROW\n    WHEN NEW.updated_at = OLD.updated_at OR NEW.updated_at IS NULL\nBEGIN\n    UPDATE category_prediction_config\n    SET updated_at = CURRENT_TIMESTAMP\n    WHERE id = NEW.id;\nEND",
    "custom_categories_updated_at": "CREATE TRIGGER custom_categories_updated_at\n    AFTER UPDATE ON custom_categories\n    FOR EACH ROW\n    WHEN NEW.updated_at = OLD.updated_at OR NEW.updated_at IS NULL\nBEGIN\n    UPDATE custom_categories\n    SET updated_at = CURRENT_TIMESTAMP\n    WHERE id = NEW.id;\nEND",
    "duplicate_config_updated_at": "CREATE TRIGGER duplicate_config_updated_at\n    AFTER UPDATE ON duplicate_detection_config\n    FOR EACH ROW\n    WHEN NEW.updated_at = OLD.updated_at OR NEW.updated_at IS NULL\nBEGIN\n    UPDATE duplicate_detection_config\n    SET updated_at = CURRENT_TIMESTAMP\n    WHERE id = NEW.id;\nEND",
    "expense_records_updated_at": "CREATE TRIGGER expense_records_updated_at\n    AFTER UPDATE ON expense_records\n    FOR EACH ROW\n    WHEN NEW.updated_at = OLD.updated_at OR NEW.updated_at IS NULL\nBEGIN\n    UPDATE expense_records\n    SET updated_at = CURRENT_TIMESTAMP\n    WHERE id = NEW.id;\nEND",
    "ml_features_updated_at": "CREATE TRIGGER ml_features_updated_at\n    AFTER UPDATE ON expense_ml_features\n    FOR EACH ROW\n    WHEN NEW.updated_at = OLD.updated_at OR NEW.updated_at IS NULL\nBEGIN\n    UPDATE expense_ml_features\n    SET updated_at = CURRENT_TIMESTAMP\n    WHERE id = NEW.id;\nEND",
    "trg_upa_credito_disponible": "CREATE TRIGGER trg_upa_credito_disponible\n    AFTER INSERT ON user_payment_accounts\n    FOR EACH ROW\n    WHEN NEW.tipo = 'tarjeta_credito'\nBEGIN\n    UPDATE user_payment_accounts\n    SET credito_disponible = COALESCE(NEW.limite_credito, 0) - COALESCE(NEW.saldo_actual, 0)\n    WHERE id = NEW.id;\nEND",
    "trg_upa_credito_disponible_update": "CREATE TRIGGER trg_upa_credito_disponible_update\n    AFTER UPDATE OF saldo_actual, limite_credito ON user_payment_accounts\n    FOR EACH ROW\n    WHEN NEW.tipo = 'tarjeta_credito'\nBEGIN\n    UPDATE user_payment_accounts\n    SET credito_disponible = COALESCE(NEW.limite_credito, 0) - COALESCE(NEW.saldo_actual, 0)\n    WHERE id = NEW.id;\nEND",
    "trg_upa_init_saldo": "CREATE TRIGGER trg_upa_init_saldo\n    AFTER INSERT ON user_payment_accounts\n    FOR EACH ROW\n    WHEN NEW.saldo_actual = 0 AND NEW.saldo_inicial != 0\nBEGIN\n    UPDATE user_payment_accounts\n    SET saldo_actual = NEW.saldo_inicial\n    WHERE id = NEW.id;\nEND",
    "trg_upa_updated_at": "CREATE TRIGGER trg_upa_updated_at\n    AFTER UPDATE ON user_payment_accounts\n    FOR EACH ROW\nBEGIN\n    UPDATE user_payment_accounts\n    SET updated_at = CURRENT_TIMESTAMP\n    WHERE id = NEW.id;\nEND",
    "user_preferences_updated_at": "CREATE TRIGGER user_preferences_updated_at\n    AFTER UPDATE ON user_category_preferences\n    FOR EACH ROW\n    WHEN NEW.updated_at = OLD.updated_at OR NEW.updated_at IS NULL\nBEGIN\n    UPDATE user_category_preferences\n    SET updated_at = CURRENT_TIMESTAMP\n    WHERE id = NEW.id;\nEND"
  }
}